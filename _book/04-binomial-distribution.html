<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Bayesian Statistics the Fun Way. Een notitieboek - 4&nbsp; Creating a Binomial Probability Distribution</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-beta-distribution.html" rel="next">
<link href="./03-logic-uncertainty.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="quarto.css">
<link rel="stylesheet" href="glossary.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-binomial-distribution.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Creating a Binomial Probability Distribution</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bayesian Statistics the Fun Way. Een notitieboek</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">PART I: Introduction to Probability</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-everyday-reasoning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Bayesian Thinking and Everyday Reasoning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-measuring-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Measuring Uncertainty</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-logic-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Logic of Uncertainty</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-binomial-distribution.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Creating a Binomial Probability Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-beta-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The Beta Distribution</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#structure-of-a-binomial-distribution" id="toc-structure-of-a-binomial-distribution" class="nav-link active" data-scroll-target="#structure-of-a-binomial-distribution"><span class="header-section-number">4.1</span> Structure of a Binomial Distribution</a></li>
  <li><a href="#understanding-and-abstracting-out-the-details-of-our-problem" id="toc-understanding-and-abstracting-out-the-details-of-our-problem" class="nav-link" data-scroll-target="#understanding-and-abstracting-out-the-details-of-our-problem"><span class="header-section-number">4.2</span> Understanding and Abstracting Out the Details of Our Problem</a></li>
  <li>
<a href="#counting-our-outcomes-with-the-binomial-coefficient" id="toc-counting-our-outcomes-with-the-binomial-coefficient" class="nav-link" data-scroll-target="#counting-our-outcomes-with-the-binomial-coefficient"><span class="header-section-number">4.3</span> Counting Our Outcomes with the Binomial Coefficient</a>
  <ul>
<li><a href="#combinatorics-advanced-counting-with-the-binomial-coefficient" id="toc-combinatorics-advanced-counting-with-the-binomial-coefficient" class="nav-link" data-scroll-target="#combinatorics-advanced-counting-with-the-binomial-coefficient"><span class="header-section-number">4.3.1</span> Combinatorics: Advanced Counting with the Binomial Coefficient</a></li>
  <li><a href="#calculating-the-probability-of-the-desired-outcome" id="toc-calculating-the-probability-of-the-desired-outcome" class="nav-link" data-scroll-target="#calculating-the-probability-of-the-desired-outcome"><span class="header-section-number">4.3.2</span> Calculating the Probability of the Desired Outcome</a></li>
  </ul>
</li>
  <li><a href="#sec-gacha-games" id="toc-sec-gacha-games" class="nav-link" data-scroll-target="#sec-gacha-games"><span class="header-section-number">4.4</span> Example: Gacha Games</a></li>
  <li><a href="#wrapping-up" id="toc-wrapping-up" class="nav-link" data-scroll-target="#wrapping-up"><span class="header-section-number">4.5</span> Wrapping Up</a></li>
  <li>
<a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">4.6</span> Exercises</a>
  <ul>
<li><a href="#exercise-4.1" id="toc-exercise-4.1" class="nav-link" data-scroll-target="#exercise-4.1"><span class="header-section-number">4.6.1</span> Exercise 4.1</a></li>
  <li><a href="#exercise-4.2" id="toc-exercise-4.2" class="nav-link" data-scroll-target="#exercise-4.2"><span class="header-section-number">4.6.2</span> Exercise 4.2</a></li>
  <li><a href="#exercise-4.3" id="toc-exercise-4.3" class="nav-link" data-scroll-target="#exercise-4.3"><span class="header-section-number">4.6.3</span> Exercise 4.3</a></li>
  <li><a href="#exercise-4.4" id="toc-exercise-4.4" class="nav-link" data-scroll-target="#exercise-4.4"><span class="header-section-number">4.6.4</span> Exercise 4.4</a></li>
  <li><a href="#exercise-4.5" id="toc-exercise-4.5" class="nav-link" data-scroll-target="#exercise-4.5"><span class="header-section-number">4.6.5</span> Exercise 4.5</a></li>
  </ul>
</li>
  <li>
<a href="#experiments" id="toc-experiments" class="nav-link" data-scroll-target="#experiments"><span class="header-section-number">4.7</span> Experiments</a>
  <ul>
<li><a href="#sec-example-4-1" id="toc-sec-example-4-1" class="nav-link" data-scroll-target="#sec-example-4-1"><span class="header-section-number">4.7.1</span> Permutation with R</a></li>
  <li><a href="#sec-example-4-2" id="toc-sec-example-4-2" class="nav-link" data-scroll-target="#sec-example-4-2"><span class="header-section-number">4.7.2</span> Compute binomial coefficient manually</a></li>
  <li><a href="#sec-example-4-3" id="toc-sec-example-4-3" class="nav-link" data-scroll-target="#sec-example-4-3"><span class="header-section-number">4.7.3</span> Compute density of the binomial distribution</a></li>
  <li><a href="#sec-10-coin-flips" id="toc-sec-10-coin-flips" class="nav-link" data-scroll-target="#sec-10-coin-flips"><span class="header-section-number">4.7.4</span> Replication of the Binomial Distribution of 10 Coin Flips</a></li>
  <li><a href="#sec-example-4-4" id="toc-sec-example-4-4" class="nav-link" data-scroll-target="#sec-example-4-4"><span class="header-section-number">4.7.5</span> Replication of the Binomial Distribution of 10 Dice Rolls</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-prob-dist" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Creating a Binomial Probability Distribution</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="structure-of-a-binomial-distribution" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="structure-of-a-binomial-distribution">
<span class="header-section-number">4.1</span> Structure of a Binomial Distribution</h2>
<p>A binomial distribution is used to calculate the probability of a certain number of successful outcomes, given a number of trials and the probability of the successful outcome. The “bi” in the term binomial refers to the two possible outcomes that we’re concerned with: an event happening and an event not happening. (If there are more than two outcomes, the distribution is called multinomial.)</p>
<p>Examples for a binomial distribution are:</p>
<ul>
<li>Flipping two heads in three coin tosses</li>
<li>Buying 1 million lottery tickets and winning at least once</li>
<li>Rolling fewer than three 20s in 10 rolls of a 20-sided die</li>
</ul>
<hr>
<div id="def-binom-dist-param" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.1 (Parameter for the binomial distribution)</strong></span> All binomial distributions involve three parameters:</p>
<ul>
<li>
<code>k</code> The number of outcomes we care about</li>
<li>
<code>n</code> The total number of trials</li>
<li>
<code>p</code> The probability of the event happening</li>
</ul>
</div>
<hr>
<p>Calculating the probability of flipping two heads in three coin tosses:</p>
<ul>
<li>
<span class="math inline">\(k = 2\)</span>, the number of events we care about, in this case flipping a heads</li>
<li>
<span class="math inline">\(n = 3\)</span>, the number times the coin is flipped</li>
<li>
<span class="math inline">\(p = 1/2\)</span>, the probability of flipping a heads in a coin toss</li>
</ul>
<hr>
<div id="thm-binomial-distribution-shorthand-notation" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.1 (Shorthand notation of a binomial distribution)</strong></span> <span id="eq-short-notation"><span class="math display">\[B(k; n, p) \tag{4.1}\]</span></span></p>
</div>
<hr>
<p>For the example of two heads in three coin tosses, we would write <span class="math inline">\(B(2; 3, 1/2)\)</span>.</p>
<ul>
<li>
<code>B</code> stands for <em>binomial</em> distribution</li>
<li>
<code>k</code> is separated from the other parameters by a semicolon. This is because when we are talking about a distribution of values, we usually care about all values of <span class="math inline">\(k\)</span> for a fixed <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>.</li>
<li>
<code>B(k; n, p)</code> denotes each value in the distribution</li>
<li>
<code>B(n, p)</code> denotes the whole distribution</li>
</ul></section><section id="understanding-and-abstracting-out-the-details-of-our-problem" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="understanding-and-abstracting-out-the-details-of-our-problem">
<span class="header-section-number">4.2</span> Understanding and Abstracting Out the Details of Our Problem</h2>
<p>We’ll continue with the example of calculating the probability of flipping two heads in three coin tosses. Since the number of possible outcomes is small, we can quickly figure out the results we care about with just pencil and paper.</p>
<p><span class="math display">\[HHT, HTH, THH\]</span> To start generalizing, we’ll break this problem down into smaller pieces we can solve right now, and reduce those pieces into manageable equations. As we build up the equations, we’ll put them together to create a generalized function for the binomial distribution.</p>
<hr>
<div id="thm-permuation-example" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.2 (Permuation Example for the Binomial Distribution)</strong></span> &nbsp;</p>
<ul>
<li>Each outcome we care about will have the <em>same</em> probability.</li>
<li>Each outcome is just a permutation (GLOSSARY), or reordering, of the others</li>
</ul>
<p><span id="eq-permutation-example"><span class="math display">\[
\begin{align*}
P({heads, heads, tails}) = P({heads, tails, heads}) = P({tails, heads, heads}) = \\
P(\text{Desired Outcome})
\end{align*}
\tag{4.2}\]</span></span></p>
<p>See how to do this calculation with R in <a href="#sec-example-4-1" class="quarto-xref"><span>Section 4.7.1</span></a>.</p>
</div>
<hr>
<p>There are three outcomes, but only one of them can possibly happen and we don’t care which. And because it’s only possible for one outcome to occur, we know that these are mutually exclusive, denoted as:</p>
<p><span class="math display">\[P(\{heads, heads, tails\},\{heads, tails, heads\},\{tails, heads, heads\}) = 0\]</span> This makes using the sum rule of probability easy.</p>
<p><span class="math display">\[
\begin{align*}
P(\{heads, heads, tails\} \operatorname{OR} \{heads, tails, heads\} \operatorname{OR} \{tails, heads, heads\}) = \\
P(\text{Desired Outcome}) + P(\text{Desired Outcome}) + P(\text{Desired Outcome}) = \\
3 \times P(Desired Outcome)
\end{align*}
\]</span> The value “3” is specific to this problem and therefore not generalizable. We can fix this by simply replacing “3” with a variable called <span class="math inline">\(N_{outcomes}\)</span>.</p>
<hr>
<div id="thm-pmf-placeholder" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.3 (Solution with place holders)</strong></span> <span id="eq-pmf-placeholder"><span class="math display">\[B(k;n,p) = N_{outcomes} \times P(\text{Desired Outcome}) \tag{4.3}\]</span></span></p>
</div>
<hr>
<p>Now we have to figure out two subproblems:</p>
<ol type="1">
<li>How to count the number of outcomes we care about?</li>
<li>How to determine the probability for a single outcome?</li>
</ol></section><section id="counting-our-outcomes-with-the-binomial-coefficient" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="counting-our-outcomes-with-the-binomial-coefficient">
<span class="header-section-number">4.3</span> Counting Our Outcomes with the Binomial Coefficient</h2>
<p>First we need to figure out how many outcomes there are for a given k (the outcomes we care about) and n (the number of trials). For small numbers we can simply count. But it doesn’t take much for this to become too difficult to do by hand. The solution is combinatorics (GLOSSARY))`.</p>
<section id="combinatorics-advanced-counting-with-the-binomial-coefficient" class="level3" data-number="4.3.1"><h3 data-number="4.3.1" class="anchored" data-anchor-id="combinatorics-advanced-counting-with-the-binomial-coefficient">
<span class="header-section-number">4.3.1</span> Combinatorics: Advanced Counting with the Binomial Coefficient</h3>
<p>There is a special operation in combinatorics, called the <em>binomial coefficient</em>, that represents counting the number of ways we can select <code>k</code> from <code>n</code> — that is, selecting the outcomes we care about from the total number of trials.</p>
<hr>
<div id="thm-binomial-coefficient" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.4 (Notation for the binomial coefficient)</strong></span> <span id="eq-binomial-coefficient"><span class="math display">\[\binom{n}{k} \tag{4.4}\]</span></span></p>
</div>
<hr>
<p>We read this as “n choose k”. In our example we would say “in three tosses choose two heads”:</p>
<p><span class="math display">\[\binom{3}{2}\]</span></p>
<hr>
<div id="thm-def-bin-coeff" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.5 (Definition of the binomial coefficient operation)</strong></span> <span id="eq-def-bin-coeff"><span class="math display">\[\binom{n}{k} = \frac{n!}{k! \times (n-k)!} \tag{4.5}\]</span></span></p>
</div>
<hr>
<p>The <code>!</code> means <em>factorial</em>, which is the product of all the numbers up to and including the number before the <code>!</code> symbol, so <span class="math inline">\(5! = (5 × 4 × 3 × 2 × 1)\)</span>.</p>
<p>In R we compute the binomial coefficient for the case of flipping two heads in three tosses with the following function call:</p>
<hr>
<div class="cell">
<div id="lst-binomial-coeff" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-binomial-coeff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.1: <strong>Compute the binomial coefficient for flipping two heads in three tosses</strong>
</figcaption><div aria-describedby="lst-binomial-coeff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-binomial-coeff"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<hr>
<p>See how to calculate the binomial coefficient with Base R in <a href="#sec-example-4-2" class="quarto-xref"><span>Section 4.7.2</span></a>.</p>
<p>We can now replace <span class="math inline">\(N_{Outcomes}\)</span> in <a href="#eq-pmf-placeholder" class="quarto-xref">Equation&nbsp;<span>4.3</span></a> with the binomial coefficient:</p>
<p><span class="math display">\[B(k;n,p) = \binom{n}{k} \times P(\text{Desired Outcome})\]</span></p>
</section><section id="calculating-the-probability-of-the-desired-outcome" class="level3" data-number="4.3.2"><h3 data-number="4.3.2" class="anchored" data-anchor-id="calculating-the-probability-of-the-desired-outcome">
<span class="header-section-number">4.3.2</span> Calculating the Probability of the Desired Outcome</h3>
<p>All we have left to figure out is the <span class="math inline">\(P(\text{Desired Outcome})\)</span>, which is the probability of any of the possible events we care about. So far we’ve been using <span class="math inline">\(P(\text{Desired Outcome})\)</span> as a variable to help organize our solution to this problem, but now we need to figure out exactly how to calculate this value.</p>
<p>Let’s focus on a single case of our example of tow heads in three tosses: <span class="math inline">\(HHT\)</span>. Using the product rule and negation from the previous chapter, we can describe this problem as: <span class="math display">\[P(heads, heads, no heads) = P(heads, heads, 1-heads)\]</span> Now we can use the product rule from <a href="03-logic-uncertainty.html#eq-product-rule" class="quarto-xref">Equation&nbsp;<span>3.1</span></a>:</p>
<p><span class="math display">\[
\begin{align*}
P(heads, heads, 1-heads) = \\
P(heads) \times P(heads) \times (1-P(heads)) = \\
P(heads)^2 \times (1-P(heads))^1
\end{align*}
\]</span> You can see that the exponents for <span class="math inline">\(P(heads)^2\)</span> and <span class="math inline">\(1 – P(heads)^1\)</span> are just the number of heads and the number of not heads in our scenario. These equate to <code>k</code>, the number of outcomes we care about, and <code>n – k</code>, the number of trials minus the outcomes we care about. Puting all together:</p>
<p><span class="math display">\[
\binom{n}{k} \times P(heads)^{k} \times (1- P(heads))^{n-k}
\]</span> Generalizing for any probability, not just heads, we replace <span class="math inline">\(P(heads)\)</span> with just <code>p</code>. This gives us a <em>general solution</em>. Compare the following list with <a href="#def-binom-dist-param" class="quarto-xref">Definition&nbsp;<span>4.1</span></a>.</p>
<ul>
<li>
<code>k</code>, the number of outcomes we care about;</li>
<li>
<code>n</code>, the number of trials; and</li>
<li>
<code>p</code>, the probability of the individual outcome.</li>
</ul>
<hr>
<div id="thm-pmf" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.6 (Probability Mass Function (PMF) for the Binomial Distribution)</strong></span> <span id="eq-pmf"><span class="math display">\[
\binom{n}{k} \times p^{k} \times (1- p)^{n-k}
\tag{4.6}\]</span></span></p>
</div>
<hr>
<p><a href="#eq-pmf" class="quarto-xref">Equation&nbsp;<span>4.6</span></a> is the basis of the binomial distribution. It is called a Probability Mass Function (GLOSSARY) (PMF). The <em>mass</em> part of the name comes from the fact that we can use it to calculate the amount of probability for any given <code>k</code> using a fixed <code>n</code> and <code>p</code>, so this is the mass of our probability.</p>
<p>Now that we have this equation, we can solve any problem related to outcomes of a coin toss. For example, we could calculate the probability of flipping exactly 12 heads in 24 coin tosses:</p>
<p><span class="math display">\[
B(12,24,\frac{1}{2}) = \binom{24}{12} \times (\frac{1}{2})^{12} \times (1-\frac{1}{2})^{24-12} = 0.1611803
\]</span></p>
<hr>
<div class="cell">
<div id="lst-calc-example" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-calc-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.2: <strong>Calculate the probability of flipping exactly 12 heads in 24 coin tosses</strong>
</figcaption><div aria-describedby="lst-calc-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-calc-example"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="fl">24</span>,<span class="fl">12</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">12</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">24</span> <span class="op">-</span> <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1611803</code></pre>
</div>
</div>
<hr>
<p>The calculation in <a href="#lst-calc-example" class="quarto-xref">Listing&nbsp;<span>4.2</span></a> is only valid for our concrete example.</p>
<p>For example, we can plug in all the possible values for <code>k</code> in 10 coin tosses into our PMF and visualize what the binomial distribution looks like for all possible values.</p>
<div id="fig-10-coin-flips" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" alt="Bar graph showing the probability of getting k in 10 coin flips">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-10-coin-flips-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: Binomial Distribution for 10 Coin Flips
</figcaption><div aria-describedby="fig-10-coin-flips-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/04fig01.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Bar graph showing the probability of getting k in 10 coin flips">
</div>
</figure>
</div>
<p>See my <a href="#fig-repl-10-coin-flips" class="quarto-xref">Figure&nbsp;<span>4.4</span></a> as a replication of <a href="#fig-10-coin-flips" class="quarto-xref">Figure&nbsp;<span>4.1</span></a>.</p>
<p>We can also look at the same distribution for the probability of getting a 6 when rolling a six-sided die 10 times, as shown in <a href="#fig-10-dice-rolls" class="quarto-xref">Figure&nbsp;<span>4.2</span></a>.</p>
<div id="fig-10-dice-rolls" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" alt="Bar graph showing the probability of getting a 6 when rolling a six-sided die 10 times">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-10-dice-rolls-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Binomial Distribution for 10 Coin Flips
</figcaption><div aria-describedby="fig-10-dice-rolls-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/04fig02.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Bar graph showing the probability of getting a 6 when rolling a six-sided die 10 times">
</div>
</figure>
</div>
<p>Again I replicated <a href="#fig-10-dice-rolls" class="quarto-xref">Figure&nbsp;<span>4.2</span></a> with my <a href="#fig-repl-10-dice-rolls" class="quarto-xref">Figure&nbsp;<span>4.6</span></a>.</p>
<p>Bottom line of the discussion in this section: A probability distribution is a way of generalizing an entire class of problems.</p>
</section></section><section id="sec-gacha-games" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="sec-gacha-games">
<span class="header-section-number">4.4</span> Example: Gacha Games</h2>
<p>There is only one new content in this section: Instead of computing the probability of one event we are going to calculate the possibility of drawing <em>at least</em> one specific card from a pile of infinite numbers of cards where we know the probability of this card we are interested. The aim is to have a <code>p</code> of at last 50% with 100 trials and a probability of 0.720% for the card we are interested.</p>
<p>At first let us compute the probability for getting <em>exactly one card</em> we are interested with 100 draws form the pile. We know the probability to draw the featured card is 0.720%.</p>
<p><span class="math display">\[\binom{100}{1} \times 0.00720^{1} \times (1- 0.00720)^{100-1}\]</span></p>
<div class="cell">
<div id="lst-draw-exact-one-card" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-draw-exact-one-card-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.3: Draw exact one card that has p = 0.720%
</figcaption><div aria-describedby="lst-draw-exact-one-card-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-draw-exact-one-card"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span>, <span class="fl">0.00720</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.352085</code></pre>
</div>
</div>
<p>And now let’s compute the probability for <em>at least one card</em> we are interested.</p>
<p>In R, we can use the Binomial Cumulative Distribution Function <code><a href="https://rdrr.io/r/stats/Binomial.html">pbinom()</a></code> to automatically sum up all the values of the card we are interested in our PMF.</p>
<div id="fig-pbinom-function" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center" alt="Explaining the structure of the pbinom() function">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pbinom-function-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: How the pbinom() function works
</figcaption><div aria-describedby="fig-pbinom-function-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/04fig03.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" alt="Explaining the structure of the pbinom() function">
</div>
</figure>
</div>
<p>The <code><a href="https://rdrr.io/r/stats/Binomial.html">pbinom()</a></code> function takes three required arguments and an optional fourth called <code>lower.tail</code> (which defaults to TRUE). When the fourth argument is TRUE, the first argument sums up all of the probabilities less than or equal to our argument. When <code>lower.tail</code> is set to FALSE, it sums up the probabilities strictly greater than the first argument. By setting the first argument to <span class="math inline">\(0\)</span>, we are looking at the probability of getting one or more the cards we are interested. We set <code>lower.tail</code> to FALSE because that means we want values greater than the first argument (by default, we get values less than the first argument).</p>
<div class="cell">
<div id="lst-use-pbinom-example" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-use-pbinom-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.4: Example Calculation with the pbinom() Function
</figcaption><div aria-describedby="lst-use-pbinom-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-use-pbinom-example"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">0.00720</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5145138</code></pre>
</div>
</div>
<p>Voilá! This is the same result as in @#fig-pbinom-function.</p>
</section><section id="wrapping-up" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="wrapping-up">
<span class="header-section-number">4.5</span> Wrapping Up</h2>
<p>In this chapter Will Kurt demonstrated how we can deduce intuitively the formula for the binomial coefficient (GLOSSARY).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>I have seen this monstrosity of expression for the binomial coefficient many times in different books and was always overwhelmed from its complexity. But this has changed now: Will Kurt succeeded to demystify the formula for me!</p>
</div>
</div>
</section><section id="exercises" class="level2" data-number="4.6"><h2 data-number="4.6" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">4.6</span> Exercises</h2>
<p>Try answering the following questions to make sure you’ve grasped binomial distributions fully. The solutions can be found at https://nostarch.com/learnbayes/.</p>
<section id="exercise-4.1" class="level3" data-number="4.6.1"><h3 data-number="4.6.1" class="anchored" data-anchor-id="exercise-4.1">
<span class="header-section-number">4.6.1</span> Exercise 4.1</h3>
<div id="exr-04-1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.1</strong></span> What are the parameters of the binomial distribution for the probability of rolling either a 1 or a 20 on a 20-sided die, if we roll the die 12 times?</p>
<ul>
<li>k = interested events: 1 and 20 = 2.</li>
<li>n = number of trials = 12</li>
<li>p = probability for each trial = <span class="math inline">\(\frac{2}{12}\)</span>
</li>
</ul>
<div class="cell">
<div id="lst-exercise-04-1" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-exercise-04-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.5: <strong>Binomial distribution for the probability of rolling either a 1 or a 20 on a 20-sided die, if we roll the die 12 times</strong>
</figcaption><div aria-describedby="lst-exercise-04-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-exercise-04-1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">12</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2301278</code></pre>
</div>
</div>
</div>
<hr></section><section id="exercise-4.2" class="level3" data-number="4.6.2"><h3 data-number="4.6.2" class="anchored" data-anchor-id="exercise-4.2">
<span class="header-section-number">4.6.2</span> Exercise 4.2</h3>
<div id="exr-04-2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.2</strong></span> There are four aces in a deck of 52 cards. If you pull a card, return the card, then reshuffle and pull a card again, how many ways can you pull just one ace in five pulls?</p>
<div class="cell">
<div id="lst-exercise-04-2" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-exercise-04-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.6: <strong>If you pull a card, return the card, then reshuffle and pull a card again, how many ways can you pull just one ace in five pulls?</strong>
</figcaption><div aria-describedby="lst-exercise-04-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-exercise-04-2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">combinat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/combinat/man/combn.html">combn</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, m <span class="op">=</span> <span class="fl">1</span>, fun <span class="op">=</span> <span class="va">tabulate</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, nbins <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]    1    0    0    0    0
[2,]    0    1    0    0    0
[3,]    0    0    1    0    0
[4,]    0    0    0    1    0
[5,]    0    0    0    0    1</code></pre>
</div>
<div id="lst-exercise-04-2" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-exercise-04-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.7: <strong>If you pull a card, return the card, then reshuffle and pull a card again, how many ways can you pull just one ace in five pulls?</strong>
</figcaption><div aria-describedby="lst-exercise-04-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-exercise-04-2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In contrast to the result in the solution manual I programmed the exercise with <code><a href="https://rdrr.io/pkg/combinat/man/combn.html">combinat::combn()</a></code>. This correct solution pretends that I could use it for every possible arrangement. That is not true. For instance I could not manage to display the many ways of rolling two 6s in three rolls of a six-sided die.</p>
</div>
</div>
</div>
<hr></section><section id="exercise-4.3" class="level3" data-number="4.6.3"><h3 data-number="4.6.3" class="anchored" data-anchor-id="exercise-4.3">
<span class="header-section-number">4.6.3</span> Exercise 4.3</h3>
<div id="exr-04-3" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.3</strong></span> For the example in <a href="#exr-04-2" class="quarto-xref">Exercise&nbsp;<span>4.2</span></a>, what is the probability of pulling five aces in 10 pulls (remember the card is shuffled back in the deck when it is pulled)?</p>
<div class="cell">
<div id="lst-exercise-04-3" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-exercise-04-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.8: <strong>Probability of pulling five aces in 10 pulls with replacing</strong>
</figcaption><div aria-describedby="lst-exercise-04-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-exercise-04-3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">4</span> <span class="op">/</span> <span class="fl">52</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04548553</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Only about 0.0455%. But this is different than the result in the solution manual with 1/32000 = 0.003125%. I don’t know why there is this difference.</p>
</div>
</div>
</div>
<hr></section><section id="exercise-4.4" class="level3" data-number="4.6.4"><h3 data-number="4.6.4" class="anchored" data-anchor-id="exercise-4.4">
<span class="header-section-number">4.6.4</span> Exercise 4.4</h3>
<div id="exr-04-4" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.4</strong></span> When you’re searching for a new job, it’s always helpful to have more than one offer on the table so you can use it in negotiations. If you have a 1/5 probability of receiving a job offer when you interview, and you interview with seven companies in a month, what is the probability you’ll have at least two competing offers by the end of that month?</p>
<div class="cell">
<div id="lst-exercise-04-4" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-exercise-04-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.9: <strong>Probability of at least 2 interviews each with 1/5 chance for a job offer having 7 interviews</strong>
</figcaption><div aria-describedby="lst-exercise-04-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-exercise-04-4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">5</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4232832</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There is chance of about 42% that you receive at least two job offers.</p>
<p>In my first trial I calculated wrongly the probability for <em>exact 2</em> competing offers with <code>dbinom(2, 7, 1/2)</code> instead of <em>at least 2</em> competing offers! Additionally I forgot to add <code>lower.tail = FALSE</code>. to calculate <em>more than x</em>: x = 1, more than 1 = 2, therefore the first parameter is 1 (and not 2 as could be thought wrongly). Not using <code>lower.tail = FALSE</code> means that the default value of <code>lower.tail = TRUE</code> computes the probability of <span class="math inline">\(P[X &lt;= x]\)</span> (instead of <span class="math inline">\(P[X &gt; x]\)</span>).</p>
</div>
</div>
</div>
<hr></section><section id="exercise-4.5" class="level3" data-number="4.6.5"><h3 data-number="4.6.5" class="anchored" data-anchor-id="exercise-4.5">
<span class="header-section-number">4.6.5</span> Exercise 4.5</h3>
<div id="exr-04-5" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.5</strong></span> You get a bunch of recruiter emails and find out you have 25 interviews lined up in the next month. Unfortunately, you know this will leave you exhausted, and the probability of getting an offer will drop to 1/10 if you’re tired. You really don’t want to go on this many interviews unless you are at least twice as likely to get at least two competing offers. Are you more likely to get at least two offers if you go for 25 interviews, or stick to just 7?</p>
<div class="cell">
<div id="lst-exercise-04-5" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-exercise-04-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.10: <strong>Probability of at least 2 interviews each with 1/10 chance for a job offer having 25 interviews</strong>
</figcaption><div aria-describedby="lst-exercise-04-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-exercise-04-5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">25</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">10</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7287941</code></pre>
</div>
</div>
<p>With a reduced probability per interview you raised your changes from 42,3% to 72,9%. But to get an job offer is not twice as likely so you stick with 7 interviews.</p>
</div>
<hr></section></section><section id="experiments" class="level2" data-number="4.7"><h2 data-number="4.7" class="anchored" data-anchor-id="experiments">
<span class="header-section-number">4.7</span> Experiments</h2>
<section id="sec-example-4-1" class="level3" data-number="4.7.1"><h3 data-number="4.7.1" class="anchored" data-anchor-id="sec-example-4-1">
<span class="header-section-number">4.7.1</span> Permutation with R</h3>
<p>I want to get the same result as in <a href="#eq-permutation-example" class="quarto-xref">Equation&nbsp;<span>4.2</span></a>, but this time using R. What are the permutations of possible events by flipping two heads in three coin tosses?</p>
<p>Let’s P(heads) = 1 and P(tails) = 0, then we can use <code><a href="https://rdrr.io/pkg/combinat/man/combn.html">combinat::combn()</a></code>. The package {<strong>combinat</strong>} is not part of Base R, so you have to install it.</p>
<div class="cell">
<div id="lst-permutate-3-2" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-permutate-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.11: Permutations of possible events by flipping two heads in three coin tosses
</figcaption><div aria-describedby="lst-permutate-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-permutate-3-2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">combinat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/combinat/man/combn.html">combn</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, m <span class="op">=</span> <span class="fl">2</span>, fun <span class="op">=</span> <span class="va">tabulate</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, nbins <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    1    0
[2,]    1    0    1
[3,]    0    1    1</code></pre>
</div>
</div>
<p>The syntax is: <code>combn(x, m, fun = NULL, simplify = TRUE, ...)</code>.</p>
<ul>
<li>
<code>x</code>: vector source for combinations equivalent to the the number of events.</li>
<li>
<code>m</code>: number of elements we are interested in</li>
<li>
<code>fun</code> = function to be applied to each combination (may be null). I am using the <code><a href="https://rdrr.io/r/base/tabulate.html">base::tabulate()</a></code> to take the integer-valued vector and counting the number of times each integer occurs in it.</li>
<li>
<code>simplify</code>: logical, if FALSE, returns a list, otherwise returns vector or array.</li>
<li>
<code>...</code>: arguments for the used function. In our case <code>nbins</code> refers to the number of bin used by the <code><a href="https://rdrr.io/r/base/tabulate.html">tabulate()</a></code> function.</li>
</ul>
<p>Let’s try another example to understand better the pattern of the <code><a href="https://rdrr.io/r/utils/combn.html">combn()</a></code> functions: What are the permutations of possible events by flipping a coin 5 times and getting three heads:</p>
<div class="cell">
<div id="lst-permutate-3-2" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-permutate-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.12: Permutations of possible events by flipping two heads in five coin tosses
</figcaption><div aria-describedby="lst-permutate-3-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-permutate-3-2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">combinat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/combinat/man/combn.html">combn</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, m <span class="op">=</span> <span class="fl">2</span>, fun <span class="op">=</span> <span class="va">tabulate</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, nbins <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
[1,]    1    1    1    1    0    0    0    0    0     0
[2,]    1    0    0    0    1    1    1    0    0     0
[3,]    0    1    0    0    1    0    0    1    1     0
[4,]    0    0    1    0    0    1    0    1    0     1
[5,]    0    0    0    1    0    0    1    0    1     1</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>There is also a special package {<strong>dice</strong>} for the calculation of various dice-rolling events. We could for instance compute the probability “What is the probability of rolling two 6s in three rolls of a six-sided die?” directly with:</p>
<div class="cell">
<div id="lst-package-dice-example" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-package-dice-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.13: Compute the probability of rolling two 6s in three rolls of a six-sided die
</figcaption><div aria-describedby="lst-package-dice-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-package-dice-example"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">dice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dice/man/getEventProb.html">getEventProb</a></span><span class="op">(</span>nrolls <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                   ndicePerRoll <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                   nsidesPerDie <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                   eventList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.052512</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Actually I did not understand the many implications of computing combinations and / or permutations with different functions and different packages:</p>
<ul>
<li><code><a href="https://rdrr.io/r/utils/combn.html">utils::combn()</a></code></li>
<li><code><a href="https://rdrr.io/pkg/combinat/man/combn.html">combinat::combn()</a></code></li>
<li>
<code><a href="https://rdrr.io/pkg/gtools/man/combinations.html">gtools::combinations()</a></code> and <code><a href="https://rdrr.io/pkg/gtools/man/combinations.html">gtools::permutations()</a></code>
</li>
<li>
<code>permute::permute()</code>, <code>permute::shuffle()</code>
</li>
<li><code><a href="https://rdrr.io/r/base/expand.grid.html">base::expand.grid()</a></code></li>
<li>
<code><a href="https://tidyr.tidyverse.org/reference/expand.html">tidyr::expand()</a></code>, <code><a href="https://tidyr.tidyverse.org/reference/expand.html">tidyr::crossing()</a></code>, <code><a href="https://tidyr.tidyverse.org/reference/expand.html">tidyr::nesting()</a></code>, <code><a href="https://tidyr.tidyverse.org/reference/expand_grid.html">tidyr::expand_grid()</a></code>
</li>
</ul>
<p>As far as I understand from my study of the Statistical Rethinking book, these functions are an important topic to understand Bayesian Statistics. These types of functions are used for grid approximation and in Bayesian statistics to extract or draw samples from fit models (e.g., <code>rethinking::extract.samples()</code>, <code>rethinking::extract.prior()</code>)</p>
<p>I am sure I will need to come back to this issue and study available material more in detail! But at the moment I am stuck and will skip this subject.</p>
</div>
</div>
</section><section id="sec-example-4-2" class="level3" data-number="4.7.2"><h3 data-number="4.7.2" class="anchored" data-anchor-id="sec-example-4-2">
<span class="header-section-number">4.7.2</span> Compute binomial coefficient manually</h3>
<p>I want to replicate the Base R function <code>chosse()</code> with <a href="#eq-def-bin-coeff" class="quarto-xref">Equation&nbsp;<span>4.5</span></a>. This involves to calculate factorials with the <code><a href="https://rdrr.io/r/base/Special.html">base::factorial()</a></code> function.</p>
<p><span class="math display">\[\binom{n}{k} = \frac{n!}{k! \times (n-k)!}\]</span></p>
<div class="cell">
<div id="lst-binomial-coeff-example" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-binomial-coeff-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.14: <strong>Calculate the probability of flipping exactly 12 heads in 24 coin tosses</strong>
</figcaption><div aria-describedby="lst-binomial-coeff-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-binomial-coeff-example"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_choose</span> <span class="op">&lt;-</span>  <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">k</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="va">k</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">12</span><span class="op">)</span> <span class="op">==</span> <span class="fu">my_choose</span><span class="op">(</span><span class="fl">24</span>, <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Calculation of <span class="math inline">\(\binom{24}{12}\)</span>:</p>
<ul>
<li>With Base R function <code>choose(24, 12)</code> = 2.704156^{6}.</li>
<li>With my own function <code>my_choose(24, 12)</code> = 2.704156^{6}.</li>
</ul></section><section id="sec-example-4-3" class="level3" data-number="4.7.3"><h3 data-number="4.7.3" class="anchored" data-anchor-id="sec-example-4-3">
<span class="header-section-number">4.7.3</span> Compute density of the binomial distribution</h3>
<p>To generalize I write my own function for the density of the binomial distribution. I will use the same arguments names as in <a href="#def-binom-dist-param" class="quarto-xref">Definition&nbsp;<span>4.1</span></a>.</p>
<div class="cell">
<div id="lst-my-dbinom-func" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-my-dbinom-func-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.15: <strong>Function for the density of the binomial distribution</strong>
</figcaption><div aria-describedby="lst-my-dbinom-func-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-my-dbinom-func"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_dbinom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">k</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">k</span><span class="op">)</span> <span class="op">*</span> <span class="va">p</span><span class="op">^</span><span class="va">k</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="va">k</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_dbinom</span><span class="op">(</span><span class="fl">12</span>, <span class="fl">24</span>, <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1611803</code></pre>
</div>
</div>
<p>Voilá: It gives the same result as the manual calculation in <a href="#lst-calc-example" class="quarto-xref">Listing&nbsp;<span>4.2</span></a>.</p>
<p>I wonder if there is not a Base R function which does the same as <code>my_dbinom()</code>. I tried <code><a href="https://rdrr.io/r/stats/Binomial.html">stats::dbinom()</a></code> and it worked!</p>
<div class="cell">
<div id="lst-dbinom-func" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-dbinom-func-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.16: <strong>Base R dbinom() function calculates the density of the binomial distribution</strong>
</figcaption><div aria-describedby="lst-dbinom-func-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-dbinom-func"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">24</span>, <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1611803</code></pre>
</div>
</div>
<p>Again the same result as in <a href="#lst-calc-example" class="quarto-xref">Listing&nbsp;<span>4.2</span></a> and <a href="#lst-my-dbinom-func" class="quarto-xref">Listing&nbsp;<span>4.15</span></a>!</p>
</section><section id="sec-10-coin-flips" class="level3" data-number="4.7.4"><h3 data-number="4.7.4" class="anchored" data-anchor-id="sec-10-coin-flips">
<span class="header-section-number">4.7.4</span> Replication of the Binomial Distribution of 10 Coin Flips</h3>
<p>Here I am going to try to replicate <a href="#fig-10-coin-flips" class="quarto-xref">Figure&nbsp;<span>4.1</span></a>.</p>
<div class="cell">
<div id="lst-repl-10-coin-flips" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-repl-10-coin-flips-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.17: <strong>Replicate Figure 4.1: Binomial Distribution of 10 Coin Flips</strong>
</figcaption><div aria-describedby="lst-repl-10-coin-flips-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-repl-10-coin-flips"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq.int</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">10</span> , by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k_values</span>, </span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">k_values</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-repl-10-coin-flips" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-repl-10-coin-flips-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.4: Replication of Figure 4.1: Binomial Distribution of 10 Coin Flips with {ggplot2}
</figcaption><div aria-describedby="fig-repl-10-coin-flips-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-binomial-distribution_files/figure-html/fig-repl-10-coin-flips-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>Writing <a href="#lst-repl-10-coin-flips" class="quarto-xref">Listing&nbsp;<span>4.17</span></a> I had troubles applying the correct geom. At first I used <code>geom_bar()</code> but this did not work until I learned that I have to add the option “stat = identity” or to use <code>geom_col()</code>. The difference is:</p>
<ul>
<li>
<code>geom_bar()</code> makes the height of the bar proportional to the number of cases in each group. It uses <code>stat_count()</code> by default, e.g.&nbsp;it counts the number of cases at each x position. If there aren’t cases but only the values then one has to add “stat = identity” to declare that ggplot2 should take the data “as-is”.<br>
</li>
<li>
<code>geom_col()</code> instead takes the heights of the bars to represent values in the data. It uses <code>stat_identity()</code> and leaves the data “as-is” by default.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>During my research for writing <a href="#lst-repl-10-coin-flips" class="quarto-xref">Listing&nbsp;<span>4.17</span></a> I learned of the {<strong>tidydice</strong>} package. It simulates dice rolls and coin flips and can be used for teaching basic experiments in introductory statistics courses.</p>
<p>With {<strong>tidydice</strong>} we replicate Figure 4.1 with just 2 lines using the <code>binom_coin()</code> inside the <code>plot_binom()</code> function. In addition to the graphical distribution it print also the exact values on top of the bars.</p>
<div class="cell">
<div id="lst-repl-10-coin-flips-2" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-repl-10-coin-flips-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.18: <strong>Replicate Figure 4.1: Binomial Distribution of 10 Coin Flips {tidydice}</strong>
</figcaption><div aria-describedby="lst-repl-10-coin-flips-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-repl-10-coin-flips-2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tidydice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidydice/man/plot_binom.html">plot_binom</a></span><span class="op">(</span></span>
<span>  <span class="fu">tidydice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidydice/man/binom_coin.html">binom_coin</a></span><span class="op">(</span>times <span class="op">=</span> <span class="fl">10</span>, sides <span class="op">=</span> <span class="fl">2</span>, success <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Binomial distribution of 10 coin flips"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-repl-10-coin-flips-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-repl-10-coin-flips-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.5: Replication of Figure 4.1: Binomial Distribution of 10 Coin Flips with {tidydice}
</figcaption><div aria-describedby="fig-repl-10-coin-flips-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-binomial-distribution_files/figure-html/fig-repl-10-coin-flips-2-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>{<strong>tidydice</strong>} has many other functions related to coin and dice experiments.</p>
</div>
</div>
</section><section id="sec-example-4-4" class="level3" data-number="4.7.5"><h3 data-number="4.7.5" class="anchored" data-anchor-id="sec-example-4-4">
<span class="header-section-number">4.7.5</span> Replication of the Binomial Distribution of 10 Dice Rolls</h3>
<p>I will replicate <a href="#fig-10-dice-rolls" class="quarto-xref">Figure&nbsp;<span>4.2</span></a> with {<strong>ggplot2</strong>} and with {<strong>tidydice</strong>}:</p>
<div class="cell">
<div id="lst-repl-10-cdice-rolls" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-repl-10-cdice-rolls-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.19: <strong>Replicate Figure 4.2: Binomial Distribution of 10 Dice Rolls</strong>
</figcaption><div aria-describedby="lst-repl-10-cdice-rolls-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-repl-10-cdice-rolls"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq.int</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">10</span> , by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k_values</span>, </span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">k_values</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-repl-10-dice-rolls" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-repl-10-dice-rolls-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.6: Replication of Figure 4.2: Binomial Distribution of 10 Dice Rolls with {ggplot2}
</figcaption><div aria-describedby="fig-repl-10-dice-rolls-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-binomial-distribution_files/figure-html/fig-repl-10-dice-rolls-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="lst-repl-10-dice-rolls-2" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-repl-10-dice-rolls-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;4.20: <strong>Replicate Figure 4.2: Binomial Distribution of 10 Dice Rolls {tidydice}</strong>
</figcaption><div aria-describedby="lst-repl-10-dice-rolls-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-repl-10-dice-rolls-2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tidydice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidydice/man/plot_binom.html">plot_binom</a></span><span class="op">(</span></span>
<span>  <span class="fu">tidydice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidydice/man/binom_dice.html">binom_dice</a></span><span class="op">(</span>times <span class="op">=</span> <span class="fl">10</span>, sides <span class="op">=</span> <span class="fl">6</span>, success <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Binomial distribution of 10 dice rolls"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-repl-10-dice-rolls-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-repl-10-dice-rolls-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.7: Replication of Figure 4.2: Binomial Distribution of 10 Dice Rolls with {tidydice}
</figcaption><div aria-describedby="fig-repl-10-dice-rolls-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-binomial-distribution_files/figure-html/fig-repl-10-dice-rolls-2-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./03-logic-uncertainty.html" class="pagination-link" aria-label="Logic of Uncertainty">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Logic of Uncertainty</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-beta-distribution.html" class="pagination-link" aria-label="The Beta Distribution">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The Beta Distribution</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="an">engine:</span><span class="co"> knitr</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Creating a Binomial Probability Distribution {#sec-prob-dist}</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Structure of a Binomial Distribution</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>A binomial distribution is used to calculate the probability of a</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>certain number of successful outcomes, given a number of trials and the</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>probability of the successful outcome. The "bi" in the term binomial</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>refers to the two possible outcomes that we're concerned with: an event</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>happening and an event not happening. (If there are more than two</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>outcomes, the distribution is called multinomial.)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>Examples for a binomial distribution are:</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Flipping two heads in three coin tosses</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Buying 1 million lottery tickets and winning at least once</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rolling fewer than three 20s in 10 rolls of a 20-sided die</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>::: {#def-binom-dist-param}</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parameter for the binomial distribution</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>All binomial distributions involve three parameters:</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`k`</span> The number of outcomes we care about</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`n`</span> The total number of trials</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`p`</span> The probability of the event happening</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>Calculating the probability of flipping two heads in three coin tosses:</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$k = 2$, the number of events we care about, in this case flipping a</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    heads</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$n = 3$, the number times the coin is flipped</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$p = 1/2$, the probability of flipping a heads in a coin toss</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>::: {#thm-binomial-distribution-shorthand-notation}</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Shorthand notation of a binomial distribution</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>$$B(k; n, p)$$ {#eq-short-notation}</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>For the example of two heads in three coin tosses, we would write</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>$B(2; 3, 1/2)$.</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`B`</span> stands for *binomial* distribution</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`k`</span> is separated from the other parameters by a semicolon. This is</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>    because when we are talking about a distribution of values, we</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>    usually care about all values of $k$ for a fixed $n$ and $p$.</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`B(k; n, p)`</span> denotes each value in the distribution</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`B(n, p)`</span> denotes the whole distribution</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="fu">## Understanding and Abstracting Out the Details of Our Problem</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>We'll continue with the example of calculating the probability of</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>flipping two heads in three coin tosses. Since the number of possible</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>outcomes is small, we can quickly figure out the results we care about</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>with just pencil and paper.</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>$$HHT, HTH, THH$$ To start generalizing, we'll break this problem down</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>into smaller pieces we can solve right now, and reduce those pieces into</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>manageable equations. As we build up the equations, we'll put them</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>together to create a generalized function for the binomial distribution.</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>::: {#thm-permuation-example}</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Permuation Example for the Binomial Distribution</span></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each outcome we care about will have the *same* probability.</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each outcome is just a permutation (GLOSSARY), or reordering,</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>    of the others</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>P({heads, heads, tails}) = P({heads, tails, heads}) = P({tails, heads, heads}) = <span class="sc">\\</span></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>P(\text{Desired Outcome})</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>$$ {#eq-permutation-example}</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>See how to do this calculation with R in @sec-example-4-1.</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>There are three outcomes, but only one of them can possibly happen and</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>we don't care which. And because it's only possible for one outcome to</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>occur, we know that these are mutually exclusive, denoted as:</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>$$P(<span class="sc">\{</span>heads, heads, tails<span class="sc">\}</span>,<span class="sc">\{</span>heads, tails, heads<span class="sc">\}</span>,<span class="sc">\{</span>tails, heads, heads<span class="sc">\}</span>) = 0$$</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>This makes using the sum rule of probability easy.</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>P(<span class="sc">\{</span>heads, heads, tails<span class="sc">\}</span> \operatorname{OR} <span class="sc">\{</span>heads, tails, heads<span class="sc">\}</span> \operatorname{OR} <span class="sc">\{</span>tails, heads, heads<span class="sc">\}</span>) = <span class="sc">\\</span></span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>P(\text{Desired Outcome}) + P(\text{Desired Outcome}) + P(\text{Desired Outcome}) = <span class="sc">\\</span></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>3 \times P(Desired Outcome)</span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>$$ The value "3" is specific to this problem and therefore not</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>generalizable. We can fix this by simply replacing "3" with a variable</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>called $N_{outcomes}$.</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>::: {#thm-pmf-placeholder}</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Solution with place holders</span></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>$$B(k;n,p) = N_{outcomes} \times P(\text{Desired Outcome})$$ {#eq-pmf-placeholder}</span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>Now we have to figure out two subproblems:</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>How to count the number of outcomes we care about?</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>How to determine the probability for a single outcome?</span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a><span class="fu">## Counting Our Outcomes with the Binomial Coefficient</span></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>First we need to figure out how many outcomes there are for a given k</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>(the outcomes we care about) and n (the number of trials). For small</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>numbers we can simply count. But it doesn't take much for this to become</span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a>too difficult to do by hand. The solution is combinatorics (GLOSSARY))`.</span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combinatorics: Advanced Counting with the Binomial Coefficient</span></span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>There is a special operation in combinatorics, called the *binomial</span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>coefficient*, that represents counting the number of ways we can select</span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a><span class="in">`k`</span> from <span class="in">`n`</span> --- that is, selecting the outcomes we care about from the</span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>total number of trials.</span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>::: {#thm-binomial-coefficient}</span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Notation for the binomial coefficient</span></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>$$\binom{n}{k}$$ {#eq-binomial-coefficient}</span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a>We read this as "n choose k". In our example we would say "in three</span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a>tosses choose two heads":</span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>$$\binom{3}{2}$$</span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a>::: {#thm-def-bin-coeff}</span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Definition of the binomial coefficient operation</span></span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>$$\binom{n}{k} = \frac{n!}{k! \times (n-k)!}$$ {#eq-def-bin-coeff}</span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a>The <span class="in">`!`</span> means *factorial*, which is the product of all the numbers up to</span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a>and including the number before the <span class="in">`!`</span> symbol, so</span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a>$5! = (5 × 4 × 3 × 2 × 1)$.</span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>In R we compute the binomial coefficient for the case of flipping two</span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a>heads in three tosses with the following function call:</span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: binomial-coeff</span></span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-binomial-coeff lst-cap="**Compute the binomial coefficient for flipping two heads in three tosses**"'</span></span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a>See how to calculate the binomial coefficient with Base R in</span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a>@sec-example-4-2.</span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a>We can now replace $N_{Outcomes}$ in @eq-pmf-placeholder with the</span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a>binomial coefficient:</span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>$$B(k;n,p) = \binom{n}{k} \times P(\text{Desired Outcome})$$</span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculating the Probability of the Desired Outcome</span></span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a>All we have left to figure out is the $P(\text{Desired Outcome})$, which</span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a>is the probability of any of the possible events we care about. So far</span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a>we've been using $P(\text{Desired Outcome})$ as a variable to help</span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a>organize our solution to this problem, but now we need to figure out</span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a>exactly how to calculate this value.</span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>Let's focus on a single case of our example of tow heads in three</span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a>tosses: $HHT$. Using the product rule and negation from the previous</span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a>chapter, we can describe this problem as:</span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a>$$P(heads, heads, no heads) = P(heads, heads, 1-heads)$$ Now we can use</span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a>the product rule from @eq-product-rule:</span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a>P(heads, heads, 1-heads) = <span class="sc">\\</span></span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a>P(heads) \times P(heads) \times (1-P(heads)) = <span class="sc">\\</span></span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a>P(heads)^2 \times (1-P(heads))^1</span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a>$$ You can see that the exponents for $P(heads)^2$ and $1 – P(heads)^1$</span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>are just the number of heads and the number of not heads in our</span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a>scenario. These equate to <span class="in">`k`</span>, the number of outcomes we care about, and</span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a><span class="in">`n – k`</span>, the number of trials minus the outcomes we care about. Puting</span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>all together:</span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>\binom{n}{k} \times P(heads)^{k} \times (1- P(heads))^{n-k}</span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a>$$ Generalizing for any probability, not just heads, we replace</span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a>$P(heads)$ with just <span class="in">`p`</span>. This gives us a *general solution*. Compare</span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a>the following list with @def-binom-dist-param.</span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`k`</span>, the number of outcomes we care about;</span>
<span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`n`</span>, the number of trials; and</span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`p`</span>, the probability of the individual outcome.</span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a>::: {#thm-pmf}</span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Probability Mass Function (PMF) for the Binomial Distribution</span></span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a>\binom{n}{k} \times p^{k} \times (1- p)^{n-k}</span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a>$$ {#eq-pmf}</span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a>@eq-pmf is the basis of the binomial distribution. It is called a Probability Mass Function (GLOSSARY) (PMF). The *mass* part of the</span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a>name comes from the fact that we can use it to calculate the amount of</span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a>probability for any given <span class="in">`k`</span> using a fixed <span class="in">`n`</span> and <span class="in">`p`</span>, so this is the</span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a>mass of our probability.</span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a>Now that we have this equation, we can solve any problem related to</span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a>outcomes of a coin toss. For example, we could calculate the probability</span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a>of flipping exactly 12 heads in 24 coin tosses:</span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a>B(12,24,\frac{1}{2}) = \binom{24}{12} \times (\frac{1}{2})^{12} \times (1-\frac{1}{2})^{24-12} = 0.1611803</span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: calc-example</span></span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-calc-example lst-cap="**Calculate the probability of flipping exactly 12 heads in 24 coin tosses**"'</span></span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">24</span>,<span class="dv">12</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">12</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">24</span> <span class="sc">-</span> <span class="dv">12</span>)</span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a>The calculation in @lst-calc-example is only valid for our concrete</span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a>example.</span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a>For example, we can plug in all the possible values for <span class="in">`k`</span> in 10 coin</span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a>tosses into our PMF and visualize what the binomial distribution looks</span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a>like for all possible values.</span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a>![Binomial Distribution for 10 Coin</span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a>Flips](img/04fig01.jpg){#fig-10-coin-flips</span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a>fig-alt="Bar graph showing the probability of getting k in 10 coin flips"</span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a>fig-align="center" width=70%}</span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a>See my @fig-repl-10-coin-flips as a replication of @fig-10-coin-flips.</span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a>We can also look at the same distribution for the probability of getting a 6 when rolling a six-sided die 10 times, as shown in @fig-10-dice-rolls.</span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a>![Binomial Distribution for 10 Coin</span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a>Flips](img/04fig02.jpg){#fig-10-dice-rolls</span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a>fig-alt="Bar graph showing the probability of getting a 6 when rolling a six-sided die 10 times"</span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a>fig-align="center" width=70%}</span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a>Again I replicated @fig-10-dice-rolls with my @fig-repl-10-dice-rolls.</span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>Bottom line of the discussion in this section: A probability distribution is a way of generalizing an entire class of problems.</span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example: Gacha Games {#sec-gacha-games}</span></span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a>There is only one new content in this section: Instead of computing the probability of one event we are going to calculate the possibility of drawing *at least* one specific card from a pile of infinite numbers of cards where we know the probability of this card we are interested. The aim is to have a <span class="in">`p`</span> of at last 50% with 100 trials and a probability of 0.720% for the card we are interested.</span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a>At first let us compute the probability for getting *exactly one card* we are interested with 100 draws form the pile. We know the probability to draw the featured card is 0.720%.</span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a>$$\binom{100}{1} \times 0.00720^{1} \times (1- 0.00720)^{100-1}$$</span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-303"><a href="#cb17-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-304"><a href="#cb17-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: draw-exact-one-card</span></span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-draw-exact-one-card lst-cap="Draw exact one card that has p = 0.720%"'</span></span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="fl">0.00720</span>)</span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a>And now let's compute the probability for *at least one card* we are interested.</span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a>In R, we can use the Binomial Cumulative Distribution Function <span class="in">`pbinom()`</span> to automatically sum up all the values of the card we are interested in our PMF. </span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a><span class="al">![How the pbinom() function works](img/04fig03.jpg)</span>{#fig-pbinom-function</span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a>fig-alt="Explaining the structure of the pbinom() function"</span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a>fig-align="center" width=60%}</span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a>The <span class="in">`pbinom()`</span> function takes three required arguments and an optional fourth called <span class="in">`lower.tail`</span> (which defaults to TRUE). When the fourth argument is TRUE, the first argument sums up all of the probabilities less than or equal to our argument. When <span class="in">`lower.tail`</span> is set to FALSE, it sums up the probabilities strictly greater than the first argument. By setting the first argument to $0$, we are looking at the probability of getting one or more the cards we are interested. We set <span class="in">`lower.tail`</span> to FALSE because that means we want values greater than the first argument (by default, we get values less than the first argument).</span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: use-pbinom-example</span></span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-use-pbinom-example lst-cap="Example Calculation with the pbinom() Function"'</span></span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.00720</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-327"><a href="#cb17-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a>Voilá! This is the same result as in @#fig-pbinom-function.</span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wrapping Up</span></span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a>In this chapter Will Kurt demonstrated how we can deduce intuitively the formula for the binomial coefficient (GLOSSARY). </span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a>I have seen this monstrosity of expression for the binomial coefficient many times in different books and was always overwhelmed from its complexity. But this has changed now: Will Kurt succeeded to demystify the formula for me!</span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb17-340"><a href="#cb17-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a>Try answering the following questions to make sure you’ve grasped binomial distributions fully. The solutions can be found at https://nostarch.com/learnbayes/.</span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise 4.1</span></span>
<span id="cb17-344"><a href="#cb17-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-345"><a href="#cb17-345" aria-hidden="true" tabindex="-1"></a>::: {#exr-04-1}</span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a>What are the parameters of the binomial distribution for the probability of rolling either a 1 or a 20 on a 20-sided die, if we roll the die 12 times?</span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>k = interested events: 1 and 20 = 2.</span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>n = number of trials = 12</span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p = probability for each trial = $\frac{2}{12}$</span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-04-1</span></span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-exercise-04-1 lst-cap="**Binomial distribution for the probability of rolling either a 1 or a 20 on a 20-sided die, if we roll the die 12 times**"'</span></span>
<span id="cb17-357"><a href="#cb17-357" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">20</span>)</span>
<span id="cb17-358"><a href="#cb17-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-360"><a href="#cb17-360" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-361"><a href="#cb17-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise 4.2</span></span>
<span id="cb17-365"><a href="#cb17-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-366"><a href="#cb17-366" aria-hidden="true" tabindex="-1"></a>::: {#exr-04-2}</span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a>There are four aces in a deck of 52 cards. If you pull a card, return the card, then reshuffle and pull a card again, how many ways can you pull just one ace in five pulls?</span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-369"><a href="#cb17-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-372"><a href="#cb17-372" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-373"><a href="#cb17-373" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-04-2</span></span>
<span id="cb17-374"><a href="#cb17-374" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-exercise-04-2 lst-cap="**If you pull a card, return the card, then reshuffle and pull a card again, how many ways can you pull just one ace in five pulls?**"'</span></span>
<span id="cb17-375"><a href="#cb17-375" aria-hidden="true" tabindex="-1"></a>combinat<span class="sc">::</span><span class="fu">combn</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">fun =</span> tabulate, <span class="at">simplify =</span> <span class="cn">TRUE</span>, <span class="at">nbins =</span> <span class="dv">5</span>)</span>
<span id="cb17-376"><a href="#cb17-376" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb17-377"><a href="#cb17-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-378"><a href="#cb17-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-379"><a href="#cb17-379" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb17-380"><a href="#cb17-380" aria-hidden="true" tabindex="-1"></a>In contrast to the result in the solution manual I programmed the exercise with <span class="in">`combinat::combn()`</span>. This correct solution pretends that I could use it for every possible arrangement. That is not true. For instance I could not manage to display the many ways of rolling two 6s in three rolls of a six-sided die.</span>
<span id="cb17-381"><a href="#cb17-381" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-382"><a href="#cb17-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-383"><a href="#cb17-383" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-384"><a href="#cb17-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-385"><a href="#cb17-385" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb17-386"><a href="#cb17-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-387"><a href="#cb17-387" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise 4.3</span></span>
<span id="cb17-388"><a href="#cb17-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-389"><a href="#cb17-389" aria-hidden="true" tabindex="-1"></a>:::: {#exr-04-3}</span>
<span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a>For the example in @exr-04-2, what is the probability of pulling five aces in 10 pulls (remember the card is shuffled back in the deck when it is pulled)?</span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-395"><a href="#cb17-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-04-3</span></span>
<span id="cb17-396"><a href="#cb17-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-exercise-04-3 lst-cap="**Probability of pulling five aces in 10 pulls with replacing**"'</span></span>
<span id="cb17-397"><a href="#cb17-397" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">4</span> <span class="sc">/</span> <span class="dv">52</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb17-398"><a href="#cb17-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb17-401"><a href="#cb17-401" aria-hidden="true" tabindex="-1"></a>Only about 0.0455%. But this is different than the result in the solution manual with 1/32000 = <span class="in">`r 1/32000 * 100`</span>%. I don't know why there is this difference.</span>
<span id="cb17-402"><a href="#cb17-402" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-404"><a href="#cb17-404" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb17-405"><a href="#cb17-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-406"><a href="#cb17-406" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-408"><a href="#cb17-408" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise 4.4</span></span>
<span id="cb17-409"><a href="#cb17-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a>:::: {#exr-04-4}</span>
<span id="cb17-411"><a href="#cb17-411" aria-hidden="true" tabindex="-1"></a>When you’re searching for a new job, it’s always helpful to have more than one offer on the table so you can use it in negotiations. If you have a 1/5 probability of receiving a job offer when you interview, and you interview with seven companies in a month, what is the probability you’ll have at least two competing offers by the end of that month?</span>
<span id="cb17-412"><a href="#cb17-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-415"><a href="#cb17-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-416"><a href="#cb17-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-04-4</span></span>
<span id="cb17-417"><a href="#cb17-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-exercise-04-4 lst-cap="**Probability of at least 2 interviews each with 1/5 chance for a job offer having 7 interviews**"' </span></span>
<span id="cb17-418"><a href="#cb17-418" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-419"><a href="#cb17-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-420"><a href="#cb17-420" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb17-421"><a href="#cb17-421" aria-hidden="true" tabindex="-1"></a>There is chance of about 42% that you receive at least two job offers.</span>
<span id="cb17-422"><a href="#cb17-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-423"><a href="#cb17-423" aria-hidden="true" tabindex="-1"></a>In my first trial I calculated wrongly the probability for *exact 2* competing offers with `dbinom(2, 7, 1/2)` instead of *at least 2* competing offers! Additionally I forgot to add `lower.tail = FALSE`. to calculate *more than x*: x = 1, more than 1 = 2, therefore the first parameter is 1 (and not 2 as could be thought wrongly). Not using <span class="in">`lower.tail = FALSE`</span> means that the default value of <span class="in">`lower.tail = TRUE`</span> computes the probability of $P<span class="co">[</span><span class="ot">X &lt;= x</span><span class="co">]</span>$ (instead of $P<span class="co">[</span><span class="ot">X &gt; x</span><span class="co">]</span>$).</span>
<span id="cb17-424"><a href="#cb17-424" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-425"><a href="#cb17-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-426"><a href="#cb17-426" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb17-427"><a href="#cb17-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-428"><a href="#cb17-428" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb17-429"><a href="#cb17-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-430"><a href="#cb17-430" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise 4.5</span></span>
<span id="cb17-431"><a href="#cb17-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-432"><a href="#cb17-432" aria-hidden="true" tabindex="-1"></a>::: {#exr-04-5}</span>
<span id="cb17-433"><a href="#cb17-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-434"><a href="#cb17-434" aria-hidden="true" tabindex="-1"></a>You get a bunch of recruiter emails and find out you have 25 interviews lined up in the next month. Unfortunately, you know this will leave you exhausted, and the probability of getting an offer will drop to 1/10 if you’re tired. You really don’t want to go on this many interviews unless you are at least twice as likely to get at least two competing offers. Are you more likely to get at least two offers if you go for 25 interviews, or stick to just 7?</span>
<span id="cb17-435"><a href="#cb17-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-438"><a href="#cb17-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-439"><a href="#cb17-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exercise-04-5</span></span>
<span id="cb17-440"><a href="#cb17-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-exercise-04-5 lst-cap="**Probability of at least 2 interviews each with 1/10 chance for a job offer having 25 interviews**"'</span></span>
<span id="cb17-441"><a href="#cb17-441" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">1</span>, <span class="dv">25</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-442"><a href="#cb17-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-443"><a href="#cb17-443" aria-hidden="true" tabindex="-1"></a>With a reduced probability per interview you raised your changes from 42,3% to 72,9%. But to get an job offer is not twice as likely so you stick with 7 interviews.</span>
<span id="cb17-444"><a href="#cb17-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-445"><a href="#cb17-445" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-446"><a href="#cb17-446" aria-hidden="true" tabindex="-1"></a>***</span>
<span id="cb17-447"><a href="#cb17-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-448"><a href="#cb17-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-449"><a href="#cb17-449" aria-hidden="true" tabindex="-1"></a><span class="fu">## Experiments</span></span>
<span id="cb17-450"><a href="#cb17-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-451"><a href="#cb17-451" aria-hidden="true" tabindex="-1"></a><span class="fu">### Permutation with R {#sec-example-4-1}</span></span>
<span id="cb17-452"><a href="#cb17-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-453"><a href="#cb17-453" aria-hidden="true" tabindex="-1"></a>I want to get the same result as in @eq-permutation-example, but this</span>
<span id="cb17-454"><a href="#cb17-454" aria-hidden="true" tabindex="-1"></a>time using R. What are the permutations of possible events by flipping</span>
<span id="cb17-455"><a href="#cb17-455" aria-hidden="true" tabindex="-1"></a>two heads in three coin tosses?</span>
<span id="cb17-456"><a href="#cb17-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-457"><a href="#cb17-457" aria-hidden="true" tabindex="-1"></a>Let's P(heads) = 1 and P(tails) = 0, then we can use</span>
<span id="cb17-458"><a href="#cb17-458" aria-hidden="true" tabindex="-1"></a><span class="in">`combinat::combn()`</span>. The package {**combinat**} is not part of Base R,</span>
<span id="cb17-459"><a href="#cb17-459" aria-hidden="true" tabindex="-1"></a>so you have to install it.</span>
<span id="cb17-460"><a href="#cb17-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-463"><a href="#cb17-463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-464"><a href="#cb17-464" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: permutate-3-2</span></span>
<span id="cb17-465"><a href="#cb17-465" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-permutate-3-2 lst-cap="Permutations of possible events by flipping two heads in three coin tosses"'</span></span>
<span id="cb17-466"><a href="#cb17-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-467"><a href="#cb17-467" aria-hidden="true" tabindex="-1"></a>combinat<span class="sc">::</span><span class="fu">combn</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">m =</span> <span class="dv">2</span>, <span class="at">fun =</span> tabulate, <span class="at">simplify =</span> <span class="cn">TRUE</span>, <span class="at">nbins =</span> <span class="dv">3</span>)</span>
<span id="cb17-468"><a href="#cb17-468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-469"><a href="#cb17-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-470"><a href="#cb17-470" aria-hidden="true" tabindex="-1"></a>The syntax is: <span class="in">`combn(x, m, fun = NULL, simplify = TRUE, ...)`</span>.</span>
<span id="cb17-471"><a href="#cb17-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-472"><a href="#cb17-472" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`x`</span>: vector source for combinations equivalent to the the number of</span>
<span id="cb17-473"><a href="#cb17-473" aria-hidden="true" tabindex="-1"></a>    events.</span>
<span id="cb17-474"><a href="#cb17-474" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`m`</span>: number of elements we are interested in</span>
<span id="cb17-475"><a href="#cb17-475" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`fun`</span> = function to be applied to each combination (may be null). I</span>
<span id="cb17-476"><a href="#cb17-476" aria-hidden="true" tabindex="-1"></a>    am using the <span class="in">`base::tabulate()`</span> to take the integer-valued vector</span>
<span id="cb17-477"><a href="#cb17-477" aria-hidden="true" tabindex="-1"></a>    and counting the number of times each integer occurs in it.</span>
<span id="cb17-478"><a href="#cb17-478" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`simplify`</span>: logical, if FALSE, returns a list, otherwise returns</span>
<span id="cb17-479"><a href="#cb17-479" aria-hidden="true" tabindex="-1"></a>    vector or array.</span>
<span id="cb17-480"><a href="#cb17-480" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`...`</span>: arguments for the used function. In our case <span class="in">`nbins`</span> refers</span>
<span id="cb17-481"><a href="#cb17-481" aria-hidden="true" tabindex="-1"></a>    to the number of bin used by the <span class="in">`tabulate()`</span> function.</span>
<span id="cb17-482"><a href="#cb17-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-483"><a href="#cb17-483" aria-hidden="true" tabindex="-1"></a>Let's try another example to understand better the pattern of the</span>
<span id="cb17-484"><a href="#cb17-484" aria-hidden="true" tabindex="-1"></a><span class="in">`combn()`</span> functions: What are the permutations of possible events by</span>
<span id="cb17-485"><a href="#cb17-485" aria-hidden="true" tabindex="-1"></a>flipping a coin 5 times and getting three heads:</span>
<span id="cb17-486"><a href="#cb17-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-489"><a href="#cb17-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-490"><a href="#cb17-490" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: permutate-5-3</span></span>
<span id="cb17-491"><a href="#cb17-491" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-permutate-3-2 lst-cap="Permutations of possible events by flipping two heads in five coin tosses"'</span></span>
<span id="cb17-492"><a href="#cb17-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-493"><a href="#cb17-493" aria-hidden="true" tabindex="-1"></a>combinat<span class="sc">::</span><span class="fu">combn</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">m =</span> <span class="dv">2</span>, <span class="at">fun =</span> tabulate, <span class="at">simplify =</span> <span class="cn">TRUE</span>, <span class="at">nbins =</span> <span class="dv">5</span>)</span>
<span id="cb17-494"><a href="#cb17-494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-495"><a href="#cb17-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-496"><a href="#cb17-496" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb17-497"><a href="#cb17-497" aria-hidden="true" tabindex="-1"></a>There is also a special package {**dice**} for the calculation of</span>
<span id="cb17-498"><a href="#cb17-498" aria-hidden="true" tabindex="-1"></a>various dice-rolling events. We could for instance compute the</span>
<span id="cb17-499"><a href="#cb17-499" aria-hidden="true" tabindex="-1"></a>probability "What is the probability of rolling two 6s in three rolls of</span>
<span id="cb17-500"><a href="#cb17-500" aria-hidden="true" tabindex="-1"></a>a six-sided die?" directly with:</span>
<span id="cb17-501"><a href="#cb17-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-504"><a href="#cb17-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-505"><a href="#cb17-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: package-dice-example</span></span>
<span id="cb17-506"><a href="#cb17-506" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-package-dice-example lst-cap="Compute the probability of rolling two 6s in three rolls of a six-sided die"'</span></span>
<span id="cb17-507"><a href="#cb17-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-508"><a href="#cb17-508" aria-hidden="true" tabindex="-1"></a>dice<span class="sc">::</span><span class="fu">getEventProb</span>(<span class="at">nrolls =</span> <span class="dv">3</span>,</span>
<span id="cb17-509"><a href="#cb17-509" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ndicePerRoll =</span> <span class="dv">2</span>,</span>
<span id="cb17-510"><a href="#cb17-510" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nsidesPerDie =</span> <span class="dv">6</span>,</span>
<span id="cb17-511"><a href="#cb17-511" aria-hidden="true" tabindex="-1"></a>                   <span class="at">eventList =</span> <span class="fu">list</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb17-512"><a href="#cb17-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-513"><a href="#cb17-513" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-514"><a href="#cb17-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-515"><a href="#cb17-515" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb17-516"><a href="#cb17-516" aria-hidden="true" tabindex="-1"></a>Actually I did not understand the many implications of computing</span>
<span id="cb17-517"><a href="#cb17-517" aria-hidden="true" tabindex="-1"></a>combinations and / or permutations with different functions and</span>
<span id="cb17-518"><a href="#cb17-518" aria-hidden="true" tabindex="-1"></a>different packages:</span>
<span id="cb17-519"><a href="#cb17-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-520"><a href="#cb17-520" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`utils::combn()`</span></span>
<span id="cb17-521"><a href="#cb17-521" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`combinat::combn()`</span></span>
<span id="cb17-522"><a href="#cb17-522" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`gtools::combinations()`</span> and <span class="in">`gtools::permutations()`</span></span>
<span id="cb17-523"><a href="#cb17-523" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`permute::permute()`</span>, <span class="in">`permute::shuffle()`</span></span>
<span id="cb17-524"><a href="#cb17-524" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`base::expand.grid()`</span></span>
<span id="cb17-525"><a href="#cb17-525" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`tidyr::expand()`</span>, <span class="in">`tidyr::crossing()`</span>, <span class="in">`tidyr::nesting()`</span>,</span>
<span id="cb17-526"><a href="#cb17-526" aria-hidden="true" tabindex="-1"></a>    <span class="in">`tidyr::expand_grid()`</span></span>
<span id="cb17-527"><a href="#cb17-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-528"><a href="#cb17-528" aria-hidden="true" tabindex="-1"></a>As far as I understand from my study of the Statistical Rethinking book,</span>
<span id="cb17-529"><a href="#cb17-529" aria-hidden="true" tabindex="-1"></a>these functions are an important topic to understand Bayesian</span>
<span id="cb17-530"><a href="#cb17-530" aria-hidden="true" tabindex="-1"></a>Statistics. These types of functions are used for grid approximation and</span>
<span id="cb17-531"><a href="#cb17-531" aria-hidden="true" tabindex="-1"></a>in Bayesian statistics to extract or draw samples from fit models (e.g.,</span>
<span id="cb17-532"><a href="#cb17-532" aria-hidden="true" tabindex="-1"></a><span class="in">`rethinking::extract.samples()`</span>, <span class="in">`rethinking::extract.prior()`</span>)</span>
<span id="cb17-533"><a href="#cb17-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-534"><a href="#cb17-534" aria-hidden="true" tabindex="-1"></a>I am sure I will need to come back to this issue and study available</span>
<span id="cb17-535"><a href="#cb17-535" aria-hidden="true" tabindex="-1"></a>material more in detail! But at the moment I am stuck and will skip this</span>
<span id="cb17-536"><a href="#cb17-536" aria-hidden="true" tabindex="-1"></a>subject.</span>
<span id="cb17-537"><a href="#cb17-537" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-538"><a href="#cb17-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-539"><a href="#cb17-539" aria-hidden="true" tabindex="-1"></a><span class="fu">### Compute binomial coefficient manually {#sec-example-4-2}</span></span>
<span id="cb17-540"><a href="#cb17-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-541"><a href="#cb17-541" aria-hidden="true" tabindex="-1"></a>I want to replicate the Base R function <span class="in">`chosse()`</span> with</span>
<span id="cb17-542"><a href="#cb17-542" aria-hidden="true" tabindex="-1"></a>@eq-def-bin-coeff. This involves to calculate factorials with the</span>
<span id="cb17-543"><a href="#cb17-543" aria-hidden="true" tabindex="-1"></a><span class="in">`base::factorial()`</span> function.</span>
<span id="cb17-544"><a href="#cb17-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-545"><a href="#cb17-545" aria-hidden="true" tabindex="-1"></a>$$\binom{n}{k} = \frac{n!}{k! \times (n-k)!}$$</span>
<span id="cb17-546"><a href="#cb17-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-549"><a href="#cb17-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-550"><a href="#cb17-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: binomial-coeff-example</span></span>
<span id="cb17-551"><a href="#cb17-551" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-binomial-coeff-example lst-cap="**Calculate the probability of flipping exactly 12 heads in 24 coin tosses**"'</span></span>
<span id="cb17-552"><a href="#cb17-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-553"><a href="#cb17-553" aria-hidden="true" tabindex="-1"></a>my_choose <span class="ot">&lt;-</span>  <span class="cf">function</span>(n, k) {</span>
<span id="cb17-554"><a href="#cb17-554" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factorial</span>(n) <span class="sc">/</span> (<span class="fu">factorial</span>(k) <span class="sc">*</span> <span class="fu">factorial</span>(n <span class="sc">-</span> k))</span>
<span id="cb17-555"><a href="#cb17-555" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-556"><a href="#cb17-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-557"><a href="#cb17-557" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">24</span>, <span class="dv">12</span>) <span class="sc">==</span> <span class="fu">my_choose</span>(<span class="dv">24</span>, <span class="dv">12</span>)</span>
<span id="cb17-558"><a href="#cb17-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-559"><a href="#cb17-559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-560"><a href="#cb17-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-561"><a href="#cb17-561" aria-hidden="true" tabindex="-1"></a>Calculation of $\binom{24}{12}$:</span>
<span id="cb17-562"><a href="#cb17-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-563"><a href="#cb17-563" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>With Base R function <span class="in">`choose(24, 12)`</span> = <span class="in">`r choose(24, 12)`</span>.</span>
<span id="cb17-564"><a href="#cb17-564" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>With my own function <span class="in">`my_choose(24, 12)`</span> = <span class="in">`r my_choose(24, 12)`</span>.</span>
<span id="cb17-565"><a href="#cb17-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-566"><a href="#cb17-566" aria-hidden="true" tabindex="-1"></a><span class="fu">### Compute density of the binomial distribution {#sec-example-4-3}</span></span>
<span id="cb17-567"><a href="#cb17-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-568"><a href="#cb17-568" aria-hidden="true" tabindex="-1"></a>To generalize I write my own function for the density of the binomial</span>
<span id="cb17-569"><a href="#cb17-569" aria-hidden="true" tabindex="-1"></a>distribution. I will use the same arguments names as in</span>
<span id="cb17-570"><a href="#cb17-570" aria-hidden="true" tabindex="-1"></a>@def-binom-dist-param.</span>
<span id="cb17-571"><a href="#cb17-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-574"><a href="#cb17-574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-575"><a href="#cb17-575" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: my-dbinom-func</span></span>
<span id="cb17-576"><a href="#cb17-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-my-dbinom-func lst-cap="**Function for the density of the binomial distribution**"'</span></span>
<span id="cb17-577"><a href="#cb17-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-578"><a href="#cb17-578" aria-hidden="true" tabindex="-1"></a>my_dbinom <span class="ot">&lt;-</span> <span class="cf">function</span>(k, n, p) {</span>
<span id="cb17-579"><a href="#cb17-579" aria-hidden="true" tabindex="-1"></a>    <span class="fu">choose</span>(n, k) <span class="sc">*</span> p<span class="sc">^</span>k <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p)<span class="sc">^</span>(n <span class="sc">-</span> k)</span>
<span id="cb17-580"><a href="#cb17-580" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-581"><a href="#cb17-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-582"><a href="#cb17-582" aria-hidden="true" tabindex="-1"></a><span class="fu">my_dbinom</span>(<span class="dv">12</span>, <span class="dv">24</span>, <span class="fl">0.5</span>)</span>
<span id="cb17-583"><a href="#cb17-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-584"><a href="#cb17-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-585"><a href="#cb17-585" aria-hidden="true" tabindex="-1"></a>Voilá: It gives the same result as the manual calculation in</span>
<span id="cb17-586"><a href="#cb17-586" aria-hidden="true" tabindex="-1"></a>@lst-calc-example.</span>
<span id="cb17-587"><a href="#cb17-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-588"><a href="#cb17-588" aria-hidden="true" tabindex="-1"></a>I wonder if there is not a Base R function which does the same as</span>
<span id="cb17-589"><a href="#cb17-589" aria-hidden="true" tabindex="-1"></a><span class="in">`my_dbinom()`</span>. I tried <span class="in">`stats::dbinom()`</span> and it worked!</span>
<span id="cb17-590"><a href="#cb17-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-593"><a href="#cb17-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-594"><a href="#cb17-594" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dbinom-func</span></span>
<span id="cb17-595"><a href="#cb17-595" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-dbinom-func lst-cap="**Base R dbinom() function calculates the density of the binomial distribution**"'</span></span>
<span id="cb17-596"><a href="#cb17-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-597"><a href="#cb17-597" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">12</span>, <span class="dv">24</span>, <span class="fl">0.5</span>)</span>
<span id="cb17-598"><a href="#cb17-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-599"><a href="#cb17-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-600"><a href="#cb17-600" aria-hidden="true" tabindex="-1"></a>Again the same result as in @lst-calc-example and @lst-my-dbinom-func!</span>
<span id="cb17-601"><a href="#cb17-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-602"><a href="#cb17-602" aria-hidden="true" tabindex="-1"></a><span class="fu">### Replication of the Binomial Distribution of 10 Coin Flips {#sec-10-coin-flips}</span></span>
<span id="cb17-603"><a href="#cb17-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-604"><a href="#cb17-604" aria-hidden="true" tabindex="-1"></a>Here I am going to try to replicate @fig-10-coin-flips.</span>
<span id="cb17-605"><a href="#cb17-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-608"><a href="#cb17-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-609"><a href="#cb17-609" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-repl-10-coin-flips</span></span>
<span id="cb17-610"><a href="#cb17-610" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Replication of Figure 4.1: Binomial Distribution of 10 Coin Flips with {ggplot2}"</span></span>
<span id="cb17-611"><a href="#cb17-611" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-repl-10-coin-flips lst-cap="**Replicate Figure 4.1: Binomial Distribution of 10 Coin Flips**"'</span></span>
<span id="cb17-612"><a href="#cb17-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-613"><a href="#cb17-613" aria-hidden="true" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">seq.int</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span> , <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb17-614"><a href="#cb17-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-615"><a href="#cb17-615" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> k_values, </span>
<span id="cb17-616"><a href="#cb17-616" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">dbinom</span>(k_values, <span class="dv">10</span>, <span class="fl">0.5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-617"><a href="#cb17-617" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb17-618"><a href="#cb17-618" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_col</span>()</span>
<span id="cb17-619"><a href="#cb17-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-620"><a href="#cb17-620" aria-hidden="true" tabindex="-1"></a>Writing @lst-repl-10-coin-flips I had troubles applying the correct geom. At first I used <span class="in">`geom_bar()`</span> but this did not work until I learned that I have to add the option "stat = identity" or to use <span class="in">`geom_col()`</span>. The difference is:</span>
<span id="cb17-621"><a href="#cb17-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-622"><a href="#cb17-622" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`geom_bar()`</span> makes the height of the bar proportional to the number of cases in each group. It uses <span class="in">`stat_count()`</span> by default, e.g. it counts the number of cases at each x position. If there aren't cases but only the values then one has to add "stat = identity" to declare that ggplot2 should take the data "as-is".  </span>
<span id="cb17-623"><a href="#cb17-623" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`geom_col()`</span> instead takes the heights of the bars to represent values in the data. It uses <span class="in">`stat_identity()`</span> and leaves the data "as-is" by default.</span>
<span id="cb17-624"><a href="#cb17-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-625"><a href="#cb17-625" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb17-626"><a href="#cb17-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-627"><a href="#cb17-627" aria-hidden="true" tabindex="-1"></a>During my research for writing @lst-repl-10-coin-flips I learned of the {**tidydice**} package. It simulates dice rolls and coin flips and can be used for teaching basic  experiments in introductory statistics courses.</span>
<span id="cb17-628"><a href="#cb17-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-629"><a href="#cb17-629" aria-hidden="true" tabindex="-1"></a>With {**tidydice**} we replicate Figure 4.1 with just 2 lines using the <span class="in">`binom_coin()`</span> inside the <span class="in">`plot_binom()`</span> function. In addition to the graphical distribution it print also the exact values on top of the bars. </span>
<span id="cb17-630"><a href="#cb17-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-631"><a href="#cb17-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-634"><a href="#cb17-634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-635"><a href="#cb17-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-repl-10-coin-flips-2</span></span>
<span id="cb17-636"><a href="#cb17-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Replication of Figure 4.1: Binomial Distribution of 10 Coin Flips with {tidydice}"</span></span>
<span id="cb17-637"><a href="#cb17-637" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-repl-10-coin-flips-2 lst-cap="**Replicate Figure 4.1: Binomial Distribution of 10 Coin Flips {tidydice}**"'</span></span>
<span id="cb17-638"><a href="#cb17-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-639"><a href="#cb17-639" aria-hidden="true" tabindex="-1"></a>tidydice<span class="sc">::</span><span class="fu">plot_binom</span>(</span>
<span id="cb17-640"><a href="#cb17-640" aria-hidden="true" tabindex="-1"></a>  tidydice<span class="sc">::</span><span class="fu">binom_coin</span>(<span class="at">times =</span> <span class="dv">10</span>, <span class="at">sides =</span> <span class="dv">2</span>, <span class="at">success =</span> <span class="dv">2</span>),</span>
<span id="cb17-641"><a href="#cb17-641" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Binomial distribution of 10 coin flips"</span></span>
<span id="cb17-642"><a href="#cb17-642" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-643"><a href="#cb17-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-644"><a href="#cb17-644" aria-hidden="true" tabindex="-1"></a>{**tidydice**} has many other functions related to coin and dice experiments.</span>
<span id="cb17-645"><a href="#cb17-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-646"><a href="#cb17-646" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-647"><a href="#cb17-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-648"><a href="#cb17-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-649"><a href="#cb17-649" aria-hidden="true" tabindex="-1"></a><span class="fu">### Replication of the Binomial Distribution of 10 Dice Rolls {#sec-example-4-4}</span></span>
<span id="cb17-650"><a href="#cb17-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-651"><a href="#cb17-651" aria-hidden="true" tabindex="-1"></a>I will replicate @fig-10-dice-rolls with {**ggplot2**} and with {**tidydice**}:</span>
<span id="cb17-652"><a href="#cb17-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-655"><a href="#cb17-655" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-656"><a href="#cb17-656" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-repl-10-dice-rolls</span></span>
<span id="cb17-657"><a href="#cb17-657" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Replication of Figure 4.2: Binomial Distribution of 10 Dice Rolls with {ggplot2}"</span></span>
<span id="cb17-658"><a href="#cb17-658" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-repl-10-cdice-rolls lst-cap="**Replicate Figure 4.2: Binomial Distribution of 10 Dice Rolls**"'</span></span>
<span id="cb17-659"><a href="#cb17-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-660"><a href="#cb17-660" aria-hidden="true" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">seq.int</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span> , <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb17-661"><a href="#cb17-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-662"><a href="#cb17-662" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> k_values, </span>
<span id="cb17-663"><a href="#cb17-663" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">dbinom</span>(k_values, <span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-664"><a href="#cb17-664" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb17-665"><a href="#cb17-665" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_col</span>()</span>
<span id="cb17-666"><a href="#cb17-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-667"><a href="#cb17-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-670"><a href="#cb17-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-671"><a href="#cb17-671" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-repl-10-dice-rolls-2</span></span>
<span id="cb17-672"><a href="#cb17-672" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Replication of Figure 4.2: Binomial Distribution of 10 Dice Rolls with {tidydice}"</span></span>
<span id="cb17-673"><a href="#cb17-673" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-repl-10-dice-rolls-2 lst-cap="**Replicate Figure 4.2: Binomial Distribution of 10 Dice Rolls {tidydice}**"'</span></span>
<span id="cb17-674"><a href="#cb17-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-675"><a href="#cb17-675" aria-hidden="true" tabindex="-1"></a>tidydice<span class="sc">::</span><span class="fu">plot_binom</span>(</span>
<span id="cb17-676"><a href="#cb17-676" aria-hidden="true" tabindex="-1"></a>  tidydice<span class="sc">::</span><span class="fu">binom_dice</span>(<span class="at">times =</span> <span class="dv">10</span>, <span class="at">sides =</span> <span class="dv">6</span>, <span class="at">success =</span> <span class="dv">6</span>),</span>
<span id="cb17-677"><a href="#cb17-677" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Binomial distribution of 10 dice rolls"</span></span>
<span id="cb17-678"><a href="#cb17-678" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-679"><a href="#cb17-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>