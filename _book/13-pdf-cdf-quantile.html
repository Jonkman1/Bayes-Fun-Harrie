<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Bayesian Statistics the Fun Way. Een notitieboek - 13&nbsp; Tools of Parameter Estimation: The PDF, CDF, and Quantile Function</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./14-prior-probabilities.html" rel="next">
<link href="./12-normal-distribution.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="quarto.css">
<link rel="stylesheet" href="glossary.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./13-pdf-cdf-quantile.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Tools of Parameter Estimation: The PDF, CDF, and Quantile Function</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bayesian Statistics the Fun Way. Een notitieboek</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">PART I: Introduction to Probability</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-everyday-reasoning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Bayesian Thinking and Everyday Reasoning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-measuring-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Measuring Uncertainty</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-logic-uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Logic of Uncertainty</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-binomial-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Creating a Binomial Probability Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-beta-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The Beta Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">PART II: Bayesian Probability and Prior Probabilities</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-conditional-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Conditional Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-bayes-lego.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Bayes’ Theorem With LEGO</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-prior-likelihood-posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Prior, Likelihood, and Posterior of Bayes’ Theorem</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-probability-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Bayesian Priors and Working with Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">PART III: Parameter Estimation</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-parameter-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction to Averaging and Parameter Estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-data-spread.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Measuring the Spread of our Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-normal-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">The Normal Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-pdf-cdf-quantile.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Tools of Parameter Estimation: The PDF, CDF, and Quantile Function</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-prior-probabilities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Parameter Estimation with Prior Probabilities</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">PART IV: Hypothesis Testing: The Heart of Statistics</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-bayesian-a-b-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">From Parameter Estimation to Hypothesis Testing: Building a Bayesian A/B Test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-bayes-factor-posterior-odds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Introduction to the Bayes Factor and Posterior Odds: The Competition of Ideas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-bayesian-reasoning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Bayesian Reasoning in the Twilight Zone</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-data-convince.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">When Data Doesn’t Convince</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-hypothesis-testing-parameter-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">From Hypothesis Testing to Parameter Estimation</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#estimating-the-conversion-rate-for-an-email-signup-list" id="toc-estimating-the-conversion-rate-for-an-email-signup-list" class="nav-link active" data-scroll-target="#estimating-the-conversion-rate-for-an-email-signup-list"><span class="header-section-number">13.1</span> Estimating the Conversion Rate for an Email Signup List</a></li>
  <li>
<a href="#the-probability-density-function" id="toc-the-probability-density-function" class="nav-link" data-scroll-target="#the-probability-density-function"><span class="header-section-number">13.2</span> The Probability Density Function</a>
  <ul>
<li><a href="#visualizing-and-interpreting-the-pdf" id="toc-visualizing-and-interpreting-the-pdf" class="nav-link" data-scroll-target="#visualizing-and-interpreting-the-pdf"><span class="header-section-number">13.2.1</span> Visualizing and Interpreting the PDF</a></li>
  <li><a href="#working-with-the-pdf-in-r" id="toc-working-with-the-pdf-in-r" class="nav-link" data-scroll-target="#working-with-the-pdf-in-r"><span class="header-section-number">13.2.2</span> Working with the PDF in R</a></li>
  </ul>
</li>
  <li>
<a href="#introducing-the-cumulative-distribution-function" id="toc-introducing-the-cumulative-distribution-function" class="nav-link" data-scroll-target="#introducing-the-cumulative-distribution-function"><span class="header-section-number">13.3</span> Introducing the Cumulative Distribution Function</a>
  <ul>
<li>
<a href="#visualizing-and-interpreting-the-cdf" id="toc-visualizing-and-interpreting-the-cdf" class="nav-link" data-scroll-target="#visualizing-and-interpreting-the-cdf"><span class="header-section-number">13.3.1</span> Visualizing and Interpreting the CDF</a>
  <ul>
<li><a href="#sec-finding-the-median" id="toc-sec-finding-the-median" class="nav-link" data-scroll-target="#sec-finding-the-median"><span class="header-section-number">13.3.1.1</span> Finding the median</a></li>
  <li><a href="#approximating-integrals-visually" id="toc-approximating-integrals-visually" class="nav-link" data-scroll-target="#approximating-integrals-visually"><span class="header-section-number">13.3.1.2</span> Approximating Integrals Visually</a></li>
  <li><a href="#estimating-confidence-intervals" id="toc-estimating-confidence-intervals" class="nav-link" data-scroll-target="#estimating-confidence-intervals"><span class="header-section-number">13.3.1.3</span> Estimating Confidence Intervals</a></li>
  </ul>
</li>
  <li><a href="#using-the-cdf-in-r" id="toc-using-the-cdf-in-r" class="nav-link" data-scroll-target="#using-the-cdf-in-r"><span class="header-section-number">13.3.2</span> Using the CDF in R</a></li>
  </ul>
</li>
  <li>
<a href="#the-quantile-function" id="toc-the-quantile-function" class="nav-link" data-scroll-target="#the-quantile-function"><span class="header-section-number">13.4</span> The Quantile Function</a>
  <ul>
<li><a href="#visualizing-and-understanding-the-quantile-function" id="toc-visualizing-and-understanding-the-quantile-function" class="nav-link" data-scroll-target="#visualizing-and-understanding-the-quantile-function"><span class="header-section-number">13.4.1</span> Visualizing and Understanding the Quantile Function</a></li>
  <li><a href="#calculating-quantiles-in-r" id="toc-calculating-quantiles-in-r" class="nav-link" data-scroll-target="#calculating-quantiles-in-r"><span class="header-section-number">13.4.2</span> Calculating Quantiles in R</a></li>
  </ul>
</li>
  <li><a href="#wrapping-up" id="toc-wrapping-up" class="nav-link" data-scroll-target="#wrapping-up"><span class="header-section-number">13.5</span> Wrapping Up</a></li>
  <li>
<a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">13.6</span> Exercises</a>
  <ul>
<li><a href="#exercise-13-1" id="toc-exercise-13-1" class="nav-link" data-scroll-target="#exercise-13-1"><span class="header-section-number">13.6.1</span> Exercise 13-1</a></li>
  <li><a href="#exercise-13-2" id="toc-exercise-13-2" class="nav-link" data-scroll-target="#exercise-13-2"><span class="header-section-number">13.6.2</span> Exercise 13-2</a></li>
  <li><a href="#exercise-13-3" id="toc-exercise-13-3" class="nav-link" data-scroll-target="#exercise-13-3"><span class="header-section-number">13.6.3</span> Exercise 13-3</a></li>
  </ul>
</li>
  <li>
<a href="#experiments" id="toc-experiments" class="nav-link" data-scroll-target="#experiments"><span class="header-section-number">13.7</span> Experiments</a>
  <ul>
<li>
<a href="#sec-replicate-fig-13-1" id="toc-sec-replicate-fig-13-1" class="nav-link" data-scroll-target="#sec-replicate-fig-13-1"><span class="header-section-number">13.7.1</span> Replicate Figure 13-1</a>
  <ul>
<li><a href="#wrong-dimension-of-x-axis-for-figure-13-1" id="toc-wrong-dimension-of-x-axis-for-figure-13-1" class="nav-link" data-scroll-target="#wrong-dimension-of-x-axis-for-figure-13-1"><span class="header-section-number">13.7.1.1</span> Wrong dimension of x-axis for Figure 13-1</a></li>
  <li><a href="#better-dimension-of-x-axis-but-still-not-identical-for-figure-13-1" id="toc-better-dimension-of-x-axis-but-still-not-identical-for-figure-13-1" class="nav-link" data-scroll-target="#better-dimension-of-x-axis-but-still-not-identical-for-figure-13-1"><span class="header-section-number">13.7.1.2</span> Better dimension of x-axis but still not identical for Figure 13-1</a></li>
  <li><a href="#optimal-dimension-of-x-axis-but-grid-too-wide-for-smooth-figure-13-1" id="toc-optimal-dimension-of-x-axis-but-grid-too-wide-for-smooth-figure-13-1" class="nav-link" data-scroll-target="#optimal-dimension-of-x-axis-but-grid-too-wide-for-smooth-figure-13-1"><span class="header-section-number">13.7.1.3</span> Optimal dimension of x-axis but grid too wide for smooth Figure 13-1</a></li>
  <li><a href="#optimal-replication-of-figure-13-1" id="toc-optimal-replication-of-figure-13-1" class="nav-link" data-scroll-target="#optimal-replication-of-figure-13-1"><span class="header-section-number">13.7.1.4</span> Optimal replication of Figure 13-1</a></li>
  </ul>
</li>
  <li>
<a href="#replicate-figure-13-2" id="toc-replicate-figure-13-2" class="nav-link" data-scroll-target="#replicate-figure-13-2"><span class="header-section-number">13.7.2</span> Replicate Figure 13-2</a>
  <ul>
<li><a href="#first-try-bad" id="toc-first-try-bad" class="nav-link" data-scroll-target="#first-try-bad"><span class="header-section-number">13.7.2.1</span> First try (bad)</a></li>
  <li><a href="#second-try-slightly-better" id="toc-second-try-slightly-better" class="nav-link" data-scroll-target="#second-try-slightly-better"><span class="header-section-number">13.7.2.2</span> Second try (Slightly better)</a></li>
  <li><a href="#third-try-my-best-version" id="toc-third-try-my-best-version" class="nav-link" data-scroll-target="#third-try-my-best-version"><span class="header-section-number">13.7.2.3</span> Third try (My best version)</a></li>
  </ul>
</li>
  <li><a href="#replicate-figure-13-3" id="toc-replicate-figure-13-3" class="nav-link" data-scroll-target="#replicate-figure-13-3"><span class="header-section-number">13.7.3</span> Replicate Figure 13-3</a></li>
  <li>
<a href="#replicate-figure-13-4" id="toc-replicate-figure-13-4" class="nav-link" data-scroll-target="#replicate-figure-13-4"><span class="header-section-number">13.7.4</span> Replicate Figure 13-4</a>
  <ul>
<li><a href="#cumulative-distribution-function-cdf" id="toc-cumulative-distribution-function-cdf" class="nav-link" data-scroll-target="#cumulative-distribution-function-cdf"><span class="header-section-number">13.7.4.1</span> Cumulative Distribution Function (CDF)</a></li>
  <li><a href="#empiricial-cumulative-distribution-function-ecdf---with-steps" id="toc-empiricial-cumulative-distribution-function-ecdf---with-steps" class="nav-link" data-scroll-target="#empiricial-cumulative-distribution-function-ecdf---with-steps"><span class="header-section-number">13.7.4.2</span> Empiricial Cumulative Distribution Function (ECDF) - with steps</a></li>
  <li><a href="#empiricial-cumulative-distribution-function-ecdf---with-points" id="toc-empiricial-cumulative-distribution-function-ecdf---with-points" class="nav-link" data-scroll-target="#empiricial-cumulative-distribution-function-ecdf---with-points"><span class="header-section-number">13.7.4.3</span> Empiricial Cumulative Distribution Function (ECDF) - with points</a></li>
  <li><a href="#empiricial-cumulative-distribution-function-ecdf---smooth" id="toc-empiricial-cumulative-distribution-function-ecdf---smooth" class="nav-link" data-scroll-target="#empiricial-cumulative-distribution-function-ecdf---smooth"><span class="header-section-number">13.7.4.4</span> Empiricial Cumulative Distribution Function (ECDF) - smooth</a></li>
  </ul>
</li>
  <li><a href="#sec-replicate-figure-13-5" id="toc-sec-replicate-figure-13-5" class="nav-link" data-scroll-target="#sec-replicate-figure-13-5"><span class="header-section-number">13.7.5</span> Replicate Figure 13-5</a></li>
  <li>
<a href="#sec-replicate-figure-13-6" id="toc-sec-replicate-figure-13-6" class="nav-link" data-scroll-target="#sec-replicate-figure-13-6"><span class="header-section-number">13.7.6</span> Replicate Figure 13-6</a>
  <ul>
<li><a href="#first-step" id="toc-first-step" class="nav-link" data-scroll-target="#first-step"><span class="header-section-number">13.7.6.1</span> First step</a></li>
  <li><a href="#second-step" id="toc-second-step" class="nav-link" data-scroll-target="#second-step"><span class="header-section-number">13.7.6.2</span> Second step</a></li>
  <li><a href="#third-step" id="toc-third-step" class="nav-link" data-scroll-target="#third-step"><span class="header-section-number">13.7.6.3</span> Third step</a></li>
  <li><a href="#fourth-step" id="toc-fourth-step" class="nav-link" data-scroll-target="#fourth-step"><span class="header-section-number">13.7.6.4</span> Fourth step</a></li>
  </ul>
</li>
  <li><a href="#replicate-figure-13-7" id="toc-replicate-figure-13-7" class="nav-link" data-scroll-target="#replicate-figure-13-7"><span class="header-section-number">13.7.7</span> Replicate Figure 13-7</a></li>
  <li><a href="#replicate-figure-13-8" id="toc-replicate-figure-13-8" class="nav-link" data-scroll-target="#replicate-figure-13-8"><span class="header-section-number">13.7.8</span> Replicate Figure 13-8</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-chap-13" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Tools of Parameter Estimation: The PDF, CDF, and Quantile Function</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><blockquote class="blockquote">
<p>This chapter will cover more on the <strong>probability density function (PDF)</strong> (GLOSSARY); introduce the <strong>cumulative distribution function”) (CDF)</strong>, which helps us more easily determine the probability of ranges of values; and introduce <strong>quantile, quantiles</strong> (GLOSSARY), which divide our probability distributions into parts with equal probabilities. For example, a <em>percentile</em> is a 100-quantile, meaning it divides the probability distribution into 100 equal pieces. (115)</p>
</blockquote>
<section id="estimating-the-conversion-rate-for-an-email-signup-list" class="level2" data-number="13.1"><h2 data-number="13.1" class="anchored" data-anchor-id="estimating-the-conversion-rate-for-an-email-signup-list">
<span class="header-section-number">13.1</span> Estimating the Conversion Rate for an Email Signup List</h2>
<blockquote class="blockquote">
<p>Say you run a blog and want to know the probability that a visitor to your blog will subscribe to your email list. In marketing terms, getting a user to perform a desired event is referred to as the <em>conversion event</em>, or simply a <em>conversion</em>, and the probability that a user will subscribe is the <em>conversion rate</em>.</p>
</blockquote>
<blockquote class="blockquote">
<p>As discussed in <a href="05-beta-distribution.html#sec-beta-distribution" class="quarto-xref"><span>Section 5.2</span></a>, we would use the beta distribution to estimate p, the probability of subscribing, when we know <code>k</code>, the number of people subscribed, and <code>n</code>, the total number of visitors. The two parameters needed for the beta distribution are <code>α</code>, which in this case represents the total subscribed (<code>k</code>), and <code>β</code>, representing the total not subscribed (<code>n – k</code>).</p>
</blockquote>
</section><section id="the-probability-density-function" class="level2" data-number="13.2"><h2 data-number="13.2" class="anchored" data-anchor-id="the-probability-density-function">
<span class="header-section-number">13.2</span> The Probability Density Function</h2>
<blockquote class="blockquote">
<p>let’s say for the first 40,000 visitors, you get 300 subscribers. The PDF for our problem is the beta distribution where α = 300 and β = 39,700.</p>
</blockquote>
<div id="thm-mean-beta" class="theorem">
<p><span class="theorem-title"><strong>Theorem 13.1 (Computing the mean of the beta distribution)</strong></span> <span id="eq-mean-beta"><span class="math display">\[
\begin{align*}
\mu_{Beta} = \frac{\alpha}{\alpha + \beta} \\
\mu_{Beta} = \frac{300}{300 + 39,700} = 0.0075
\end{align*}
\tag{13.1}\]</span></span></p>
<p>The blog’s average conversion rate is simply <span class="math inline">\(\frac{subscribed}{visited}\)</span>.</p>
</div>
<section id="visualizing-and-interpreting-the-pdf" class="level3" data-number="13.2.1"><h3 data-number="13.2.1" class="anchored" data-anchor-id="visualizing-and-interpreting-the-pdf">
<span class="header-section-number">13.2.1</span> Visualizing and Interpreting the PDF</h3>
<div id="fig-13-01" class="quarto-figure quarto-figure-center quarto-float anchored" alt="The beta PDF as almost a normal distribution with mode = mean at .0075" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-13-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.1: Visualizing the beta PDF for our beliefs in the true conversion rate
</figcaption><div aria-describedby="fig-13-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/13fig01.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="The beta PDF as almost a normal distribution with mode = mean at .0075">
</div>
</figure>
</div>
<blockquote class="blockquote">
<p>Given that we have uncertainty in our measurement, and we have a mean, it could be useful to investigate how much more likely it is that the true conversion rate is 0.001 higher or lower than the mean of 0.0075 we observed.</p>
</blockquote>
<div class="cell">
<div id="lst-integrate-higher-lower" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-integrate-higher-lower-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.1: How much more likely it is that the true conversion rate is 0.001 higher or lower
</figcaption><div aria-describedby="lst-integrate-higher-lower-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-integrate-higher-lower"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0.0065</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.007978686 with absolute error &lt; 3.8e-07</code></pre>
</div>
<div id="lst-integrate-higher-lower" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-integrate-higher-lower-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.2: How much more likely it is that the true conversion rate is 0.001 higher or lower
</figcaption><div aria-describedby="lst-integrate-higher-lower-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-integrate-higher-lower"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="fl">0.0085</span>, <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.01248151 with absolute error &lt; 9.4e-09</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>if we had to make a decision with the limited data we have, we could still calculate how much likelier one extreme is than the other:</p>
</blockquote>
<div class="cell">
<div id="lst-integrate-extremes" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-integrate-extremes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.3: How much likelier is one extreme than the other
</figcaption><div aria-describedby="lst-integrate-extremes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-integrate-extremes"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="fl">0.0085</span>, <span class="fl">1</span><span class="op">)</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0.0065</span><span class="op">)</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.564357</code></pre>
</div>
</div>
<p>It’s 56 percent more likely that our true conversion rate is greater than 0.0085 than that it’s lower than 0.0065.</p>
</section><section id="working-with-the-pdf-in-r" class="level3" data-number="13.2.2"><h3 data-number="13.2.2" class="anchored" data-anchor-id="working-with-the-pdf-in-r">
<span class="header-section-number">13.2.2</span> Working with the PDF in R</h3>
<p>I am going to use my own code in <a href="#sec-replicate-fig-13-1" class="quarto-xref"><span>Section 13.7.1</span></a>. But to see what it looks like I use the R base code lines from the book:</p>
<div class="cell">
<div id="lst-draw-pdf-with-base-r" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-draw-pdf-with-base-r-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.4: Working with the PDF in base R
</figcaption><div aria-describedby="lst-draw-pdf-with-base-r-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-draw-pdf-with-base-r"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, by <span class="op">=</span> <span class="fl">0.00001</span><span class="op">)</span></span>
<span><span class="va">xs.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.0001</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span></span>
<span>    <span class="va">xs</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">xs</span>, <span class="fl">300</span>, <span class="fl">40000</span> <span class="op">-</span> <span class="fl">300</span><span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'l'</span>,</span>
<span>    lwd <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"probability of subscription"</span>,</span>
<span>    main <span class="op">=</span> <span class="st">"PDF Beta(300,39700)"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="13-pdf-cdf-quantile_files/figure-html/draw-pdf-with-base-r-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="introducing-the-cumulative-distribution-function" class="level2" data-number="13.3"><h2 data-number="13.3" class="anchored" data-anchor-id="introducing-the-cumulative-distribution-function">
<span class="header-section-number">13.3</span> Introducing the Cumulative Distribution Function</h2>
<blockquote class="blockquote">
<p>we can save ourselves a lot of effort with the cumulative distribution function (CDF), which sums all parts of our distribution, replacing a lot of calculus work. … The CDF takes in a value and returns the probability of getting that value or lower.</p>
</blockquote>
<blockquote class="blockquote">
<p>The CDF gets this probability by taking the cumulative area under the curve for the PDF (for those comfortable with calculus, the CDF is the <em>anti-derivative</em> of the PDF). We can summarize this process in two steps: (1) figure out the cumulative area under the curve for each value of the PDF, and (2) plot those values. That’s our CDF.</p>
</blockquote>
<div id="fig-13-02" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Visualizing the cumulative area under the curve of the beta distribution in steps to 0.0005" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-13-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.2: Visualizing the cumulative area under the curve
</figcaption><div aria-describedby="fig-13-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/13fig02.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Visualizing the cumulative area under the curve of the beta distribution in steps to 0.0005">
</div>
</figure>
</div>
<p><a href="#fig-13-02" class="quarto-xref">Figure&nbsp;<span>13.2</span></a> shows the cumulative area under the curve for the PDF of Beta(300,39700). As you can see, our cumulative area under the curve takes into account all of the area in the pieces to its left.</p>
<p>Using this approach, as we move along the PDF, we take into account an increasingly higher probability until our total area is 1, or complete certainty. To turn this into the CDF, we can imagine a function that looks at only these areas under the curve.</p>
<p><a href="#fig-13-03" class="quarto-xref">Figure&nbsp;<span>13.3</span></a> shows what happens if we plot the area under the curve for each of our points, which are 0.0005 apart.</p>
<div id="fig-13-03" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Plotting the area under the curve for each of our points, which are 0.0005 apart results in an S curve" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-13-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.3: Plotting just the cumulative probability from <a href="#fig-13-02" class="quarto-xref">Figure&nbsp;<span>13.2</span></a>
</figcaption><div aria-describedby="fig-13-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/13fig03.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Plotting the area under the curve for each of our points, which are 0.0005 apart results in an S curve">
</div>
</figure>
</div>
<blockquote class="blockquote">
<p>Now we have a way of visualizing just how the cumulative area under the curve changes as we move along the values for our PDF. Of course, the problem is that we’re using these discrete chunks. In reality, the CDF just uses infinitely small pieces of the PDF, so we get a nice smooth line as seen in <a href="#fig-13-04" class="quarto-xref">Figure&nbsp;<span>13.4</span></a>.</p>
</blockquote>
<div id="fig-13-04" class="quarto-figure quarto-figure-center quarto-float anchored" alt="The CDF for our problem of conversion to blog subscriber" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-13-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.4: The CDF for our problem
</figcaption><div aria-describedby="fig-13-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/13fig04.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="The CDF for our problem of conversion to blog subscriber">
</div>
</figure>
</div>
<section id="visualizing-and-interpreting-the-cdf" class="level3" data-number="13.3.1"><h3 data-number="13.3.1" class="anchored" data-anchor-id="visualizing-and-interpreting-the-cdf">
<span class="header-section-number">13.3.1</span> Visualizing and Interpreting the CDF</h3>
<blockquote class="blockquote">
<p>The PDF is most useful visually for quickly estimating where the peak of a distribution is, and for getting a rough sense of the width (variance) and shape of a distribution. However, with the PDF it is very difficult to reason about the probability of various ranges visually. The CDF is a much better tool for this.</p>
</blockquote>
<section id="sec-finding-the-median" class="level4" data-number="13.3.1.1"><h4 data-number="13.3.1.1" class="anchored" data-anchor-id="sec-finding-the-median">
<span class="header-section-number">13.3.1.1</span> Finding the median</h4>
<blockquote class="blockquote">
<p>Unlike the mean, computing the median can actually be pretty tricky. For small, discrete cases, it’s as simple as putting your observations in order and selecting the value in the middle. But for continuous distributions like our beta distribution, it’s a little more complicated.</p>
</blockquote>
<blockquote class="blockquote">
<p>Thankfully, we can easily spot the median on a visualization of the CDF. We can simply draw a line from the point where the cumulative probability is 0.5, meaning 50 percent of the values are below this point and 50 percent are above.</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are many packages about the beta functions out there that provides functions for parameter calculation: For instance <code>betamedian()</code> of <a href="https://search.r-project.org/CRAN/refmans/betafunctions/html/betamedian.html">{<strong>betafunctions</strong>}</a>. But in a <a href="https://stackoverflow.com/questions/59077866/is-there-a-way-to-find-the-median-using-beta-distribution-parameters-in-r">StackOverflow post</a> is the suggestion simple to use <code><a href="https://rdrr.io/r/stats/Beta.html">qbeta()</a></code> with <code>p = 0.5</code>.</p>
<p>This is what I have done in replicating <a href="#fig-13-05" class="quarto-xref">Figure&nbsp;<span>13.5</span></a> with my <a href="#fig-pb-13-5" class="quarto-xref">Figure&nbsp;<span>13.17</span></a>.</p>
</div>
</div>
<div id="fig-13-05" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Estimating the median visually using the CDF" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-13-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.5: Estimating the median visually using the CDF
</figcaption><div aria-describedby="fig-13-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/13fig05.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Estimating the median visually using the CDF">
</div>
</figure>
</div>
</section><section id="approximating-integrals-visually" class="level4" data-number="13.3.1.2"><h4 data-number="13.3.1.2" class="anchored" data-anchor-id="approximating-integrals-visually">
<span class="header-section-number">13.3.1.2</span> Approximating Integrals Visually</h4>
<blockquote class="blockquote">
<p>When working with ranges of probabilities, we’ll often want to know the probability that the true value lies somewhere between some value y and some value x.</p>
</blockquote>
<p>Time-consuming computation the integration with R is not necessary as we can eyeball whether or not a certain range of values has a very high probability or a very low probability of occurring.</p>
<div id="fig-13-06" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Visually performing integration using the CDF" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-13-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.6: Visually performing integration using the CDF
</figcaption><div aria-describedby="fig-13-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/13fig06.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Visually performing integration using the CDF">
</div>
</figure>
</div>
</section><section id="estimating-confidence-intervals" class="level4" data-number="13.3.1.3"><h4 data-number="13.3.1.3" class="anchored" data-anchor-id="estimating-confidence-intervals">
<span class="header-section-number">13.3.1.3</span> Estimating Confidence Intervals</h4>
<blockquote class="blockquote">
<p>Looking at the probability of ranges of values leads us to a very important concept in probability: the confidence interval. A confidence interval is a lower and upper bound of values, typically centered on the mean, describing a range of high probability, usually 95, 99, or 99.9 percent. When we say something like “The 95 percent confidence interval is from 12 to 20,” what we mean is that there is a 95 percent probability that our true measurement is somewhere between 12 and 20. Confidence intervals provide a good method of describing the range of possibilities when we’re dealing with uncertain information.</p>
</blockquote>
<p>In spite of a special note “<em>In Bayesian statistics what we are calling a ”confidence interval” can go by a few other names, such as ”critical region” or ”critical interval.” In some more traditional schools of statistics, ”confidence interval” has a slightly different meaning, which is beyond the scope of this book.</em>” this concept and notions are not correct for Bayesian statistics. At least what I have learned reading other books, especially <span class="citation" data-cites="mcelreath2020">(<a href="#ref-mcelreath2020" role="doc-biblioref"><strong>mcelreath2020?</strong></a>)</span>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Bayesian statistics</strong> (GLOSSARY) talks about <strong>credible interval, credible intervals</strong> (GLOSSARY) that have a very different meaning as the <strong>confidence interval, confidence intervals</strong> (GLOSSARY) of <strong>frequentist statistics</strong> (GLOSSARY). McElreath even proposes the notion of <strong>compatibility interval, compatibility intervals</strong> (GLOSSARY).</p>
</div>
</div>
<blockquote class="blockquote">
<p>Say we wanted to know the range that covers 80 percent of the possible values for the true conversion rate. We solve this problem by combining our previous approaches: we draw lines at the y-axis from 0.1 and 0.9 to cover 80 percent, and then simply see where on the x-axis these intersect with our CDF:</p>
</blockquote>
<div id="fig-13-07" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Estimating our confidence intervals visually using the CDF" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-13-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.7: Estimating our confidence intervals visually using the CDF
</figcaption><div aria-describedby="fig-13-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/13fig07.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Estimating our confidence intervals visually using the CDF">
</div>
</figure>
</div>
</section></section><section id="using-the-cdf-in-r" class="level3" data-number="13.3.2"><h3 data-number="13.3.2" class="anchored" data-anchor-id="using-the-cdf-in-r">
<span class="header-section-number">13.3.2</span> Using the CDF in R</h3>
<blockquote class="blockquote">
<p>Just as nearly all major PDFs have a function starting with <span class="math inline">\(d\)</span>, like <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code>, CDF functions start with <span class="math inline">\(p\)</span>, such as <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>.</p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is a new information for me. Now I understand better the differences and use cases of the different types of distribution. My comprehension will be fostered with the next section when the application of function starting with <span class="math inline">\(q\)</span> is explained.</p>
</div>
</div>
<div class="cell">
<div id="lst-calc-beta-less-0.0065" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-calc-beta-less-0.0065-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.5: Calculate the probability that Beta(300,39700) is less than 0.0065
</figcaption><div aria-describedby="lst-calc-beta-less-0.0065-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-calc-beta-less-0.0065"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">pbeta</a></span><span class="op">(</span><span class="fl">0.0065</span>,<span class="fl">300</span>,<span class="fl">39700</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007978686</code></pre>
</div>
</div>
<div class="cell">
<div id="lst-calc-beta-greater-0.0085" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-calc-beta-greater-0.0085-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.6: Calculate the true probability that the conversion rate is greater than 0.0085
</figcaption><div aria-describedby="lst-calc-beta-greater-0.0085-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-calc-beta-greater-0.0085"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">pbeta</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">300</span>,<span class="fl">39700</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">pbeta</a></span><span class="op">(</span><span class="fl">0.0085</span>,<span class="fl">300</span>,<span class="fl">39700</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01248151</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>The great thing about CDFs is that it doesn’t matter if your distribution is discrete or continuous. If we wanted to determine the probability of getting three or fewer heads in five coin tosses, for example, we would use the CDF for the binomial distribution like this:</p>
</blockquote>
<div class="cell">
<div id="lst-calc-beta-3-or-fewer-heads-5-tosses" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-calc-beta-3-or-fewer-heads-5-tosses-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.7: Calculate the probability of getting three or fewer heads in five coin tosses
</figcaption><div aria-describedby="lst-calc-beta-3-or-fewer-heads-5-tosses-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-calc-beta-3-or-fewer-heads-5-tosses"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">0.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8125</code></pre>
</div>
</div>
</section></section><section id="the-quantile-function" class="level2" data-number="13.4"><h2 data-number="13.4" class="anchored" data-anchor-id="the-quantile-function">
<span class="header-section-number">13.4</span> The Quantile Function</h2>
<blockquote class="blockquote">
<p>Mathematically, the CDF is like any other function in that it takes an <span class="math inline">\(x\)</span> value, often representing the value we’re trying to estimate, and gives us a <span class="math inline">\(y\)</span> value, which represents the cumulative probability. But there is no obvious way to do this in reverse; that is, we can’t give the same function a <span class="math inline">\(y\)</span> to get an <span class="math inline">\(x\)</span>.</p>
</blockquote>
<p>But we did reversing the function when we estimated the median in <a href="#sec-finding-the-median" class="quarto-xref"><span>Section 13.3.1.1</span></a> respectively in my version in <a href="#sec-replicate-figure-13-5" class="quarto-xref"><span>Section 13.7.5</span></a>.</p>
<blockquote class="blockquote">
<p>The inverse of the CDF is an incredibly common and useful tool called the quantile function. To compute an exact value for our median and confidence interval, we need to use the quantile function for the beta distribution.</p>
</blockquote>
<section id="visualizing-and-understanding-the-quantile-function" class="level3" data-number="13.4.1"><h3 data-number="13.4.1" class="anchored" data-anchor-id="visualizing-and-understanding-the-quantile-function">
<span class="header-section-number">13.4.1</span> Visualizing and Understanding the Quantile Function</h3>
<blockquote class="blockquote">
<p>Because the quantile function is simply the inverse of the CDF, it just looks like the CDF rotated 90 degrees, as shown in <a href="#fig-13-08" class="quarto-xref">Figure&nbsp;<span>13.8</span></a>.</p>
</blockquote>
<div id="fig-13-08" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Visually, the quantile function is just a rotation of the CDF" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-13-08-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.8: Visually, the quantile function is just a rotation of the CDF
</figcaption><div aria-describedby="fig-13-08-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/13fig08.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Visually, the quantile function is just a rotation of the CDF">
</div>
</figure>
</div>
<blockquote class="blockquote">
<p>Whenever you hear phrases like:</p>
<ul>
<li>“The top 10 percent of students …”</li>
<li>“The bottom 20 percent of earners earn less than …”</li>
<li>“The top quartile has notably better performance than …”</li>
</ul>
<p>you’re talking about values that are found using the quantile function</p>
</blockquote>
</section><section id="calculating-quantiles-in-r" class="level3" data-number="13.4.2"><h3 data-number="13.4.2" class="anchored" data-anchor-id="calculating-quantiles-in-r">
<span class="header-section-number">13.4.2</span> Calculating Quantiles in R</h3>
<p>We are using the function <code><a href="https://rdrr.io/r/stats/Normal.html">qnorm()</a></code> for calculating <strong>quantile, quantiles</strong> (GLOSSARY).</p>
<blockquote class="blockquote">
<p>For example, if we want to know the value that 99.9 percent of the distribution is less than, we can use qbeta() with the quantile we’re interested in calculating as the first argument, and the alpha and beta parameters of our beta distribution as the second and third arguments, like so:</p>
</blockquote>
<div class="cell">
<div id="lst-qbeta-less-99.9" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-qbeta-less-99.9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.8: Value that we 99.9 percent certain that the true conversion rate for our emails is less than 0.0089
</figcaption><div aria-describedby="lst-qbeta-less-99.9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-qbeta-less-99.9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">qbeta</a></span><span class="op">(</span><span class="fl">0.999</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.008903462</code></pre>
</div>
</div>
<p>The result is 0.0089, meaning we can be 99.9 percent certain that the true conversion rate for our emails is less than 0.0089.</p>
<p>With the quantile function we can also calculate the 95% confidence interval by finding the lower and upper 2.5% quantile:</p>
<div class="cell">
<div id="lst-get-95-conf-int" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-get-95-conf-int-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.9: Calculate the 95% confidence interval
</figcaption><div aria-describedby="lst-get-95-conf-int-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-get-95-conf-int"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"The lower bound is {round(qbeta(0.025,300,39700), 7)} and the upper bound is {round(qbeta(0.975,300,39700) ,7)}."</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>The lower bound is 0.0066781 and the upper bound is 0.0083686.</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Now we can confidently say that we are 95 percent certain that the real conversion rate for blog visitors is somewhere between 0.67 percent and 0.84 percent. … Suppose an article on your blog goes viral and gets 100,000 visitors. Based on our calculations, we know that we should expect between 670 and 840 new email subscribers.</p>
</blockquote>
</section></section><section id="wrapping-up" class="level2" data-number="13.5"><h2 data-number="13.5" class="anchored" data-anchor-id="wrapping-up">
<span class="header-section-number">13.5</span> Wrapping Up</h2>
</section><section id="exercises" class="level2" data-number="13.6"><h2 data-number="13.6" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">13.6</span> Exercises</h2>
<p>Try answering the following questions to see how well you understand the tools of parameter estimation. The solutions can be found at https://nostarch.com/learnbayes/.</p>
<section id="exercise-13-1" class="level3" data-number="13.6.1"><h3 data-number="13.6.1" class="anchored" data-anchor-id="exercise-13-1">
<span class="header-section-number">13.6.1</span> Exercise 13-1</h3>
<p>Using the code example for plotting the PDF on page 127, plot the CDF and quantile functions.</p>
<ul>
<li>For the CDF see <a href="#lst-fig-pb-13-4a" class="quarto-xref">Listing&nbsp;<span>13.18</span></a> and <a href="#fig-pb-13-4a" class="quarto-xref">Figure&nbsp;<span>13.13</span></a>.</li>
<li>For the quantile function see <a href="#lst-fig-pb-13-8" class="quarto-xref">Listing&nbsp;<span>13.28</span></a> and <a href="#fig-pb-13-8" class="quarto-xref">Figure&nbsp;<span>13.23</span></a>.</li>
</ul></section><section id="exercise-13-2" class="level3" data-number="13.6.2"><h3 data-number="13.6.2" class="anchored" data-anchor-id="exercise-13-2">
<span class="header-section-number">13.6.2</span> Exercise 13-2</h3>
<p>Returning to the task of measuring snowfall from <a href="10-parameter-estimation.html" class="quarto-xref"><span>Chapter 10</span></a>, say you have the following measurements (in inches) of snowfall: 7.8, 9.4, 10.0, 7.9, 9.4, 7.0, 7.0, 7.1, 8.9, 7.4</p>
<p>What is your 99.9 percent confidence interval for the true value of snowfall?</p>
<div class="cell">
<div id="lst-exr-13-2" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-exr-13-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.10: Calculate the 99% confidence interval
</figcaption><div aria-describedby="lst-exr-13-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-exr-13-2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7.8</span>, <span class="fl">9.4</span>, <span class="fl">10.0</span>, <span class="fl">7.9</span>, <span class="fl">9.4</span>, <span class="fl">7.0</span>, <span class="fl">7.0</span>, <span class="fl">7.1</span>, <span class="fl">8.9</span>, <span class="fl">7.4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"The lower bound is {round(qnorm(0.0005,mean(x), sd(x)), 2)} and the upper bound is {round(qnorm(0.9995,mean(x), sd(x)), 2)}."</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>The lower bound is 4.46 and the upper bound is 11.92.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Besides that in my try I used the <code>sd_fun()</code> function from <a href="12-normal-distribution.html#lst-comp-sigma-with-own-function" class="quarto-xref">Listing&nbsp;<span>12.3</span></a>, I commit an error in using bounds of 0.001 and 0.999 instead of 0.0005 and 0.9995.</p>
</div>
</div>
</section><section id="exercise-13-3" class="level3" data-number="13.6.3"><h3 data-number="13.6.3" class="anchored" data-anchor-id="exercise-13-3">
<span class="header-section-number">13.6.3</span> Exercise 13-3</h3>
<p>A child is going door to door selling candy bars. So far she has visited 30 houses and sold 10 candy bars. She will visit 40 more houses today. What is the 95 percent confidence interval for how many candy bars she will sell the rest of the day?</p>
<div class="cell">
<div id="lst-exr-13-3" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-exr-13-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.11: Calculate the 95 percent confidence interval for how many candy bars will be sold
</figcaption><div aria-describedby="lst-exr-13-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-exr-13-3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"The lower bound is {round(qbeta(0.025, 10, 20), 2)}% and the upper bound is {round(qbeta(0.975, 10, 20), 2)}%."</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>The lower bound is 0.18% and the upper bound is 0.51%.</code></pre>
</div>
<div id="lst-exr-13-3" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-exr-13-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.12: Calculate the 95 percent confidence interval for how many candy bars will be sold
</figcaption><div aria-describedby="lst-exr-13-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-exr-13-3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"This means that she will with 95% probability get between 40 * 0.18 = {40 * 0.18} and 40 * 0.51 = {40 * 0.51} candy bars."</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>This means that she will with 95% probability get between 40 * 0.18 = 7.2 and 40 * 0.51 = 20.4 candy bars.</code></pre>
</div>
<div id="lst-exr-13-3" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-exr-13-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.13: Calculate the 95 percent confidence interval for how many candy bars will be sold
</figcaption><div aria-describedby="lst-exr-13-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-exr-13-3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"But she can only sell complete bars: Therefore she will sell between {floor(40 * 0.18)} and {floor(40 * 0.51)} candy bars."</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>But she can only sell complete bars: Therefore she will sell between 7 and 20 candy bars.</code></pre>
</div>
</div>
</section></section><section id="experiments" class="level2" data-number="13.7"><h2 data-number="13.7" class="anchored" data-anchor-id="experiments">
<span class="header-section-number">13.7</span> Experiments</h2>
<p>I started with <a href="#fig-pb-13-4a" class="quarto-xref">Figure&nbsp;<span>13.13</span></a> because this is the easiest graph, as it replicates <a href="#fig-13-04" class="quarto-xref">Figure&nbsp;<span>13.4</span></a> with just the CDF and nothing else. So maybe you will begin also with this basic plot. After <a href="#fig-pb-13-4a" class="quarto-xref">Figure&nbsp;<span>13.13</span></a> the natural sequence – ordered by complexity – is <a href="#fig-pb-13-3" class="quarto-xref">Figure&nbsp;<span>13.12</span></a>. After that you can inspect in detail my different tries with <a href="#fig-13-02" class="quarto-xref">Figure&nbsp;<span>13.2</span></a> (<a href="#fig-pb-13-2a" class="quarto-xref">Figure&nbsp;<span>13.9</span></a>, <a href="#fig-pb-13-2b" class="quarto-xref">Figure&nbsp;<span>13.10</span></a> and my best solution <a href="#fig-pb-13-2c" class="quarto-xref">Figure&nbsp;<span>13.11</span></a>) . Then follow my sequences here from <a href="#fig-13-05" class="quarto-xref">Figure&nbsp;<span>13.5</span></a> to <a href="#fig-13-08" class="quarto-xref">Figure&nbsp;<span>13.8</span></a>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>There is the following system in using distributions with R, exemplified with the normal distribution:</p>
<ul>
<li>
<code>dnorm</code> for plotting probability densities functions (PDFs).</li>
<li>
<code>pnorm</code> for plotting cumulative distribution functions (CDFs).</li>
<li>
<code>qnorm</code> for plotting quantile functions, it is the reverse of CDFs.</li>
<li>
<code>rnorm</code> for generating and plotting random distributions.</li>
</ul>
<p>See</p>
<ol type="1">
<li>R help file for <a href="https://rdrr.io/r/stats/Distributions.html">Distributions in the stats package</a>.</li>
<li>
<a href="https://ben18785.shinyapps.io/distribution-zoo/">The distribution zoo</a> (a shiny application by <a href="https://ben-lambert.com/bayesian/">Ben Lambert</a> &amp; <a href="https://www.cs.ox.ac.uk/people/fergus.cooper/site/">Fergus Cooper</a>). See for the code the <a href="https://github.com/ben18785/distribution-zoo">GitHub repo</a>.</li>
</ol>
</div>
</div>
<section id="sec-replicate-fig-13-1" class="level3" data-number="13.7.1"><h3 data-number="13.7.1" class="anchored" data-anchor-id="sec-replicate-fig-13-1">
<span class="header-section-number">13.7.1</span> Replicate Figure 13-1</h3>
<section id="wrong-dimension-of-x-axis-for-figure-13-1" class="level4" data-number="13.7.1.1"><h4 data-number="13.7.1.1" class="anchored" data-anchor-id="wrong-dimension-of-x-axis-for-figure-13-1">
<span class="header-section-number">13.7.1.1</span> Wrong dimension of x-axis for Figure 13-1</h4>
<p>At first I got the following graph:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">.0001</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="13-pdf-cdf-quantile_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The problem here is that the interesting part of the PDF is very small as we know from the <span class="math inline">\(\frac{300}{40000} = 0.0075\)</span>. Therefore it does not make sense to spread the grid from 0 to 1. We get a much better visualization in the area 0 to 001:</p>
</section><section id="better-dimension-of-x-axis-but-still-not-identical-for-figure-13-1" class="level4" data-number="13.7.1.2"><h4 data-number="13.7.1.2" class="anchored" data-anchor-id="better-dimension-of-x-axis-but-still-not-identical-for-figure-13-1">
<span class="header-section-number">13.7.1.2</span> Better dimension of x-axis but still not identical for Figure 13-1</h4>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span>, <span class="fl">.0001</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="13-pdf-cdf-quantile_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>But even this curve is not optimal. Now let’s try the interval [0.005, 0.01]:</p>
</section><section id="optimal-dimension-of-x-axis-but-grid-too-wide-for-smooth-figure-13-1" class="level4" data-number="13.7.1.3"><h4 data-number="13.7.1.3" class="anchored" data-anchor-id="optimal-dimension-of-x-axis-but-grid-too-wide-for-smooth-figure-13-1">
<span class="header-section-number">13.7.1.3</span> Optimal dimension of x-axis but grid too wide for smooth Figure 13-1</h4>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">.0001</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="13-pdf-cdf-quantile_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It turns out that this is the interval also used in the book example. But in my visualization you can see some irregularity at the top, because my grid has too coarse. It has only 51 values. Let’s try a much finer grid with 5001 values:</p>
</section><section id="optimal-replication-of-figure-13-1" class="level4" data-number="13.7.1.4"><h4 data-number="13.7.1.4" class="anchored" data-anchor-id="optimal-replication-of-figure-13-1">
<span class="header-section-number">13.7.1.4</span> Optimal replication of Figure 13-1</h4>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">.00001</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="13-pdf-cdf-quantile_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="replicate-figure-13-2" class="level3" data-number="13.7.2"><h3 data-number="13.7.2" class="anchored" data-anchor-id="replicate-figure-13-2">
<span class="header-section-number">13.7.2</span> Replicate Figure 13-2</h3>
<section id="first-try-bad" class="level4" data-number="13.7.2.1"><h4 data-number="13.7.2.1" class="anchored" data-anchor-id="first-try-bad">
<span class="header-section-number">13.7.2.1</span> First try (bad)</h4>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>I had to learn about the difference between <code>annotate(geom = "text" …)</code> and <code>annotate(geom = "label" …)</code>. There are two big differences:</p>
<ul>
<li>
<code>geom_text()</code> does not understand the <code>fill</code> aesthetics, e.g.&nbsp;you can’t change the background color of the text.</li>
<li>
<code>geom_label()</code> “is considerable slower than geom_text()” and does not support the <code>check_overlap</code> argument and the <code>angle</code> aesthetic. But more important for my use case <code>geom_label()</code> draws a rectangle around the label. You need to add <code>label.size = NA</code> to remove the label. Although the option <code>label.size</code> is documented (“Size of label border, in mm.”) using <code>NA</code> to remove the border completely is not explained. I had to find out it the hard way via <a href="https://stackoverflow.com/a/58242703/7322615">StackOverflow</a>.</li>
</ul>
</div>
</div>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-2a" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-2a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.14: Highlighting the cumulative area under the curve
</figcaption><div aria-describedby="lst-fig-pb-13-2a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-2a"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x_lower</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.006</span>, <span class="fl">0.0085</span>, <span class="fl">0.0005</span><span class="op">)</span></span>
<span><span class="va">x_upper</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.0065</span>, <span class="fl">0.009</span>, <span class="fl">0.0005</span><span class="op">)</span></span>
<span><span class="va">text_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.00625</span>, <span class="fl">0.00875</span>, <span class="fl">0.0005</span><span class="op">)</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray90"</span>, <span class="st">"gray80"</span>, <span class="st">"gray70"</span>, <span class="st">"gray50"</span>, <span class="st">"gray40"</span>, <span class="st">"black"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">df_13_2</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.006</span>, <span class="fl">0.009</span>, length.out <span class="op">=</span> <span class="fl">6000</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_2</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_13_2</span> <span class="op">|&gt;</span></span>
<span>                           <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">x_lower</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span>  <span class="va">x_upper</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                           fill <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>                           <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="va">text_pos</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                          size <span class="op">=</span> <span class="fl">5</span>, y <span class="op">=</span> <span class="fl">125</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span>, label.size <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                          label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="va">x_lower</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x_upper</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    </span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_13_2</span> <span class="op">|&gt;</span> </span>
<span>                           <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">x_lower</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span>  <span class="va">x_upper</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                           fill <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>                           <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="va">text_pos</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">5</span>, y <span class="op">=</span> <span class="fl">125</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span>, label.size <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>            label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="va">x_lower</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x_upper</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_13_2</span> <span class="op">|&gt;</span> </span>
<span>                           <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">x_lower</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span>  <span class="va">x_upper</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                           fill <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>                           <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="va">text_pos</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">5</span>, y <span class="op">=</span> <span class="fl">125</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span>, label.size <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>            label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="va">x_lower</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x_upper</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_13_2</span> <span class="op">|&gt;</span> </span>
<span>                           <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">x_lower</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span>  <span class="va">x_upper</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                           fill <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span>                           <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="va">text_pos</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">5</span>, y <span class="op">=</span> <span class="fl">125</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span>, label.size <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>            label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="va">x_lower</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x_upper</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_13_2</span> <span class="op">|&gt;</span> </span>
<span>                           <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">x_lower</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span>  <span class="va">x_upper</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                           fill <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span></span>
<span>                           <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"label"</span>, x <span class="op">=</span> <span class="va">text_pos</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">5</span>, y <span class="op">=</span> <span class="fl">125</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span>, label.size <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>            label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="va">x_lower</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x_upper</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_13_2</span> <span class="op">|&gt;</span> </span>
<span>                           <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">x_lower</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span>  <span class="va">x_upper</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                           fill <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span></span>
<span>                           <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="va">text_pos</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">5</span>, y <span class="op">=</span> <span class="fl">125</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span>, label.size <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>            label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="va">x_lower</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x_upper</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Visualizing the cumulative area under the curve"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Probability of Subscription"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-2a" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-2a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.9: Visualizing the cumulative area under the curve
</figcaption><div aria-describedby="fig-pb-13-2a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-2a-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section><section id="second-try-slightly-better" class="level4" data-number="13.7.2.2"><h4 data-number="13.7.2.2" class="anchored" data-anchor-id="second-try-slightly-better">
<span class="header-section-number">13.7.2.2</span> Second try (Slightly better)</h4>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>I am very unhappy about the many duplicates of <a href="#lst-fig-pb-13-2a" class="quarto-xref">Listing&nbsp;<span>13.14</span></a>. I tried to use loops or vectorized commands but the best I found out is <a href="#lst-fig-pb-13-2b" class="quarto-xref">Listing&nbsp;<span>13.15</span></a> with has still six duplicate code lines.</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-2b" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-2b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.15: Highlighting the cumulative area under the curve
</figcaption><div aria-describedby="lst-fig-pb-13-2b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-2b"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x_lower</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.006</span>, <span class="fl">0.0085</span>, <span class="fl">0.0005</span><span class="op">)</span></span>
<span><span class="va">x_upper</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.0065</span>, <span class="fl">0.009</span>, <span class="fl">0.0005</span><span class="op">)</span></span>
<span><span class="va">label_x_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.00625</span>, <span class="fl">0.00875</span>, <span class="fl">0.0005</span><span class="op">)</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray90"</span>, <span class="st">"gray80"</span>, <span class="st">"gray70"</span>, <span class="st">"gray50"</span>, <span class="st">"gray40"</span>, <span class="st">"black"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">cum_rate</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cum_rate</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="va">x_lower</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x_upper</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">add_label</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x_pos</span>, <span class="va">txt</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>        geom <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>        x <span class="op">=</span> <span class="va">x_pos</span>,</span>
<span>        y <span class="op">=</span> <span class="fl">125</span>,</span>
<span>        size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        label <span class="op">=</span> <span class="va">txt</span>,</span>
<span>        label.size <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">highlight_one_area</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>                       <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">x_lower</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span>  <span class="va">x_upper</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                       fill <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">df_13_2</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.006</span>, <span class="fl">0.009</span>, length.out <span class="op">=</span> <span class="fl">6000</span><span class="op">)</span>,</span>
<span>                   y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="va">p_13_2</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_2</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">highlight_one_area</span><span class="op">(</span><span class="va">df_13_2</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">highlight_one_area</span><span class="op">(</span><span class="va">df_13_2</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">highlight_one_area</span><span class="op">(</span><span class="va">df_13_2</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">highlight_one_area</span><span class="op">(</span><span class="va">df_13_2</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">highlight_one_area</span><span class="op">(</span><span class="va">df_13_2</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">highlight_one_area</span><span class="op">(</span><span class="va">df_13_2</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">add_label</span><span class="op">(</span><span class="va">label_x_pos</span>, <span class="va">cum_rate</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Visualizing the cumulative area under the curve"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Probability of Subscription"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Density"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">p_13_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-2b" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-2b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.10: Visualizing the cumulative area under the curve
</figcaption><div aria-describedby="fig-pb-13-2b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-2b-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section><section id="third-try-my-best-version" class="level4" data-number="13.7.2.3"><h4 data-number="13.7.2.3" class="anchored" data-anchor-id="third-try-my-best-version">
<span class="header-section-number">13.7.2.3</span> Third try (My best version)</h4>
<p>As I could not find a better solution for <a href="#lst-fig-pb-13-2b" class="quarto-xref">Listing&nbsp;<span>13.15</span></a> myself I posted my question in <a href="https://stackoverflow.com/questions/77182234/ggplot2-shade-several-areas-under-the-curve-using-a-loop">StackOverflow</a> and got an answer with two different options within one hour!</p>
<p>The first solution is to use <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code>. I should have known that as I came over a similar <a href="https://stackoverflow.com/a/18089991/7322615">solution</a>. The second solution is for me more complex and I have still to study it thoroughly to understand it.</p>
<p>What follows in <a href="#lst-fig-pb-13-2c" class="quarto-xref">Listing&nbsp;<span>13.16</span></a> is the modern take of <code><a href="https://rdrr.io/r/base/lapply.html">lapply()</a></code> using the <code><a href="https://purrr.tidyverse.org/reference/map.html">purrr::map()</a></code> function. (I do not understand why I had to use exactly the argument “df” and asked via SO comment.)</p>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-2c" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-2c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.16: Highlighting the cumulative area under the curve
</figcaption><div aria-describedby="lst-fig-pb-13-2c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-2c"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">########### Vectors ##############</span></span>
<span></span>
<span><span class="va">x_lower</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.006</span>, <span class="fl">0.0085</span>, <span class="fl">0.0005</span><span class="op">)</span></span>
<span><span class="va">x_upper</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.0065</span>, <span class="fl">0.009</span>, <span class="fl">0.0005</span><span class="op">)</span></span>
<span><span class="va">label_x_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.00625</span>, <span class="fl">0.00875</span>, <span class="fl">0.0005</span><span class="op">)</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray90"</span>, <span class="st">"gray80"</span>, <span class="st">"gray70"</span>, <span class="st">"gray50"</span>, <span class="st">"gray40"</span>, <span class="st">"black"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">########### Functions ############</span></span>
<span></span>
<span></span>
<span><span class="va">cum_rate</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cum_rate</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="va">x_lower</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x_upper</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="st">"value"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">add_label</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x_pos</span>, <span class="va">txt</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>        geom <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>        x <span class="op">=</span> <span class="va">x_pos</span>,</span>
<span>        y <span class="op">=</span> <span class="fl">125</span>,</span>
<span>        size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        label <span class="op">=</span> <span class="va">txt</span>,</span>
<span>        label.size <span class="op">=</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">highlight_areas</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>                       <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">x_lower</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span>  <span class="va">x_upper</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                       fill <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">######### Graph plotting ############</span></span>
<span></span>
<span><span class="va">df_13_2</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.006</span>, <span class="fl">0.009</span>, length.out <span class="op">=</span> <span class="fl">6000</span><span class="op">)</span>,</span>
<span>                   y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">p_13_2</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_2</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="va">highlight_areas</span>, df <span class="op">=</span> <span class="va">df_13_2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">add_label</span><span class="op">(</span><span class="va">label_x_pos</span>, <span class="va">cum_rate</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Visualizing the cumulative area under the curve"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Probability of Subscription"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Density"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">p_13_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-2c" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-2c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.11: Visualizing the cumulative area under the curve
</figcaption><div aria-describedby="fig-pb-13-2c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-2c-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section></section><section id="replicate-figure-13-3" class="level3" data-number="13.7.3"><h3 data-number="13.7.3" class="anchored" data-anchor-id="replicate-figure-13-3">
<span class="header-section-number">13.7.3</span> Replicate Figure 13-3</h3>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-3" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.17: Plot the cumulative area under the curve
</figcaption><div aria-describedby="lst-fig-pb-13-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_13_3</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.006</span>, <span class="fl">0.009</span>, <span class="fl">0.0005</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">pbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_3</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"The cumulative distribution function"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Subscription rate"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Cumulative Probability"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.12: Plotting just the cumulative probability from Figure 13-2
</figcaption><div aria-describedby="fig-pb-13-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section><section id="replicate-figure-13-4" class="level3" data-number="13.7.4"><h3 data-number="13.7.4" class="anchored" data-anchor-id="replicate-figure-13-4">
<span class="header-section-number">13.7.4</span> Replicate Figure 13-4</h3>
<section id="cumulative-distribution-function-cdf" class="level4" data-number="13.7.4.1"><h4 data-number="13.7.4.1" class="anchored" data-anchor-id="cumulative-distribution-function-cdf">
<span class="header-section-number">13.7.4.1</span> Cumulative Distribution Function (CDF)</h4>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-4a" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-4a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.18: Plot the Cumulative Distribution Function (CDF)
</figcaption><div aria-describedby="lst-fig-pb-13-4a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-4a"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_13_4a</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">pbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_4a</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"The cumulative distribution function"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Subscription rate"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Cumulative Probability"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-4a" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-4a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.13: The CDF for our problem
</figcaption><div aria-describedby="fig-pb-13-4a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-4a-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section><section id="empiricial-cumulative-distribution-function-ecdf---with-steps" class="level4" data-number="13.7.4.2"><h4 data-number="13.7.4.2" class="anchored" data-anchor-id="empiricial-cumulative-distribution-function-ecdf---with-steps">
<span class="header-section-number">13.7.4.2</span> Empiricial Cumulative Distribution Function (ECDF) - with steps</h4>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Trying to apply the CDF I noticed that there is also an <strong>ECDF(Empirical Cumulative Distribution Function)</strong> (GLOSSARY). The differences are that the ECDF is a step function whereas the CDF is smooth. But with many different values the ECDF approximates to ta smooth function.</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-4b" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-4b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.19: Plot the Empirical Cumulative Distribution Function (ECDF)
</figcaption><div aria-describedby="lst-fig-pb-13-4b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-4b"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_13_4b</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-4</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_4b</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html">stat_ecdf</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"The empirical cumulative distribution function (ECDF)"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"ECDF"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-4b" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-4b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.14: The ECDF for our problem
</figcaption><div aria-describedby="fig-pb-13-4b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-4b-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section><section id="empiricial-cumulative-distribution-function-ecdf---with-points" class="level4" data-number="13.7.4.3"><h4 data-number="13.7.4.3" class="anchored" data-anchor-id="empiricial-cumulative-distribution-function-ecdf---with-points">
<span class="header-section-number">13.7.4.3</span> Empiricial Cumulative Distribution Function (ECDF) - with points</h4>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-4c" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-4c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.20: Plot the Cumulative Distribution Function (CDF)
</figcaption><div aria-describedby="lst-fig-pb-13-4c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-4c"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_13_4c</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-4</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_4c</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html">stat_ecdf</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"point"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"The empirical cumulative distribution function (ECDF)"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"ECDF"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-4c" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-4c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.15: The ECDF for our problem
</figcaption><div aria-describedby="fig-pb-13-4c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-4c-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section><section id="empiricial-cumulative-distribution-function-ecdf---smooth" class="level4" data-number="13.7.4.4"><h4 data-number="13.7.4.4" class="anchored" data-anchor-id="empiricial-cumulative-distribution-function-ecdf---smooth">
<span class="header-section-number">13.7.4.4</span> Empiricial Cumulative Distribution Function (ECDF) - smooth</h4>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-4d" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-4d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.21: Plot the Empirical Cumulative Distribution Function (ECDF)
</figcaption><div aria-describedby="lst-fig-pb-13-4d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-4d"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_13_4d</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_4d</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html">stat_ecdf</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"The empirical cumulative distribution function (ECDF)"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"ECDF"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-4d" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-4d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.16: The ECDF for our problem
</figcaption><div aria-describedby="fig-pb-13-4d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-4d-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section></section><section id="sec-replicate-figure-13-5" class="level3" data-number="13.7.5"><h3 data-number="13.7.5" class="anchored" data-anchor-id="sec-replicate-figure-13-5">
<span class="header-section-number">13.7.5</span> Replicate Figure 13-5</h3>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-15" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.22: Estimate and display median using the CDF
</figcaption><div aria-describedby="lst-fig-pb-15-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">median_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">qbeta</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_13_5</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">pbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_5</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.005</span>, y <span class="op">=</span> <span class="fl">0.50</span>, </span>
<span>                          xend <span class="op">=</span> <span class="va">median_beta</span>, yend <span class="op">=</span> <span class="fl">0.50</span><span class="op">)</span>,</span>
<span>                          lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>                          size <span class="op">=</span> <span class="fl">0.8</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">median_beta</span>, y <span class="op">=</span> <span class="fl">0.50</span>, </span>
<span>                      xend <span class="op">=</span> <span class="va">median_beta</span>, yend <span class="op">=</span> <span class="fl">0.00</span><span class="op">)</span>,</span>
<span>                      lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>                      size <span class="op">=</span> <span class="fl">0.8</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, y <span class="op">=</span> <span class="fl">0.625</span>, x <span class="op">=</span> <span class="fl">0.0087</span>,</span>
<span>                      label <span class="op">=</span> <span class="st">"median = qbeta(0.5, 300, 39700)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, y <span class="op">=</span> <span class="fl">0.55</span>, x <span class="op">=</span> <span class="fl">0.0087</span>,</span>
<span>                      label <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"= {median_beta}"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Estimating median"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Probability of subscription"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Cumulative Probability"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(x = 0.005, y = 0.5, xend = median_beta, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(x = median_beta, y = 0.5, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-5" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.17: Estimating the median visually using the CDF
</figcaption><div aria-describedby="fig-pb-13-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section><section id="sec-replicate-figure-13-6" class="level3" data-number="13.7.6"><h3 data-number="13.7.6" class="anchored" data-anchor-id="sec-replicate-figure-13-6">
<span class="header-section-number">13.7.6</span> Replicate Figure 13-6</h3>
<p>In contrast to <a href="#fig-pb-13-5" class="quarto-xref">Figure&nbsp;<span>13.17</span></a> where I cheated by calculating the median of the beta distribution I will in <a href="#sec-replicate-figure-13-6" class="quarto-xref"><span>Section 13.7.6</span></a> try to approximate the integration just visually.</p>
<p>We are going to estimate the range between p(x &gt; 0.0075 and x &lt; 0.0085). The solution could be visually done approximately either with a ruler or (not so exact) just by eyeballing. To do it programmatically without integration is a somewhat complex procedure with four steps:</p>
<ol type="1">
<li>First I have to draw vertical lines from the start and end of the interesting range. These lines have to cross the CDF because I do not know the value of the cumulative probability where they meet the CDF.</li>
<li>Then I have to inspect the intersection visually and try to estimate and draw the horizontal lines. This has to be done several times until the two lines cross (almost) exactly at the CDF.</li>
<li>Now I can limit the vertical and horizontal lines, so that they stop at the CDF.</li>
<li>The last step is to estimate the range by reading the intersection at the y-axis.</li>
</ol>
<section id="first-step" class="level4" data-number="13.7.6.1"><h4 data-number="13.7.6.1" class="anchored" data-anchor-id="first-step">
<span class="header-section-number">13.7.6.1</span> First step</h4>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-6a" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-6a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.23: Approximate the integration of a range of the CDF: First step
</figcaption><div aria-describedby="lst-fig-pb-13-6a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-6a"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_13_6</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">pbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_6</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.0075</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>                        linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.0085</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>                        linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Estimating P(x &gt; 0.0075 and x &lt; 0.0085)"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Probability of subscription"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Cumulative Probability"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-6a" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-6a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.18: Visually performing integration using the CDF: First step
</figcaption><div aria-describedby="fig-pb-13-6a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-6a-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section><section id="second-step" class="level4" data-number="13.7.6.2"><h4 data-number="13.7.6.2" class="anchored" data-anchor-id="second-step">
<span class="header-section-number">13.7.6.2</span> Second step</h4>
<p>The lower cumulative probability is almost exact 0.5 as I can see and already know from <a href="#fig-pb-13-5" class="quarto-xref">Figure&nbsp;<span>13.17</span></a>. Without knowing the solution in the book my first approach was to draw a line at 0.98% of the CDF (orange). As this seems a little to less a tried with it .99%</p>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-6b" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-6b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.24: Approximate the integration of a range of the CDF: Second step
</figcaption><div aria-describedby="lst-fig-pb-13-6b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-6b"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_13_6</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">pbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_6</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.0075</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>                        linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.0085</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>                        linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>                    linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.98</span>, color <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>        linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.99</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>            linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Estimating P(x &gt; 0.0075 and x &lt; 0.0085)"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Probability of subscription"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Cumulative Probability"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-6b" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-6b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.19: Visually performing integration using the CDF: Second step
</figcaption><div aria-describedby="fig-pb-13-6b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-6b-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section><section id="third-step" class="level4" data-number="13.7.6.3"><h4 data-number="13.7.6.3" class="anchored" data-anchor-id="third-step">
<span class="header-section-number">13.7.6.3</span> Third step</h4>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-6c" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-6c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.25: Approximate the integration of a range of the CDF: Third step
</figcaption><div aria-describedby="lst-fig-pb-13-6c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-6c"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_13_6</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">pbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_6</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="fl">0.005</span>, yend <span class="op">=</span> <span class="fl">0.50</span>, </span>
<span>              x <span class="op">=</span> <span class="fl">0.00750</span>, y <span class="op">=</span> <span class="fl">0.50</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.8</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="fl">0.0075</span>, yend <span class="op">=</span> <span class="fl">0.50</span>, </span>
<span>              x <span class="op">=</span> <span class="fl">0.0075</span>, y <span class="op">=</span> <span class="fl">0.00</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.8</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.0085</span>, y <span class="op">=</span> <span class="fl">0</span>,</span>
<span>              xend <span class="op">=</span> <span class="fl">0.0085</span>, yend <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.8</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.0085</span>, y <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>              xend <span class="op">=</span> <span class="fl">0.005</span>, yend <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.8</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Estimating P(x &gt; 0.0075 and x &lt; 0.0085)"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Probability of subscription"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Cumulative Probability"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(xend = 0.005, yend = 0.5, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(xend = 0.0075, yend = 0.5, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(x = 0.0085, y = 0, xend = 0.0085, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(x = 0.0085, y = 0.99, xend = 0.005, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-6c" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-6c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.20: Visually performing integration using the CDF: Third step
</figcaption><div aria-describedby="fig-pb-13-6c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-6c-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section><section id="fourth-step" class="level4" data-number="13.7.6.4"><h4 data-number="13.7.6.4" class="anchored" data-anchor-id="fourth-step">
<span class="header-section-number">13.7.6.4</span> Fourth step</h4>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-6d" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-6d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.26: Approximate the integration of a range of the CDF: Fourth step
</figcaption><div aria-describedby="lst-fig-pb-13-6d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-6d"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_13_6</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">pbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_6</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="fl">0.005</span>, yend <span class="op">=</span> <span class="fl">0.50</span>, </span>
<span>              x <span class="op">=</span> <span class="fl">0.00750</span>, y <span class="op">=</span> <span class="fl">0.50</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.8</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="fl">0.0075</span>, yend <span class="op">=</span> <span class="fl">0.50</span>, </span>
<span>              x <span class="op">=</span> <span class="fl">0.0075</span>, y <span class="op">=</span> <span class="fl">0.00</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.8</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.0085</span>, y <span class="op">=</span> <span class="fl">0</span>,</span>
<span>              xend <span class="op">=</span> <span class="fl">0.0085</span>, yend <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.8</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.0085</span>, y <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>              xend <span class="op">=</span> <span class="fl">0.005</span>, yend <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.8</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.0055</span>, y <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>              xend <span class="op">=</span> <span class="fl">0.0055</span>, yend <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.8</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="fl">0.0055</span>, yend <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>              x <span class="op">=</span> <span class="fl">0.0055</span>, y <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.8</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">0.0058</span>, y <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                      label <span class="op">=</span> <span class="st">"~ 0.49"</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Estimating P(x &gt; 0.0075 and x &lt; 0.0085)"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Probability of subscription"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Cumulative Probability"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(xend = 0.005, yend = 0.5, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(xend = 0.0075, yend = 0.5, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(x = 0.0085, y = 0, xend = 0.0085, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(x = 0.0085, y = 0.99, xend = 0.005, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(x = 0.0055, y = 0.5, xend = 0.0055, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(xend = 0.0055, yend = 0.5, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-6d" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-6d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.21: Visually performing integration using the CDF: Fourth step
</figcaption><div aria-describedby="fig-pb-13-6d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-6d-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section></section><section id="replicate-figure-13-7" class="level3" data-number="13.7.7"><h3 data-number="13.7.7" class="anchored" data-anchor-id="replicate-figure-13-7">
<span class="header-section-number">13.7.7</span> Replicate Figure 13-7</h3>
<p>There is nothing new for approximating the range that covers 80 percent of the possible values for the true conversion rate. We use the same strategy as in <a href="#sec-replicate-figure-13-6" class="quarto-xref"><span>Section 13.7.6</span></a> but this time starting from the y-axis:</p>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-7" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.27: Approximate the confidence interval via the CDF
</figcaption><div aria-describedby="lst-fig-pb-13-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_13_7</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">pbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_7</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="fl">0.007</span>, yend <span class="op">=</span> <span class="fl">0.125</span>, </span>
<span>              x <span class="op">=</span> <span class="fl">0.005</span>, y <span class="op">=</span> <span class="fl">0.125</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.6</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="fl">0.0080</span>, yend <span class="op">=</span> <span class="fl">0.875</span>, </span>
<span>              x <span class="op">=</span> <span class="fl">0.005</span>, y <span class="op">=</span> <span class="fl">0.875</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.6</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.007</span>, y <span class="op">=</span> <span class="fl">0.125</span>,</span>
<span>              xend <span class="op">=</span> <span class="fl">0.007</span>, yend <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.6</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>          <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.008</span>, y <span class="op">=</span> <span class="fl">0.875</span>,</span>
<span>              xend <span class="op">=</span> <span class="fl">0.008</span>, yend <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span>,</span>
<span>              lineend <span class="op">=</span> <span class="st">"square"</span>, linejoin <span class="op">=</span> <span class="st">"bevel"</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">0.6</span>, arrow <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Estimating 80% Confidence Interval"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Probability of subscription"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Cumulative Probability"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(xend = 0.007, yend = 0.125, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(xend = 0.008, yend = 0.875, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(x = 0.007, y = 0.125, xend = 0.007, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_segment(ggplot2::aes(x = 0.008, y = 0.875, xend = 0.008, : All aesthetics have length 1, but the data has 5001 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-7" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.22: Estimating our confidence intervals visually using the CDF
</figcaption><div aria-describedby="fig-pb-13-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>
</section><section id="replicate-figure-13-8" class="level3" data-number="13.7.8"><h3 data-number="13.7.8" class="anchored" data-anchor-id="replicate-figure-13-8">
<span class="header-section-number">13.7.8</span> Replicate Figure 13-8</h3>
<div class="cell" data-layout-align="center">
<div id="lst-fig-pb-13-8" class="r cell-code listing quarto-float">
<figure class="quarto-float quarto-float-lst figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-fig-pb-13-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;13.28: Plot the quantile function
</figcaption><div aria-describedby="lst-fig-pb-13-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-fig-pb-13-8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_13_8</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1e-4</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">qbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">300</span>, <span class="fl">39700</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_13_8</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0.006</span>, <span class="fl">0.009</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Quantile Function Beta(300, 39700)"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Subscription rate"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Cumulative Probability"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-pb-13-8" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-pb-13-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.23: Visually, the quantile function is just a rotation of the CDF.
</figcaption><div aria-describedby="fig-pb-13-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="13-pdf-cdf-quantile_files/figure-html/fig-pb-13-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
</figure>
</div>
</div>
</div>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./12-normal-distribution.html" class="pagination-link" aria-label="The Normal Distribution">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">The Normal Distribution</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./14-prior-probabilities.html" class="pagination-link" aria-label="Parameter Estimation with Prior Probabilities">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Parameter Estimation with Prior Probabilities</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb35" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Tools of Parameter Estimation: The PDF, CDF, and Quantile Function {#sec-chap-13}</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; This chapter will cover more on the</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **probability density function (PDF)** (GLOSSARY); introduce the</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **cumulative distribution function") (CDF)**, which helps us</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; more easily determine the probability of ranges of values; and</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; introduce **quantile, quantiles** (GLOSSARY), which divide our</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; probability distributions into parts with equal probabilities. For</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; example, a *percentile* is a 100-quantile, meaning it divides the</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; probability distribution into 100 equal pieces. (115)</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimating the Conversion Rate for an Email Signup List</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Say you run a blog and want to know the probability that a visitor to</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; your blog will subscribe to your email list. In marketing terms,</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; getting a user to perform a desired event is referred to as the</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *conversion event*, or simply a *conversion*, and the probability that</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; a user will subscribe is the *conversion rate*.</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; As discussed in @sec-beta-distribution, we would use the beta</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; distribution to estimate p, the probability of subscribing, when we</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; know </span><span class="in">`k`</span><span class="at">, the number of people subscribed, and </span><span class="in">`n`</span><span class="at">, the total number</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; of visitors. The two parameters needed for the beta distribution are</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`α`</span><span class="at">, which in this case represents the total subscribed (</span><span class="in">`k`</span><span class="at">), and</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; </span><span class="in">`β`</span><span class="at">, representing the total not subscribed (</span><span class="in">`n – k`</span><span class="at">).</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Probability Density Function</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; let's say for the first 40,000 visitors, you get 300 subscribers. The</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; PDF for our problem is the beta distribution where α = 300 and β =</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 39,700.</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>::: {#thm-mean-beta}</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Computing the mean of the beta distribution</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>\mu_{Beta} = \frac{\alpha}{\alpha + \beta} <span class="sc">\\</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>\mu_{Beta} = \frac{300}{300 + 39,700} = 0.0075</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>$$ {#eq-mean-beta}</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>The blog's average conversion rate is simply</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>$\frac{subscribed}{visited}$.</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualizing and Interpreting the PDF</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>![Visualizing the beta PDF for our beliefs in the true conversion</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>rate](img/13fig01.jpg){#fig-13-01</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>fig-alt="The beta PDF as almost a normal distribution with mode = mean at .0075"</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>fig-align="center" width="70%"}</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Given that we have uncertainty in our measurement, and we have a mean,</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; it could be useful to investigate how much more likely it is that the</span></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; true conversion rate is 0.001 higher or lower than the mean of 0.0075</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; we observed.</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: integrate-higher-lower</span></span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-integrate-higher-lower lst-cap="How much more likely it is that the true conversion rate is 0.001 higher or lower"'</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(<span class="cf">function</span>(x)</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>), <span class="dv">0</span>, <span class="fl">0.0065</span>)</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(<span class="cf">function</span>(x)</span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>), <span class="fl">0.0085</span>, <span class="dv">1</span>)</span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; if we had to make a decision with the limited data we have, we could</span></span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; still calculate how much likelier one extreme is than the other:</span></span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: integrate-extremes</span></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-integrate-extremes lst-cap="How much likelier is one extreme than the other"'</span></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(<span class="cf">function</span>(x)</span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>), <span class="fl">0.0085</span>, <span class="dv">1</span>)[[<span class="st">"value"</span>]] <span class="sc">/</span></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(<span class="cf">function</span>(x)</span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>), <span class="dv">0</span>, <span class="fl">0.0065</span>)[[<span class="st">"value"</span>]]</span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>It's 56 percent more likely that our true conversion rate is greater</span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>than 0.0085 than that it's lower than 0.0065.</span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a><span class="fu">### Working with the PDF in R</span></span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a>I am going to use my own code in @sec-replicate-fig-13-1. But to see what it looks like I use the R base code lines from the book:</span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: draw-pdf-with-base-r</span></span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-draw-pdf-with-base-r lst-cap="Working with the PDF in base R"'</span></span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="at">by =</span> <span class="fl">0.00001</span>)</span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a>xs.all <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.0001</span>)</span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a>    xs,</span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbeta</span>(xs, <span class="dv">300</span>, <span class="dv">40000</span> <span class="sc">-</span> <span class="dv">300</span>),</span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">'l'</span>,</span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">3</span>,</span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"density"</span>,</span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"probability of subscription"</span>,</span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"PDF Beta(300,39700)"</span></span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introducing the Cumulative Distribution Function</span></span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; we can save ourselves a lot of effort with the cumulative distribution</span></span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; function (CDF), which sums all parts of our distribution, replacing a</span></span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; lot of calculus work. ... The CDF takes in a value and returns the</span></span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; probability of getting that value or lower.</span></span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-119"><a href="#cb35-119" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The CDF gets this probability by taking the cumulative area under the</span></span>
<span id="cb35-120"><a href="#cb35-120" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; curve for the PDF (for those comfortable with calculus, the CDF is the</span></span>
<span id="cb35-121"><a href="#cb35-121" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *anti-derivative* of the PDF). We can summarize this process in two</span></span>
<span id="cb35-122"><a href="#cb35-122" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; steps: (1) figure out the cumulative area under the curve for each</span></span>
<span id="cb35-123"><a href="#cb35-123" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; value of the PDF, and (2) plot those values. That's our CDF.</span></span>
<span id="cb35-124"><a href="#cb35-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-125"><a href="#cb35-125" aria-hidden="true" tabindex="-1"></a>![Visualizing the cumulative area under the</span>
<span id="cb35-126"><a href="#cb35-126" aria-hidden="true" tabindex="-1"></a>curve](img/13fig02.jpg){#fig-13-02</span>
<span id="cb35-127"><a href="#cb35-127" aria-hidden="true" tabindex="-1"></a>fig-alt="Visualizing the cumulative area under the curve of the beta distribution in steps to 0.0005"</span>
<span id="cb35-128"><a href="#cb35-128" aria-hidden="true" tabindex="-1"></a>fig-align="center" width="70%"}</span>
<span id="cb35-129"><a href="#cb35-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-130"><a href="#cb35-130" aria-hidden="true" tabindex="-1"></a>@fig-13-02 shows the cumulative area under the curve for the PDF of</span>
<span id="cb35-131"><a href="#cb35-131" aria-hidden="true" tabindex="-1"></a>Beta(300,39700). As you can see, our cumulative area under the curve</span>
<span id="cb35-132"><a href="#cb35-132" aria-hidden="true" tabindex="-1"></a>takes into account all of the area in the pieces to its left.</span>
<span id="cb35-133"><a href="#cb35-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-134"><a href="#cb35-134" aria-hidden="true" tabindex="-1"></a>Using this approach, as we move along the PDF, we take into account an</span>
<span id="cb35-135"><a href="#cb35-135" aria-hidden="true" tabindex="-1"></a>increasingly higher probability until our total area is 1, or complete</span>
<span id="cb35-136"><a href="#cb35-136" aria-hidden="true" tabindex="-1"></a>certainty. To turn this into the CDF, we can imagine a function that</span>
<span id="cb35-137"><a href="#cb35-137" aria-hidden="true" tabindex="-1"></a>looks at only these areas under the curve.</span>
<span id="cb35-138"><a href="#cb35-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-139"><a href="#cb35-139" aria-hidden="true" tabindex="-1"></a>@fig-13-03 shows what happens if we plot the area under the curve for</span>
<span id="cb35-140"><a href="#cb35-140" aria-hidden="true" tabindex="-1"></a>each of our points, which are 0.0005 apart.</span>
<span id="cb35-141"><a href="#cb35-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-142"><a href="#cb35-142" aria-hidden="true" tabindex="-1"></a>![Plotting just the cumulative probability from</span>
<span id="cb35-143"><a href="#cb35-143" aria-hidden="true" tabindex="-1"></a>@fig-13-02](img/13fig03.jpg){#fig-13-03</span>
<span id="cb35-144"><a href="#cb35-144" aria-hidden="true" tabindex="-1"></a>fig-alt="Plotting the area under the curve for each of our points, which are 0.0005 apart results in an S curve"</span>
<span id="cb35-145"><a href="#cb35-145" aria-hidden="true" tabindex="-1"></a>fig-align="center" width="70%"}</span>
<span id="cb35-146"><a href="#cb35-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-147"><a href="#cb35-147" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Now we have a way of visualizing just how the cumulative area under</span></span>
<span id="cb35-148"><a href="#cb35-148" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the curve changes as we move along the values for our PDF. Of course,</span></span>
<span id="cb35-149"><a href="#cb35-149" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the problem is that we're using these discrete chunks. In reality, the</span></span>
<span id="cb35-150"><a href="#cb35-150" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; CDF just uses infinitely small pieces of the PDF, so we get a nice</span></span>
<span id="cb35-151"><a href="#cb35-151" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; smooth line as seen in @fig-13-04.</span></span>
<span id="cb35-152"><a href="#cb35-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-153"><a href="#cb35-153" aria-hidden="true" tabindex="-1"></a><span class="al">![The CDF for our problem](img/13fig04.jpg)</span>{#fig-13-04</span>
<span id="cb35-154"><a href="#cb35-154" aria-hidden="true" tabindex="-1"></a>fig-alt="The CDF for our problem of conversion to blog subscriber"</span>
<span id="cb35-155"><a href="#cb35-155" aria-hidden="true" tabindex="-1"></a>fig-align="center" width="70%"}</span>
<span id="cb35-156"><a href="#cb35-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-157"><a href="#cb35-157" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualizing and Interpreting the CDF</span></span>
<span id="cb35-158"><a href="#cb35-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-159"><a href="#cb35-159" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The PDF is most useful visually for quickly estimating where the peak</span></span>
<span id="cb35-160"><a href="#cb35-160" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; of a distribution is, and for getting a rough sense of the width</span></span>
<span id="cb35-161"><a href="#cb35-161" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; (variance) and shape of a distribution. However, with the PDF it is</span></span>
<span id="cb35-162"><a href="#cb35-162" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; very difficult to reason about the probability of various ranges</span></span>
<span id="cb35-163"><a href="#cb35-163" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; visually. The CDF is a much better tool for this.</span></span>
<span id="cb35-164"><a href="#cb35-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-165"><a href="#cb35-165" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Finding the median {#sec-finding-the-median}</span></span>
<span id="cb35-166"><a href="#cb35-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-167"><a href="#cb35-167" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Unlike the mean, computing the median can actually be pretty tricky.</span></span>
<span id="cb35-168"><a href="#cb35-168" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; For small, discrete cases, it's as simple as putting your observations</span></span>
<span id="cb35-169"><a href="#cb35-169" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; in order and selecting the value in the middle. But for continuous</span></span>
<span id="cb35-170"><a href="#cb35-170" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; distributions like our beta distribution, it's a little more</span></span>
<span id="cb35-171"><a href="#cb35-171" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; complicated.</span></span>
<span id="cb35-172"><a href="#cb35-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-173"><a href="#cb35-173" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Thankfully, we can easily spot the median on a visualization of the</span></span>
<span id="cb35-174"><a href="#cb35-174" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; CDF. We can simply draw a line from the point where the cumulative</span></span>
<span id="cb35-175"><a href="#cb35-175" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; probability is 0.5, meaning 50 percent of the values are below this</span></span>
<span id="cb35-176"><a href="#cb35-176" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; point and 50 percent are above.</span></span>
<span id="cb35-177"><a href="#cb35-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-178"><a href="#cb35-178" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb35-179"><a href="#cb35-179" aria-hidden="true" tabindex="-1"></a>There are many packages about the beta functions out there that provides</span>
<span id="cb35-180"><a href="#cb35-180" aria-hidden="true" tabindex="-1"></a>functions for parameter calculation: For instance <span class="in">`betamedian()`</span> of</span>
<span id="cb35-181"><a href="#cb35-181" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">{**betafunctions**}</span><span class="co">](https://search.r-project.org/CRAN/refmans/betafunctions/html/betamedian.html)</span>.</span>
<span id="cb35-182"><a href="#cb35-182" aria-hidden="true" tabindex="-1"></a>But in a [StackOverflow</span>
<span id="cb35-183"><a href="#cb35-183" aria-hidden="true" tabindex="-1"></a>post](https://stackoverflow.com/questions/59077866/is-there-a-way-to-find-the-median-using-beta-distribution-parameters-in-r)</span>
<span id="cb35-184"><a href="#cb35-184" aria-hidden="true" tabindex="-1"></a>is the suggestion simple to use <span class="in">`qbeta()`</span> with <span class="in">`p = 0.5`</span>.</span>
<span id="cb35-185"><a href="#cb35-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-186"><a href="#cb35-186" aria-hidden="true" tabindex="-1"></a>This is what I have done in replicating @fig-13-05 with my @fig-pb-13-5.</span>
<span id="cb35-187"><a href="#cb35-187" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-188"><a href="#cb35-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-189"><a href="#cb35-189" aria-hidden="true" tabindex="-1"></a>![Estimating the median visually using the</span>
<span id="cb35-190"><a href="#cb35-190" aria-hidden="true" tabindex="-1"></a>CDF](img/13fig05.jpg){#fig-13-05</span>
<span id="cb35-191"><a href="#cb35-191" aria-hidden="true" tabindex="-1"></a>fig-alt="Estimating the median visually using the CDF"</span>
<span id="cb35-192"><a href="#cb35-192" aria-hidden="true" tabindex="-1"></a>fig-align="center" width="70%"}</span>
<span id="cb35-193"><a href="#cb35-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-194"><a href="#cb35-194" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Approximating Integrals Visually</span></span>
<span id="cb35-195"><a href="#cb35-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-196"><a href="#cb35-196" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; When working with ranges of probabilities, we'll often want to know</span></span>
<span id="cb35-197"><a href="#cb35-197" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the probability that the true value lies somewhere between some value</span></span>
<span id="cb35-198"><a href="#cb35-198" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; y and some value x.</span></span>
<span id="cb35-199"><a href="#cb35-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-200"><a href="#cb35-200" aria-hidden="true" tabindex="-1"></a>Time-consuming computation the integration with R is not necessary as we</span>
<span id="cb35-201"><a href="#cb35-201" aria-hidden="true" tabindex="-1"></a>can eyeball whether or not a certain range of values has a very high</span>
<span id="cb35-202"><a href="#cb35-202" aria-hidden="true" tabindex="-1"></a>probability or a very low probability of occurring.</span>
<span id="cb35-203"><a href="#cb35-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-204"><a href="#cb35-204" aria-hidden="true" tabindex="-1"></a>![Visually performing integration using the</span>
<span id="cb35-205"><a href="#cb35-205" aria-hidden="true" tabindex="-1"></a>CDF](img/13fig06.jpg){#fig-13-06</span>
<span id="cb35-206"><a href="#cb35-206" aria-hidden="true" tabindex="-1"></a>fig-alt="Visually performing integration using the CDF"</span>
<span id="cb35-207"><a href="#cb35-207" aria-hidden="true" tabindex="-1"></a>fig-align="center" width="70%"}</span>
<span id="cb35-208"><a href="#cb35-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-209"><a href="#cb35-209" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Estimating Confidence Intervals</span></span>
<span id="cb35-210"><a href="#cb35-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-211"><a href="#cb35-211" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Looking at the probability of ranges of values leads us to a very</span></span>
<span id="cb35-212"><a href="#cb35-212" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; important concept in probability: the confidence interval. A</span></span>
<span id="cb35-213"><a href="#cb35-213" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; confidence interval is a lower and upper bound of values, typically</span></span>
<span id="cb35-214"><a href="#cb35-214" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; centered on the mean, describing a range of high probability, usually</span></span>
<span id="cb35-215"><a href="#cb35-215" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 95, 99, or 99.9 percent. When we say something like "The 95 percent</span></span>
<span id="cb35-216"><a href="#cb35-216" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; confidence interval is from 12 to 20," what we mean is that there is a</span></span>
<span id="cb35-217"><a href="#cb35-217" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 95 percent probability that our true measurement is somewhere between</span></span>
<span id="cb35-218"><a href="#cb35-218" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; 12 and 20. Confidence intervals provide a good method of describing</span></span>
<span id="cb35-219"><a href="#cb35-219" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; the range of possibilities when we're dealing with uncertain</span></span>
<span id="cb35-220"><a href="#cb35-220" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; information.</span></span>
<span id="cb35-221"><a href="#cb35-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-222"><a href="#cb35-222" aria-hidden="true" tabindex="-1"></a>In spite of a special note "*In Bayesian statistics what we are calling</span>
<span id="cb35-223"><a href="#cb35-223" aria-hidden="true" tabindex="-1"></a>a "confidence interval" can go by a few other names, such as "critical</span>
<span id="cb35-224"><a href="#cb35-224" aria-hidden="true" tabindex="-1"></a>region" or "critical interval." In some more traditional schools of</span>
<span id="cb35-225"><a href="#cb35-225" aria-hidden="true" tabindex="-1"></a>statistics, "confidence interval" has a slightly different meaning,</span>
<span id="cb35-226"><a href="#cb35-226" aria-hidden="true" tabindex="-1"></a>which is beyond the scope of this book.*" this concept and notions are</span>
<span id="cb35-227"><a href="#cb35-227" aria-hidden="true" tabindex="-1"></a>not correct for Bayesian statistics. At least what I have learned</span>
<span id="cb35-228"><a href="#cb35-228" aria-hidden="true" tabindex="-1"></a>reading other books, especially <span class="co">[</span><span class="ot">@mcelreath2020</span><span class="co">]</span>.</span>
<span id="cb35-229"><a href="#cb35-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-230"><a href="#cb35-230" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb35-231"><a href="#cb35-231" aria-hidden="true" tabindex="-1"></a>**Bayesian statistics** (GLOSSARY)  talks about **credible interval, credible intervals** (GLOSSARY)  that have a very different meaning as the **confidence interval, confidence intervals** (GLOSSARY)  of **frequentist statistics** (GLOSSARY). McElreath even proposes the notion of **compatibility interval, compatibility intervals** (GLOSSARY).</span>
<span id="cb35-232"><a href="#cb35-232" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-233"><a href="#cb35-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-234"><a href="#cb35-234" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Say we wanted to know the range that covers 80 percent of the possible values for the true conversion rate. We solve this problem by combining our previous approaches: we draw lines at the y-axis from 0.1 and 0.9 to cover 80 percent, and then simply see where on the x-axis these intersect with our CDF:</span></span>
<span id="cb35-235"><a href="#cb35-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-236"><a href="#cb35-236" aria-hidden="true" tabindex="-1"></a>![Estimating our confidence intervals visually using the</span>
<span id="cb35-237"><a href="#cb35-237" aria-hidden="true" tabindex="-1"></a>CDF](img/13fig07.jpg){#fig-13-07</span>
<span id="cb35-238"><a href="#cb35-238" aria-hidden="true" tabindex="-1"></a>fig-alt="Estimating our confidence intervals visually using the CDF"</span>
<span id="cb35-239"><a href="#cb35-239" aria-hidden="true" tabindex="-1"></a>fig-align="center" width="70%"}</span>
<span id="cb35-240"><a href="#cb35-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-241"><a href="#cb35-241" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using the CDF in R</span></span>
<span id="cb35-242"><a href="#cb35-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-243"><a href="#cb35-243" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Just as nearly all major PDFs have a function starting with $d$, like </span><span class="in">`dnorm()`</span><span class="at">, CDF functions start with $p$, such as </span><span class="in">`pnorm()`</span><span class="at">.</span></span>
<span id="cb35-244"><a href="#cb35-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-245"><a href="#cb35-245" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb35-246"><a href="#cb35-246" aria-hidden="true" tabindex="-1"></a>This is a new information for me. Now I understand better the differences and use cases of the different types of distribution. My comprehension will be fostered with the next section when the application of function starting with $q$ is explained.</span>
<span id="cb35-247"><a href="#cb35-247" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-248"><a href="#cb35-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-251"><a href="#cb35-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-252"><a href="#cb35-252" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: calc-beta-less-0.0065</span></span>
<span id="cb35-253"><a href="#cb35-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-calc-beta-less-0.0065 lst-cap="Calculate the probability that Beta(300,39700) is less than 0.0065"'</span></span>
<span id="cb35-254"><a href="#cb35-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-255"><a href="#cb35-255" aria-hidden="true" tabindex="-1"></a><span class="fu">pbeta</span>(<span class="fl">0.0065</span>,<span class="dv">300</span>,<span class="dv">39700</span>)</span>
<span id="cb35-256"><a href="#cb35-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-257"><a href="#cb35-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-258"><a href="#cb35-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-261"><a href="#cb35-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-262"><a href="#cb35-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: calc-beta-greater-0.0085</span></span>
<span id="cb35-263"><a href="#cb35-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-calc-beta-greater-0.0085 lst-cap="Calculate the true probability that the conversion rate is greater than 0.0085"'</span></span>
<span id="cb35-264"><a href="#cb35-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-265"><a href="#cb35-265" aria-hidden="true" tabindex="-1"></a><span class="fu">pbeta</span>(<span class="dv">1</span>,<span class="dv">300</span>,<span class="dv">39700</span>) <span class="sc">-</span> <span class="fu">pbeta</span>(<span class="fl">0.0085</span>,<span class="dv">300</span>,<span class="dv">39700</span>)</span>
<span id="cb35-266"><a href="#cb35-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-267"><a href="#cb35-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-268"><a href="#cb35-268" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The great thing about CDFs is that it doesn’t matter if your distribution is discrete or continuous. If we wanted to determine the probability of getting three or fewer heads in five coin tosses, for example, we would use the CDF for the binomial distribution like this:</span></span>
<span id="cb35-269"><a href="#cb35-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-272"><a href="#cb35-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-273"><a href="#cb35-273" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: calc-beta-3-or-fewer-heads-5-tosses</span></span>
<span id="cb35-274"><a href="#cb35-274" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-calc-beta-3-or-fewer-heads-5-tosses lst-cap="Calculate the probability of getting three or fewer heads in five coin tosses"'</span></span>
<span id="cb35-275"><a href="#cb35-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-276"><a href="#cb35-276" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="fl">0.5</span>)</span>
<span id="cb35-277"><a href="#cb35-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-278"><a href="#cb35-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-279"><a href="#cb35-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-280"><a href="#cb35-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-281"><a href="#cb35-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Quantile Function</span></span>
<span id="cb35-282"><a href="#cb35-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-283"><a href="#cb35-283" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Mathematically, the CDF is like any other function in that it takes an $x$ value, often representing the value we’re trying to estimate, and gives us a $y$ value, which represents the cumulative probability. But there is no obvious way to do this in reverse; that is, we can’t give the same function a $y$ to get an $x$.</span></span>
<span id="cb35-284"><a href="#cb35-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-285"><a href="#cb35-285" aria-hidden="true" tabindex="-1"></a>But we did reversing the function when we estimated the median in @sec-finding-the-median respectively in my version in @sec-replicate-figure-13-5.</span>
<span id="cb35-286"><a href="#cb35-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-287"><a href="#cb35-287" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The inverse of the CDF is an incredibly common and useful tool called the quantile function. To compute an exact value for our median and confidence interval, we need to use the quantile function for the beta distribution. </span></span>
<span id="cb35-288"><a href="#cb35-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-289"><a href="#cb35-289" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualizing and Understanding the Quantile Function</span></span>
<span id="cb35-290"><a href="#cb35-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-291"><a href="#cb35-291" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Because the quantile function is simply the inverse of the CDF, it just looks like the CDF rotated 90 degrees, as shown in @fig-13-08.</span></span>
<span id="cb35-292"><a href="#cb35-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-293"><a href="#cb35-293" aria-hidden="true" tabindex="-1"></a><span class="al">![Visually, the quantile function is just a rotation of the CDF](img/13fig08.jpg)</span>{#fig-13-08</span>
<span id="cb35-294"><a href="#cb35-294" aria-hidden="true" tabindex="-1"></a>fig-alt="Visually, the quantile function is just a rotation of the CDF"</span>
<span id="cb35-295"><a href="#cb35-295" aria-hidden="true" tabindex="-1"></a>fig-align="center" width="70%"}</span>
<span id="cb35-296"><a href="#cb35-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-297"><a href="#cb35-297" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Whenever you hear phrases like:</span></span>
<span id="cb35-298"><a href="#cb35-298" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb35-299"><a href="#cb35-299" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - “The top 10 percent of students …”</span></span>
<span id="cb35-300"><a href="#cb35-300" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - “The bottom 20 percent of earners earn less than …”</span></span>
<span id="cb35-301"><a href="#cb35-301" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; - “The top quartile has notably better performance than …”</span></span>
<span id="cb35-302"><a href="#cb35-302" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;</span></span>
<span id="cb35-303"><a href="#cb35-303" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; you’re talking about values that are found using the quantile function</span></span>
<span id="cb35-304"><a href="#cb35-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-305"><a href="#cb35-305" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculating Quantiles in R</span></span>
<span id="cb35-306"><a href="#cb35-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-307"><a href="#cb35-307" aria-hidden="true" tabindex="-1"></a>We are using the function <span class="in">`qnorm()`</span> for calculating **quantile, quantiles** (GLOSSARY).</span>
<span id="cb35-308"><a href="#cb35-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-309"><a href="#cb35-309" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; For example, if we want to know the value that 99.9 percent of the distribution is less than, we can use qbeta() with the quantile we’re interested in calculating as the first argument, and the alpha and beta parameters of our beta distribution as the second and third arguments, like so:</span></span>
<span id="cb35-310"><a href="#cb35-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-313"><a href="#cb35-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-314"><a href="#cb35-314" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: qbeta-less-99.9</span></span>
<span id="cb35-315"><a href="#cb35-315" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-qbeta-less-99.9 lst-cap="Value that we 99.9 percent certain that the true conversion rate for our emails is less than 0.0089"' </span></span>
<span id="cb35-316"><a href="#cb35-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-317"><a href="#cb35-317" aria-hidden="true" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fl">0.999</span>, <span class="dv">300</span>, <span class="dv">39700</span>)</span>
<span id="cb35-318"><a href="#cb35-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-319"><a href="#cb35-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-320"><a href="#cb35-320" aria-hidden="true" tabindex="-1"></a>The result is 0.0089, meaning we can be 99.9 percent certain that the true conversion rate for our emails is less than 0.0089.</span>
<span id="cb35-321"><a href="#cb35-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-322"><a href="#cb35-322" aria-hidden="true" tabindex="-1"></a>With the quantile function we can also calculate the 95% confidence interval by finding the lower and upper 2.5% quantile:</span>
<span id="cb35-323"><a href="#cb35-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-326"><a href="#cb35-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-327"><a href="#cb35-327" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: get-95-conf-int</span></span>
<span id="cb35-328"><a href="#cb35-328" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-get-95-conf-int lst-cap="Calculate the 95% confidence interval"'</span></span>
<span id="cb35-329"><a href="#cb35-329" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"The lower bound is {round(qbeta(0.025,300,39700), 7)} and the upper bound is {round(qbeta(0.975,300,39700) ,7)}."</span>)</span>
<span id="cb35-330"><a href="#cb35-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-331"><a href="#cb35-331" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Now we can confidently say that we are 95 percent certain that the real conversion rate for blog visitors is somewhere between 0.67 percent and 0.84 percent. … Suppose an article on your blog goes viral and gets 100,000 visitors. Based on our calculations, we know that we should expect between 670 and 840 new email subscribers.</span></span>
<span id="cb35-332"><a href="#cb35-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-333"><a href="#cb35-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-334"><a href="#cb35-334" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wrapping Up</span></span>
<span id="cb35-335"><a href="#cb35-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-336"><a href="#cb35-336" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb35-337"><a href="#cb35-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-338"><a href="#cb35-338" aria-hidden="true" tabindex="-1"></a>Try answering the following questions to see how well you understand the</span>
<span id="cb35-339"><a href="#cb35-339" aria-hidden="true" tabindex="-1"></a>tools of parameter estimation. The solutions can be found at</span>
<span id="cb35-340"><a href="#cb35-340" aria-hidden="true" tabindex="-1"></a>https://nostarch.com/learnbayes/.</span>
<span id="cb35-341"><a href="#cb35-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-342"><a href="#cb35-342" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise 13-1</span></span>
<span id="cb35-343"><a href="#cb35-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-344"><a href="#cb35-344" aria-hidden="true" tabindex="-1"></a>Using the code example for plotting the PDF on page 127, plot the CDF</span>
<span id="cb35-345"><a href="#cb35-345" aria-hidden="true" tabindex="-1"></a>and quantile functions.</span>
<span id="cb35-346"><a href="#cb35-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-347"><a href="#cb35-347" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For the CDF see @lst-fig-pb-13-4a and @fig-pb-13-4a.</span>
<span id="cb35-348"><a href="#cb35-348" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For the quantile function see @lst-fig-pb-13-8 and @fig-pb-13-8.</span>
<span id="cb35-349"><a href="#cb35-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-350"><a href="#cb35-350" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise 13-2</span></span>
<span id="cb35-351"><a href="#cb35-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-352"><a href="#cb35-352" aria-hidden="true" tabindex="-1"></a>Returning to the task of measuring snowfall from @sec-chap-10, say you</span>
<span id="cb35-353"><a href="#cb35-353" aria-hidden="true" tabindex="-1"></a>have the following measurements (in inches) of snowfall: 7.8, 9.4, 10.0,</span>
<span id="cb35-354"><a href="#cb35-354" aria-hidden="true" tabindex="-1"></a>7.9, 9.4, 7.0, 7.0, 7.1, 8.9, 7.4</span>
<span id="cb35-355"><a href="#cb35-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-356"><a href="#cb35-356" aria-hidden="true" tabindex="-1"></a>What is your 99.9 percent confidence interval for the true value of</span>
<span id="cb35-357"><a href="#cb35-357" aria-hidden="true" tabindex="-1"></a>snowfall?</span>
<span id="cb35-358"><a href="#cb35-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-361"><a href="#cb35-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-362"><a href="#cb35-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exr-13-2</span></span>
<span id="cb35-363"><a href="#cb35-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-exr-13-2 lst-cap="Calculate the 99% confidence interval"'</span></span>
<span id="cb35-364"><a href="#cb35-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-365"><a href="#cb35-365" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="fl">7.8</span>, <span class="fl">9.4</span>, <span class="fl">10.0</span>, <span class="fl">7.9</span>, <span class="fl">9.4</span>, <span class="fl">7.0</span>, <span class="fl">7.0</span>, <span class="fl">7.1</span>, <span class="fl">8.9</span>, <span class="fl">7.4</span>)</span>
<span id="cb35-366"><a href="#cb35-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-367"><a href="#cb35-367" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"The lower bound is {round(qnorm(0.0005,mean(x), sd(x)), 2)} and the upper bound is {round(qnorm(0.9995,mean(x), sd(x)), 2)}."</span>)</span>
<span id="cb35-368"><a href="#cb35-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-369"><a href="#cb35-369" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb35-370"><a href="#cb35-370" aria-hidden="true" tabindex="-1"></a>Besides that in my try I used the <span class="in">`sd_fun()`</span> function from @lst-comp-sigma-with-own-function, I commit an error in using bounds of 0.001 and 0.999 instead of 0.0005 and 0.9995.</span>
<span id="cb35-371"><a href="#cb35-371" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-372"><a href="#cb35-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-373"><a href="#cb35-373" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise 13-3</span></span>
<span id="cb35-374"><a href="#cb35-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-375"><a href="#cb35-375" aria-hidden="true" tabindex="-1"></a>A child is going door to door selling candy bars. So far she has visited</span>
<span id="cb35-376"><a href="#cb35-376" aria-hidden="true" tabindex="-1"></a>30 houses and sold 10 candy bars. She will visit 40 more houses today.</span>
<span id="cb35-377"><a href="#cb35-377" aria-hidden="true" tabindex="-1"></a>What is the 95 percent confidence interval for how many candy bars she</span>
<span id="cb35-378"><a href="#cb35-378" aria-hidden="true" tabindex="-1"></a>will sell the rest of the day?</span>
<span id="cb35-379"><a href="#cb35-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-382"><a href="#cb35-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-383"><a href="#cb35-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: exr-13-3</span></span>
<span id="cb35-384"><a href="#cb35-384" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-exr-13-3 lst-cap="Calculate the 95 percent confidence interval for how many candy bars will be sold"'</span></span>
<span id="cb35-385"><a href="#cb35-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-386"><a href="#cb35-386" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"The lower bound is {round(qbeta(0.025, 10, 20), 2)}% and the upper bound is {round(qbeta(0.975, 10, 20), 2)}%."</span>)</span>
<span id="cb35-387"><a href="#cb35-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-388"><a href="#cb35-388" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"This means that she will with 95% probability get between 40 * 0.18 = {40 * 0.18} and 40 * 0.51 = {40 * 0.51} candy bars."</span>)</span>
<span id="cb35-389"><a href="#cb35-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-390"><a href="#cb35-390" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"But she can only sell complete bars: Therefore she will sell between {floor(40 * 0.18)} and {floor(40 * 0.51)} candy bars."</span>)</span>
<span id="cb35-391"><a href="#cb35-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-392"><a href="#cb35-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-393"><a href="#cb35-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-394"><a href="#cb35-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-395"><a href="#cb35-395" aria-hidden="true" tabindex="-1"></a><span class="fu">## Experiments</span></span>
<span id="cb35-396"><a href="#cb35-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-397"><a href="#cb35-397" aria-hidden="true" tabindex="-1"></a>I started with @fig-pb-13-4a because this is the easiest graph, as it</span>
<span id="cb35-398"><a href="#cb35-398" aria-hidden="true" tabindex="-1"></a>replicates @fig-13-04 with just the CDF and nothing else. So maybe you</span>
<span id="cb35-399"><a href="#cb35-399" aria-hidden="true" tabindex="-1"></a>will begin also with this basic plot. After @fig-pb-13-4a the natural</span>
<span id="cb35-400"><a href="#cb35-400" aria-hidden="true" tabindex="-1"></a>sequence -- ordered by complexity -- is @fig-pb-13-3. After that you can</span>
<span id="cb35-401"><a href="#cb35-401" aria-hidden="true" tabindex="-1"></a>inspect in detail my different tries with @fig-13-02 (@fig-pb-13-2a,</span>
<span id="cb35-402"><a href="#cb35-402" aria-hidden="true" tabindex="-1"></a>@fig-pb-13-2b and my best solution @fig-pb-13-2c) . Then follow my</span>
<span id="cb35-403"><a href="#cb35-403" aria-hidden="true" tabindex="-1"></a>sequences here from @fig-13-05 to @fig-13-08.</span>
<span id="cb35-404"><a href="#cb35-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-405"><a href="#cb35-405" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb35-406"><a href="#cb35-406" aria-hidden="true" tabindex="-1"></a>There is the following system in using distributions with R, exemplified</span>
<span id="cb35-407"><a href="#cb35-407" aria-hidden="true" tabindex="-1"></a>with the normal distribution:</span>
<span id="cb35-408"><a href="#cb35-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-409"><a href="#cb35-409" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`dnorm`</span> for plotting probability densities functions (PDFs).</span>
<span id="cb35-410"><a href="#cb35-410" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`pnorm`</span> for plotting cumulative distribution functions (CDFs).</span>
<span id="cb35-411"><a href="#cb35-411" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`qnorm`</span> for plotting quantile functions, it is the reverse of CDFs.</span>
<span id="cb35-412"><a href="#cb35-412" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`rnorm`</span> for generating and plotting random distributions.</span>
<span id="cb35-413"><a href="#cb35-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-414"><a href="#cb35-414" aria-hidden="true" tabindex="-1"></a>See</span>
<span id="cb35-415"><a href="#cb35-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-416"><a href="#cb35-416" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>R help file for [Distributions in the stats</span>
<span id="cb35-417"><a href="#cb35-417" aria-hidden="true" tabindex="-1"></a>    package](https://rdrr.io/r/stats/Distributions.html).</span>
<span id="cb35-418"><a href="#cb35-418" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>[The distribution</span>
<span id="cb35-419"><a href="#cb35-419" aria-hidden="true" tabindex="-1"></a>    zoo](https://ben18785.shinyapps.io/distribution-zoo/) (a shiny</span>
<span id="cb35-420"><a href="#cb35-420" aria-hidden="true" tabindex="-1"></a>    application by <span class="co">[</span><span class="ot">Ben Lambert</span><span class="co">](https://ben-lambert.com/bayesian/)</span> &amp;</span>
<span id="cb35-421"><a href="#cb35-421" aria-hidden="true" tabindex="-1"></a>    [Fergus</span>
<span id="cb35-422"><a href="#cb35-422" aria-hidden="true" tabindex="-1"></a>    Cooper](https://www.cs.ox.ac.uk/people/fergus.cooper/site/)). See</span>
<span id="cb35-423"><a href="#cb35-423" aria-hidden="true" tabindex="-1"></a>    for the code the [GitHub</span>
<span id="cb35-424"><a href="#cb35-424" aria-hidden="true" tabindex="-1"></a>    repo](https://github.com/ben18785/distribution-zoo).</span>
<span id="cb35-425"><a href="#cb35-425" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-426"><a href="#cb35-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-427"><a href="#cb35-427" aria-hidden="true" tabindex="-1"></a><span class="fu">### Replicate Figure 13-1 {#sec-replicate-fig-13-1}</span></span>
<span id="cb35-428"><a href="#cb35-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-429"><a href="#cb35-429" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Wrong dimension of x-axis for Figure 13-1</span></span>
<span id="cb35-430"><a href="#cb35-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-431"><a href="#cb35-431" aria-hidden="true" tabindex="-1"></a>At first I got the following graph:</span>
<span id="cb35-432"><a href="#cb35-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-435"><a href="#cb35-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-436"><a href="#cb35-436" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">0001</span>),</span>
<span id="cb35-437"><a href="#cb35-437" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb35-438"><a href="#cb35-438" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-439"><a href="#cb35-439" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>()</span>
<span id="cb35-440"><a href="#cb35-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-441"><a href="#cb35-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-442"><a href="#cb35-442" aria-hidden="true" tabindex="-1"></a>The problem here is that the interesting part of the PDF is very small</span>
<span id="cb35-443"><a href="#cb35-443" aria-hidden="true" tabindex="-1"></a>as we know from the $\frac{300}{40000} = 0.0075$. Therefore it does not</span>
<span id="cb35-444"><a href="#cb35-444" aria-hidden="true" tabindex="-1"></a>make sense to spread the grid from 0 to 1. We get a much better</span>
<span id="cb35-445"><a href="#cb35-445" aria-hidden="true" tabindex="-1"></a>visualization in the area 0 to 001:</span>
<span id="cb35-446"><a href="#cb35-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-447"><a href="#cb35-447" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Better dimension of x-axis but still not identical for Figure 13-1</span></span>
<span id="cb35-448"><a href="#cb35-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-451"><a href="#cb35-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-452"><a href="#cb35-452" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.01</span>, .<span class="dv">0001</span>),</span>
<span id="cb35-453"><a href="#cb35-453" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb35-454"><a href="#cb35-454" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-455"><a href="#cb35-455" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>()</span>
<span id="cb35-456"><a href="#cb35-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-457"><a href="#cb35-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-458"><a href="#cb35-458" aria-hidden="true" tabindex="-1"></a>But even this curve is not optimal. Now let's try the interval <span class="sc">\[</span>0.005,</span>
<span id="cb35-459"><a href="#cb35-459" aria-hidden="true" tabindex="-1"></a>0.01<span class="sc">\]</span>:</span>
<span id="cb35-460"><a href="#cb35-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-461"><a href="#cb35-461" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Optimal dimension of x-axis but grid too wide for smooth Figure 13-1</span></span>
<span id="cb35-462"><a href="#cb35-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-465"><a href="#cb35-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-466"><a href="#cb35-466" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, .<span class="dv">0001</span>),</span>
<span id="cb35-467"><a href="#cb35-467" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb35-468"><a href="#cb35-468" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-469"><a href="#cb35-469" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>()</span>
<span id="cb35-470"><a href="#cb35-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-471"><a href="#cb35-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-472"><a href="#cb35-472" aria-hidden="true" tabindex="-1"></a>It turns out that this is the interval also used in the book example.</span>
<span id="cb35-473"><a href="#cb35-473" aria-hidden="true" tabindex="-1"></a>But in my visualization you can see some irregularity at the top,</span>
<span id="cb35-474"><a href="#cb35-474" aria-hidden="true" tabindex="-1"></a>because my grid has too coarse. It has only 51 values. Let's try a much</span>
<span id="cb35-475"><a href="#cb35-475" aria-hidden="true" tabindex="-1"></a>finer grid with 5001 values:</span>
<span id="cb35-476"><a href="#cb35-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-477"><a href="#cb35-477" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Optimal replication of Figure 13-1</span></span>
<span id="cb35-478"><a href="#cb35-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-481"><a href="#cb35-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-482"><a href="#cb35-482" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, .<span class="dv">00001</span>),</span>
<span id="cb35-483"><a href="#cb35-483" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb35-484"><a href="#cb35-484" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-485"><a href="#cb35-485" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>()</span>
<span id="cb35-486"><a href="#cb35-486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-487"><a href="#cb35-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-488"><a href="#cb35-488" aria-hidden="true" tabindex="-1"></a><span class="fu">### Replicate Figure 13-2</span></span>
<span id="cb35-489"><a href="#cb35-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-490"><a href="#cb35-490" aria-hidden="true" tabindex="-1"></a><span class="fu">#### First try (bad)</span></span>
<span id="cb35-491"><a href="#cb35-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-492"><a href="#cb35-492" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb35-493"><a href="#cb35-493" aria-hidden="true" tabindex="-1"></a>I had to learn about the difference between <span class="in">`annotate(geom = "text" …)`</span></span>
<span id="cb35-494"><a href="#cb35-494" aria-hidden="true" tabindex="-1"></a>and <span class="in">`annotate(geom = "label" …)`</span>. There are two big differences:</span>
<span id="cb35-495"><a href="#cb35-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-496"><a href="#cb35-496" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`geom_text()`</span> does not understand the <span class="in">`fill`</span> aesthetics, e.g. you</span>
<span id="cb35-497"><a href="#cb35-497" aria-hidden="true" tabindex="-1"></a>    can't change the background color of the text.</span>
<span id="cb35-498"><a href="#cb35-498" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`geom_label()`</span> "is considerable slower than geom_text()" and does</span>
<span id="cb35-499"><a href="#cb35-499" aria-hidden="true" tabindex="-1"></a>    not support the <span class="in">`check_overlap`</span> argument and the <span class="in">`angle`</span> aesthetic.</span>
<span id="cb35-500"><a href="#cb35-500" aria-hidden="true" tabindex="-1"></a>    But more important for my use case <span class="in">`geom_label()`</span> draws a rectangle</span>
<span id="cb35-501"><a href="#cb35-501" aria-hidden="true" tabindex="-1"></a>    around the label. You need to add <span class="in">`label.size = NA`</span> to remove the</span>
<span id="cb35-502"><a href="#cb35-502" aria-hidden="true" tabindex="-1"></a>    label. Although the option <span class="in">`label.size`</span> is documented ("Size of</span>
<span id="cb35-503"><a href="#cb35-503" aria-hidden="true" tabindex="-1"></a>    label border, in mm.") using <span class="in">`NA`</span> to remove the border completely is</span>
<span id="cb35-504"><a href="#cb35-504" aria-hidden="true" tabindex="-1"></a>    not explained. I had to find out it the hard way via</span>
<span id="cb35-505"><a href="#cb35-505" aria-hidden="true" tabindex="-1"></a>    <span class="co">[</span><span class="ot">StackOverflow</span><span class="co">](https://stackoverflow.com/a/58242703/7322615)</span>.</span>
<span id="cb35-506"><a href="#cb35-506" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-507"><a href="#cb35-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-510"><a href="#cb35-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-511"><a href="#cb35-511" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-2a</span></span>
<span id="cb35-512"><a href="#cb35-512" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualizing the cumulative area under the curve"</span></span>
<span id="cb35-513"><a href="#cb35-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-2a lst-cap="Highlighting the cumulative area under the curve"'</span></span>
<span id="cb35-514"><a href="#cb35-514" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-515"><a href="#cb35-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-516"><a href="#cb35-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-517"><a href="#cb35-517" aria-hidden="true" tabindex="-1"></a>x_lower <span class="ot">&lt;-</span>  <span class="fu">seq</span>(<span class="fl">0.006</span>, <span class="fl">0.0085</span>, <span class="fl">0.0005</span>)</span>
<span id="cb35-518"><a href="#cb35-518" aria-hidden="true" tabindex="-1"></a>x_upper <span class="ot">&lt;-</span>  <span class="fu">seq</span>(<span class="fl">0.0065</span>, <span class="fl">0.009</span>, <span class="fl">0.0005</span>)</span>
<span id="cb35-519"><a href="#cb35-519" aria-hidden="true" tabindex="-1"></a>text_pos <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.00625</span>, <span class="fl">0.00875</span>, <span class="fl">0.0005</span>)</span>
<span id="cb35-520"><a href="#cb35-520" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gray90"</span>, <span class="st">"gray80"</span>, <span class="st">"gray70"</span>, <span class="st">"gray50"</span>, <span class="st">"gray40"</span>, <span class="st">"black"</span>) </span>
<span id="cb35-521"><a href="#cb35-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-522"><a href="#cb35-522" aria-hidden="true" tabindex="-1"></a>df_13_2 <span class="ot">&lt;-</span> </span>
<span id="cb35-523"><a href="#cb35-523" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.006</span>, <span class="fl">0.009</span>, <span class="at">length.out =</span> <span class="dv">6000</span>),</span>
<span id="cb35-524"><a href="#cb35-524" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>))</span>
<span id="cb35-525"><a href="#cb35-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-526"><a href="#cb35-526" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_2, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-527"><a href="#cb35-527" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-528"><a href="#cb35-528" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_13_2 <span class="sc">|&gt;</span></span>
<span id="cb35-529"><a href="#cb35-529" aria-hidden="true" tabindex="-1"></a>                           dplyr<span class="sc">::</span><span class="fu">filter</span>(x <span class="sc">&gt;=</span> x_lower[<span class="dv">1</span>] <span class="sc">&amp;</span> x <span class="sc">&lt;</span>  x_upper[<span class="dv">1</span>]),</span>
<span id="cb35-530"><a href="#cb35-530" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> colors[<span class="dv">1</span>]</span>
<span id="cb35-531"><a href="#cb35-531" aria-hidden="true" tabindex="-1"></a>                           ) <span class="sc">+</span></span>
<span id="cb35-532"><a href="#cb35-532" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> text_pos[<span class="dv">1</span>], </span>
<span id="cb35-533"><a href="#cb35-533" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">125</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">label.size =</span> <span class="cn">NA</span>,</span>
<span id="cb35-534"><a href="#cb35-534" aria-hidden="true" tabindex="-1"></a>                          <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">integrate</span>(<span class="cf">function</span>(x) </span>
<span id="cb35-535"><a href="#cb35-535" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>), x_lower[<span class="dv">1</span>], x_upper[<span class="dv">1</span>])[[<span class="st">"value"</span>]], <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb35-536"><a href="#cb35-536" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-537"><a href="#cb35-537" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_13_2 <span class="sc">|&gt;</span> </span>
<span id="cb35-538"><a href="#cb35-538" aria-hidden="true" tabindex="-1"></a>                           dplyr<span class="sc">::</span><span class="fu">filter</span>(x <span class="sc">&gt;=</span> x_lower[<span class="dv">2</span>] <span class="sc">&amp;</span> x <span class="sc">&lt;</span>  x_upper[<span class="dv">2</span>]),</span>
<span id="cb35-539"><a href="#cb35-539" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> colors[<span class="dv">2</span>]</span>
<span id="cb35-540"><a href="#cb35-540" aria-hidden="true" tabindex="-1"></a>                           ) <span class="sc">+</span></span>
<span id="cb35-541"><a href="#cb35-541" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> text_pos[<span class="dv">2</span>], <span class="at">size =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">125</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">label.size =</span> <span class="cn">NA</span>,</span>
<span id="cb35-542"><a href="#cb35-542" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">integrate</span>(<span class="cf">function</span>(x) </span>
<span id="cb35-543"><a href="#cb35-543" aria-hidden="true" tabindex="-1"></a>              <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>), x_lower[<span class="dv">1</span>], x_upper[<span class="dv">2</span>])[[<span class="st">"value"</span>]], <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb35-544"><a href="#cb35-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-545"><a href="#cb35-545" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_13_2 <span class="sc">|&gt;</span> </span>
<span id="cb35-546"><a href="#cb35-546" aria-hidden="true" tabindex="-1"></a>                           dplyr<span class="sc">::</span><span class="fu">filter</span>(x <span class="sc">&gt;=</span> x_lower[<span class="dv">3</span>] <span class="sc">&amp;</span> x <span class="sc">&lt;</span>  x_upper[<span class="dv">3</span>]),</span>
<span id="cb35-547"><a href="#cb35-547" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> colors[<span class="dv">3</span>]</span>
<span id="cb35-548"><a href="#cb35-548" aria-hidden="true" tabindex="-1"></a>                           ) <span class="sc">+</span></span>
<span id="cb35-549"><a href="#cb35-549" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> text_pos[<span class="dv">3</span>], <span class="at">size =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">125</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">label.size =</span> <span class="cn">NA</span>, </span>
<span id="cb35-550"><a href="#cb35-550" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">integrate</span>(<span class="cf">function</span>(x) </span>
<span id="cb35-551"><a href="#cb35-551" aria-hidden="true" tabindex="-1"></a>              <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>), x_lower[<span class="dv">1</span>], x_upper[<span class="dv">3</span>])[[<span class="st">"value"</span>]], <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb35-552"><a href="#cb35-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-553"><a href="#cb35-553" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_13_2 <span class="sc">|&gt;</span> </span>
<span id="cb35-554"><a href="#cb35-554" aria-hidden="true" tabindex="-1"></a>                           dplyr<span class="sc">::</span><span class="fu">filter</span>(x <span class="sc">&gt;=</span> x_lower[<span class="dv">4</span>] <span class="sc">&amp;</span> x <span class="sc">&lt;</span>  x_upper[<span class="dv">4</span>]),</span>
<span id="cb35-555"><a href="#cb35-555" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> colors[<span class="dv">4</span>]</span>
<span id="cb35-556"><a href="#cb35-556" aria-hidden="true" tabindex="-1"></a>                           ) <span class="sc">+</span></span>
<span id="cb35-557"><a href="#cb35-557" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> text_pos[<span class="dv">4</span>], <span class="at">size =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">125</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">label.size =</span> <span class="cn">NA</span>, </span>
<span id="cb35-558"><a href="#cb35-558" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">integrate</span>(<span class="cf">function</span>(x) </span>
<span id="cb35-559"><a href="#cb35-559" aria-hidden="true" tabindex="-1"></a>              <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>), x_lower[<span class="dv">1</span>], x_upper[<span class="dv">4</span>])[[<span class="st">"value"</span>]], <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb35-560"><a href="#cb35-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-561"><a href="#cb35-561" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_13_2 <span class="sc">|&gt;</span> </span>
<span id="cb35-562"><a href="#cb35-562" aria-hidden="true" tabindex="-1"></a>                           dplyr<span class="sc">::</span><span class="fu">filter</span>(x <span class="sc">&gt;=</span> x_lower[<span class="dv">5</span>] <span class="sc">&amp;</span> x <span class="sc">&lt;</span>  x_upper[<span class="dv">5</span>]),</span>
<span id="cb35-563"><a href="#cb35-563" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> colors[<span class="dv">5</span>]</span>
<span id="cb35-564"><a href="#cb35-564" aria-hidden="true" tabindex="-1"></a>                           ) <span class="sc">+</span></span>
<span id="cb35-565"><a href="#cb35-565" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> text_pos[<span class="dv">5</span>], <span class="at">size =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">125</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">label.size =</span> <span class="cn">NA</span>, </span>
<span id="cb35-566"><a href="#cb35-566" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">integrate</span>(<span class="cf">function</span>(x) </span>
<span id="cb35-567"><a href="#cb35-567" aria-hidden="true" tabindex="-1"></a>              <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>), x_lower[<span class="dv">1</span>], x_upper[<span class="dv">5</span>])[[<span class="st">"value"</span>]], <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb35-568"><a href="#cb35-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-569"><a href="#cb35-569" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df_13_2 <span class="sc">|&gt;</span> </span>
<span id="cb35-570"><a href="#cb35-570" aria-hidden="true" tabindex="-1"></a>                           dplyr<span class="sc">::</span><span class="fu">filter</span>(x <span class="sc">&gt;=</span> x_lower[<span class="dv">6</span>] <span class="sc">&amp;</span> x <span class="sc">&lt;</span>  x_upper[<span class="dv">6</span>]),</span>
<span id="cb35-571"><a href="#cb35-571" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> colors[<span class="dv">6</span>]</span>
<span id="cb35-572"><a href="#cb35-572" aria-hidden="true" tabindex="-1"></a>                           ) <span class="sc">+</span></span>
<span id="cb35-573"><a href="#cb35-573" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> text_pos[<span class="dv">6</span>], <span class="at">size =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">125</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">label.size =</span> <span class="cn">NA</span>, </span>
<span id="cb35-574"><a href="#cb35-574" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">integrate</span>(<span class="cf">function</span>(x) </span>
<span id="cb35-575"><a href="#cb35-575" aria-hidden="true" tabindex="-1"></a>              <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>), x_lower[<span class="dv">1</span>], x_upper[<span class="dv">6</span>])[[<span class="st">"value"</span>]], <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb35-576"><a href="#cb35-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-577"><a href="#cb35-577" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-578"><a href="#cb35-578" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-579"><a href="#cb35-579" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Visualizing the cumulative area under the curve"</span>,</span>
<span id="cb35-580"><a href="#cb35-580" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Probability of Subscription"</span>,</span>
<span id="cb35-581"><a href="#cb35-581" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb35-582"><a href="#cb35-582" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-583"><a href="#cb35-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-584"><a href="#cb35-584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-585"><a href="#cb35-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-586"><a href="#cb35-586" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Second try (Slightly better)</span></span>
<span id="cb35-587"><a href="#cb35-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-588"><a href="#cb35-588" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb35-589"><a href="#cb35-589" aria-hidden="true" tabindex="-1"></a>I am very unhappy about the many duplicates of @lst-fig-pb-13-2a. I</span>
<span id="cb35-590"><a href="#cb35-590" aria-hidden="true" tabindex="-1"></a>tried to use loops or vectorized commands but the best I found out is</span>
<span id="cb35-591"><a href="#cb35-591" aria-hidden="true" tabindex="-1"></a>@lst-fig-pb-13-2b with has still six duplicate code lines.</span>
<span id="cb35-592"><a href="#cb35-592" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-593"><a href="#cb35-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-596"><a href="#cb35-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-597"><a href="#cb35-597" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-2b</span></span>
<span id="cb35-598"><a href="#cb35-598" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualizing the cumulative area under the curve"</span></span>
<span id="cb35-599"><a href="#cb35-599" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-2b lst-cap="Highlighting the cumulative area under the curve"'</span></span>
<span id="cb35-600"><a href="#cb35-600" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-601"><a href="#cb35-601" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-602"><a href="#cb35-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-603"><a href="#cb35-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-604"><a href="#cb35-604" aria-hidden="true" tabindex="-1"></a>x_lower <span class="ot">&lt;-</span>  <span class="fu">seq</span>(<span class="fl">0.006</span>, <span class="fl">0.0085</span>, <span class="fl">0.0005</span>)</span>
<span id="cb35-605"><a href="#cb35-605" aria-hidden="true" tabindex="-1"></a>x_upper <span class="ot">&lt;-</span>  <span class="fu">seq</span>(<span class="fl">0.0065</span>, <span class="fl">0.009</span>, <span class="fl">0.0005</span>)</span>
<span id="cb35-606"><a href="#cb35-606" aria-hidden="true" tabindex="-1"></a>label_x_pos <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.00625</span>, <span class="fl">0.00875</span>, <span class="fl">0.0005</span>)</span>
<span id="cb35-607"><a href="#cb35-607" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gray90"</span>, <span class="st">"gray80"</span>, <span class="st">"gray70"</span>, <span class="st">"gray50"</span>, <span class="st">"gray40"</span>, <span class="st">"black"</span>) </span>
<span id="cb35-608"><a href="#cb35-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-609"><a href="#cb35-609" aria-hidden="true" tabindex="-1"></a>cum_rate <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb35-610"><a href="#cb35-610" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb35-611"><a href="#cb35-611" aria-hidden="true" tabindex="-1"></a>    cum_rate[i] <span class="ot">&lt;-</span> </span>
<span id="cb35-612"><a href="#cb35-612" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">integrate</span>(<span class="cf">function</span>(x) </span>
<span id="cb35-613"><a href="#cb35-613" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>), x_lower[<span class="dv">1</span>], x_upper[i])[[<span class="st">"value"</span>]], <span class="dv">3</span>) </span>
<span id="cb35-614"><a href="#cb35-614" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-615"><a href="#cb35-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-616"><a href="#cb35-616" aria-hidden="true" tabindex="-1"></a>add_label <span class="ot">&lt;-</span> <span class="cf">function</span>(x_pos, txt) {</span>
<span id="cb35-617"><a href="#cb35-617" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">annotate</span>(</span>
<span id="cb35-618"><a href="#cb35-618" aria-hidden="true" tabindex="-1"></a>        <span class="at">geom =</span> <span class="st">"label"</span>,</span>
<span id="cb35-619"><a href="#cb35-619" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> x_pos,</span>
<span id="cb35-620"><a href="#cb35-620" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="dv">125</span>,</span>
<span id="cb35-621"><a href="#cb35-621" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb35-622"><a href="#cb35-622" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> txt,</span>
<span id="cb35-623"><a href="#cb35-623" aria-hidden="true" tabindex="-1"></a>        <span class="at">label.size =</span> <span class="cn">NA</span></span>
<span id="cb35-624"><a href="#cb35-624" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-625"><a href="#cb35-625" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-626"><a href="#cb35-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-627"><a href="#cb35-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-628"><a href="#cb35-628" aria-hidden="true" tabindex="-1"></a>highlight_one_area <span class="ot">&lt;-</span> <span class="cf">function</span>(df, i) {</span>
<span id="cb35-629"><a href="#cb35-629" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df <span class="sc">|&gt;</span></span>
<span id="cb35-630"><a href="#cb35-630" aria-hidden="true" tabindex="-1"></a>                       dplyr<span class="sc">::</span><span class="fu">filter</span>(x <span class="sc">&gt;=</span> x_lower[i] <span class="sc">&amp;</span> x <span class="sc">&lt;</span>  x_upper[i]),</span>
<span id="cb35-631"><a href="#cb35-631" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> colors[i])</span>
<span id="cb35-632"><a href="#cb35-632" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-633"><a href="#cb35-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-634"><a href="#cb35-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-635"><a href="#cb35-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-636"><a href="#cb35-636" aria-hidden="true" tabindex="-1"></a>df_13_2 <span class="ot">&lt;-</span> </span>
<span id="cb35-637"><a href="#cb35-637" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.006</span>, <span class="fl">0.009</span>, <span class="at">length.out =</span> <span class="dv">6000</span>),</span>
<span id="cb35-638"><a href="#cb35-638" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-639"><a href="#cb35-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-640"><a href="#cb35-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-641"><a href="#cb35-641" aria-hidden="true" tabindex="-1"></a>p_13_2 <span class="ot">&lt;-</span> </span>
<span id="cb35-642"><a href="#cb35-642" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_2, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-643"><a href="#cb35-643" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-644"><a href="#cb35-644" aria-hidden="true" tabindex="-1"></a>    <span class="fu">highlight_one_area</span>(df_13_2, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb35-645"><a href="#cb35-645" aria-hidden="true" tabindex="-1"></a>    <span class="fu">highlight_one_area</span>(df_13_2, <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb35-646"><a href="#cb35-646" aria-hidden="true" tabindex="-1"></a>    <span class="fu">highlight_one_area</span>(df_13_2, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb35-647"><a href="#cb35-647" aria-hidden="true" tabindex="-1"></a>    <span class="fu">highlight_one_area</span>(df_13_2, <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb35-648"><a href="#cb35-648" aria-hidden="true" tabindex="-1"></a>    <span class="fu">highlight_one_area</span>(df_13_2, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb35-649"><a href="#cb35-649" aria-hidden="true" tabindex="-1"></a>    <span class="fu">highlight_one_area</span>(df_13_2, <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb35-650"><a href="#cb35-650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_label</span>(label_x_pos, cum_rate) <span class="sc">+</span></span>
<span id="cb35-651"><a href="#cb35-651" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-652"><a href="#cb35-652" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-653"><a href="#cb35-653" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Visualizing the cumulative area under the curve"</span>,</span>
<span id="cb35-654"><a href="#cb35-654" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Probability of Subscription"</span>,</span>
<span id="cb35-655"><a href="#cb35-655" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb35-656"><a href="#cb35-656" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-657"><a href="#cb35-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-658"><a href="#cb35-658" aria-hidden="true" tabindex="-1"></a>p_13_2</span>
<span id="cb35-659"><a href="#cb35-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-660"><a href="#cb35-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-661"><a href="#cb35-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-662"><a href="#cb35-662" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Third try (My best version)</span></span>
<span id="cb35-663"><a href="#cb35-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-664"><a href="#cb35-664" aria-hidden="true" tabindex="-1"></a>As I could not find a better solution for @lst-fig-pb-13-2b myself I</span>
<span id="cb35-665"><a href="#cb35-665" aria-hidden="true" tabindex="-1"></a>posted my question in</span>
<span id="cb35-666"><a href="#cb35-666" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">StackOverflow</span><span class="co">](https://stackoverflow.com/questions/77182234/ggplot2-shade-several-areas-under-the-curve-using-a-loop)</span></span>
<span id="cb35-667"><a href="#cb35-667" aria-hidden="true" tabindex="-1"></a>and got an answer with two different options within one hour!</span>
<span id="cb35-668"><a href="#cb35-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-669"><a href="#cb35-669" aria-hidden="true" tabindex="-1"></a>The first solution is to use <span class="in">`lapply()`</span>. I should have known that as I</span>
<span id="cb35-670"><a href="#cb35-670" aria-hidden="true" tabindex="-1"></a>came over a similar</span>
<span id="cb35-671"><a href="#cb35-671" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">solution</span><span class="co">](https://stackoverflow.com/a/18089991/7322615)</span>. The second</span>
<span id="cb35-672"><a href="#cb35-672" aria-hidden="true" tabindex="-1"></a>solution is for me more complex and I have still to study it thoroughly</span>
<span id="cb35-673"><a href="#cb35-673" aria-hidden="true" tabindex="-1"></a>to understand it.</span>
<span id="cb35-674"><a href="#cb35-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-675"><a href="#cb35-675" aria-hidden="true" tabindex="-1"></a>What follows in @lst-fig-pb-13-2c is the modern take of <span class="in">`lapply()`</span> using</span>
<span id="cb35-676"><a href="#cb35-676" aria-hidden="true" tabindex="-1"></a>the <span class="in">`purrr::map()`</span> function. (I do not understand why I had to use</span>
<span id="cb35-677"><a href="#cb35-677" aria-hidden="true" tabindex="-1"></a>exactly the argument "df" and asked via SO comment.)</span>
<span id="cb35-678"><a href="#cb35-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-681"><a href="#cb35-681" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-682"><a href="#cb35-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-2c</span></span>
<span id="cb35-683"><a href="#cb35-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualizing the cumulative area under the curve"</span></span>
<span id="cb35-684"><a href="#cb35-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-2c lst-cap="Highlighting the cumulative area under the curve"'</span></span>
<span id="cb35-685"><a href="#cb35-685" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-686"><a href="#cb35-686" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-687"><a href="#cb35-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-688"><a href="#cb35-688" aria-hidden="true" tabindex="-1"></a><span class="do">########### Vectors ##############</span></span>
<span id="cb35-689"><a href="#cb35-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-690"><a href="#cb35-690" aria-hidden="true" tabindex="-1"></a>x_lower <span class="ot">&lt;-</span>  <span class="fu">seq</span>(<span class="fl">0.006</span>, <span class="fl">0.0085</span>, <span class="fl">0.0005</span>)</span>
<span id="cb35-691"><a href="#cb35-691" aria-hidden="true" tabindex="-1"></a>x_upper <span class="ot">&lt;-</span>  <span class="fu">seq</span>(<span class="fl">0.0065</span>, <span class="fl">0.009</span>, <span class="fl">0.0005</span>)</span>
<span id="cb35-692"><a href="#cb35-692" aria-hidden="true" tabindex="-1"></a>label_x_pos <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.00625</span>, <span class="fl">0.00875</span>, <span class="fl">0.0005</span>)</span>
<span id="cb35-693"><a href="#cb35-693" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gray90"</span>, <span class="st">"gray80"</span>, <span class="st">"gray70"</span>, <span class="st">"gray50"</span>, <span class="st">"gray40"</span>, <span class="st">"black"</span>) </span>
<span id="cb35-694"><a href="#cb35-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-695"><a href="#cb35-695" aria-hidden="true" tabindex="-1"></a><span class="do">########### Functions ############</span></span>
<span id="cb35-696"><a href="#cb35-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-697"><a href="#cb35-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-698"><a href="#cb35-698" aria-hidden="true" tabindex="-1"></a>cum_rate <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb35-699"><a href="#cb35-699" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb35-700"><a href="#cb35-700" aria-hidden="true" tabindex="-1"></a>    cum_rate[i] <span class="ot">&lt;-</span> </span>
<span id="cb35-701"><a href="#cb35-701" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">integrate</span>(<span class="cf">function</span>(x) </span>
<span id="cb35-702"><a href="#cb35-702" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>), x_lower[<span class="dv">1</span>], x_upper[i])[[<span class="st">"value"</span>]], <span class="dv">3</span>) </span>
<span id="cb35-703"><a href="#cb35-703" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-704"><a href="#cb35-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-705"><a href="#cb35-705" aria-hidden="true" tabindex="-1"></a>add_label <span class="ot">&lt;-</span> <span class="cf">function</span>(x_pos, txt) {</span>
<span id="cb35-706"><a href="#cb35-706" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">annotate</span>(</span>
<span id="cb35-707"><a href="#cb35-707" aria-hidden="true" tabindex="-1"></a>        <span class="at">geom =</span> <span class="st">"label"</span>,</span>
<span id="cb35-708"><a href="#cb35-708" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> x_pos,</span>
<span id="cb35-709"><a href="#cb35-709" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="dv">125</span>,</span>
<span id="cb35-710"><a href="#cb35-710" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb35-711"><a href="#cb35-711" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> txt,</span>
<span id="cb35-712"><a href="#cb35-712" aria-hidden="true" tabindex="-1"></a>        <span class="at">label.size =</span> <span class="cn">NA</span></span>
<span id="cb35-713"><a href="#cb35-713" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-714"><a href="#cb35-714" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-715"><a href="#cb35-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-716"><a href="#cb35-716" aria-hidden="true" tabindex="-1"></a>highlight_areas <span class="ot">&lt;-</span> <span class="cf">function</span>(df, i) {</span>
<span id="cb35-717"><a href="#cb35-717" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_area</span>(<span class="at">data =</span> df <span class="sc">|&gt;</span></span>
<span id="cb35-718"><a href="#cb35-718" aria-hidden="true" tabindex="-1"></a>                       dplyr<span class="sc">::</span><span class="fu">filter</span>(x <span class="sc">&gt;=</span> x_lower[i] <span class="sc">&amp;</span> x <span class="sc">&lt;</span>  x_upper[i]),</span>
<span id="cb35-719"><a href="#cb35-719" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> colors[i])</span>
<span id="cb35-720"><a href="#cb35-720" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-721"><a href="#cb35-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-722"><a href="#cb35-722" aria-hidden="true" tabindex="-1"></a><span class="do">######### Graph plotting ############</span></span>
<span id="cb35-723"><a href="#cb35-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-724"><a href="#cb35-724" aria-hidden="true" tabindex="-1"></a>df_13_2 <span class="ot">&lt;-</span> </span>
<span id="cb35-725"><a href="#cb35-725" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.006</span>, <span class="fl">0.009</span>, <span class="at">length.out =</span> <span class="dv">6000</span>),</span>
<span id="cb35-726"><a href="#cb35-726" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">dbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-727"><a href="#cb35-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-728"><a href="#cb35-728" aria-hidden="true" tabindex="-1"></a>p_13_2 <span class="ot">&lt;-</span> </span>
<span id="cb35-729"><a href="#cb35-729" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_2, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-730"><a href="#cb35-730" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-731"><a href="#cb35-731" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, highlight_areas, <span class="at">df =</span> df_13_2) <span class="sc">+</span></span>
<span id="cb35-732"><a href="#cb35-732" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_label</span>(label_x_pos, cum_rate) <span class="sc">+</span></span>
<span id="cb35-733"><a href="#cb35-733" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-734"><a href="#cb35-734" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-735"><a href="#cb35-735" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Visualizing the cumulative area under the curve"</span>,</span>
<span id="cb35-736"><a href="#cb35-736" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Probability of Subscription"</span>,</span>
<span id="cb35-737"><a href="#cb35-737" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb35-738"><a href="#cb35-738" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-739"><a href="#cb35-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-740"><a href="#cb35-740" aria-hidden="true" tabindex="-1"></a>p_13_2</span>
<span id="cb35-741"><a href="#cb35-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-742"><a href="#cb35-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-743"><a href="#cb35-743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-744"><a href="#cb35-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-745"><a href="#cb35-745" aria-hidden="true" tabindex="-1"></a><span class="fu">### Replicate Figure 13-3</span></span>
<span id="cb35-746"><a href="#cb35-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-749"><a href="#cb35-749" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-750"><a href="#cb35-750" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-3</span></span>
<span id="cb35-751"><a href="#cb35-751" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plotting just the cumulative probability from Figure 13-2"</span></span>
<span id="cb35-752"><a href="#cb35-752" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-3 lst-cap="Plot the cumulative area under the curve"'</span></span>
<span id="cb35-753"><a href="#cb35-753" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-754"><a href="#cb35-754" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-755"><a href="#cb35-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-756"><a href="#cb35-756" aria-hidden="true" tabindex="-1"></a>df_13_3 <span class="ot">&lt;-</span> </span>
<span id="cb35-757"><a href="#cb35-757" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.006</span>, <span class="fl">0.009</span>, <span class="fl">0.0005</span>),</span>
<span id="cb35-758"><a href="#cb35-758" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">pbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-759"><a href="#cb35-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-760"><a href="#cb35-760" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_3, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-761"><a href="#cb35-761" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-762"><a href="#cb35-762" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-763"><a href="#cb35-763" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-764"><a href="#cb35-764" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"The cumulative distribution function"</span>,</span>
<span id="cb35-765"><a href="#cb35-765" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Subscription rate"</span>,</span>
<span id="cb35-766"><a href="#cb35-766" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb35-767"><a href="#cb35-767" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-768"><a href="#cb35-768" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-769"><a href="#cb35-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-770"><a href="#cb35-770" aria-hidden="true" tabindex="-1"></a><span class="fu">### Replicate Figure 13-4</span></span>
<span id="cb35-771"><a href="#cb35-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-772"><a href="#cb35-772" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Cumulative Distribution Function (CDF)</span></span>
<span id="cb35-773"><a href="#cb35-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-776"><a href="#cb35-776" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-777"><a href="#cb35-777" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-4a</span></span>
<span id="cb35-778"><a href="#cb35-778" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The CDF for our problem"</span></span>
<span id="cb35-779"><a href="#cb35-779" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-4a lst-cap="Plot the Cumulative Distribution Function (CDF)"'</span></span>
<span id="cb35-780"><a href="#cb35-780" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-781"><a href="#cb35-781" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-782"><a href="#cb35-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-783"><a href="#cb35-783" aria-hidden="true" tabindex="-1"></a>df_13_4a <span class="ot">&lt;-</span> </span>
<span id="cb35-784"><a href="#cb35-784" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span>),</span>
<span id="cb35-785"><a href="#cb35-785" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">pbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-786"><a href="#cb35-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-787"><a href="#cb35-787" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_4a, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-788"><a href="#cb35-788" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-789"><a href="#cb35-789" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-790"><a href="#cb35-790" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-791"><a href="#cb35-791" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"The cumulative distribution function"</span>,</span>
<span id="cb35-792"><a href="#cb35-792" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Subscription rate"</span>,</span>
<span id="cb35-793"><a href="#cb35-793" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb35-794"><a href="#cb35-794" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-795"><a href="#cb35-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-796"><a href="#cb35-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-797"><a href="#cb35-797" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Empiricial Cumulative Distribution Function (ECDF) - with steps</span></span>
<span id="cb35-798"><a href="#cb35-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-799"><a href="#cb35-799" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb35-800"><a href="#cb35-800" aria-hidden="true" tabindex="-1"></a>Trying to apply the CDF I noticed that there is also an **ECDF\(Empirical Cumulative Distribution Function)** (GLOSSARY). The</span>
<span id="cb35-801"><a href="#cb35-801" aria-hidden="true" tabindex="-1"></a>differences are that the ECDF is a step function whereas the CDF is</span>
<span id="cb35-802"><a href="#cb35-802" aria-hidden="true" tabindex="-1"></a>smooth. But with many different values the ECDF approximates to ta</span>
<span id="cb35-803"><a href="#cb35-803" aria-hidden="true" tabindex="-1"></a>smooth function.</span>
<span id="cb35-804"><a href="#cb35-804" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-805"><a href="#cb35-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-808"><a href="#cb35-808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-809"><a href="#cb35-809" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-4b</span></span>
<span id="cb35-810"><a href="#cb35-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The ECDF for our problem"</span></span>
<span id="cb35-811"><a href="#cb35-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-4b lst-cap="Plot the Empirical Cumulative Distribution Function (ECDF)"'</span></span>
<span id="cb35-812"><a href="#cb35-812" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-813"><a href="#cb35-813" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-814"><a href="#cb35-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-815"><a href="#cb35-815" aria-hidden="true" tabindex="-1"></a>df_13_4b <span class="ot">&lt;-</span> </span>
<span id="cb35-816"><a href="#cb35-816" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-4</span>),</span>
<span id="cb35-817"><a href="#cb35-817" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">rbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-818"><a href="#cb35-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-819"><a href="#cb35-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-820"><a href="#cb35-820" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_4b, ggplot2<span class="sc">::</span><span class="fu">aes</span>(y)) <span class="sc">+</span></span>
<span id="cb35-821"><a href="#cb35-821" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">"step"</span>) <span class="sc">+</span></span>
<span id="cb35-822"><a href="#cb35-822" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-823"><a href="#cb35-823" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-824"><a href="#cb35-824" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"The empirical cumulative distribution function (ECDF)"</span>,</span>
<span id="cb35-825"><a href="#cb35-825" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb35-826"><a href="#cb35-826" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"ECDF"</span></span>
<span id="cb35-827"><a href="#cb35-827" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-828"><a href="#cb35-828" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-829"><a href="#cb35-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-830"><a href="#cb35-830" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Empiricial Cumulative Distribution Function (ECDF) - with points</span></span>
<span id="cb35-831"><a href="#cb35-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-834"><a href="#cb35-834" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-835"><a href="#cb35-835" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-4c</span></span>
<span id="cb35-836"><a href="#cb35-836" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The ECDF for our problem"</span></span>
<span id="cb35-837"><a href="#cb35-837" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-4c lst-cap="Plot the Cumulative Distribution Function (CDF)"'</span></span>
<span id="cb35-838"><a href="#cb35-838" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-839"><a href="#cb35-839" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-840"><a href="#cb35-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-841"><a href="#cb35-841" aria-hidden="true" tabindex="-1"></a>df_13_4c <span class="ot">&lt;-</span> </span>
<span id="cb35-842"><a href="#cb35-842" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-4</span>),</span>
<span id="cb35-843"><a href="#cb35-843" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">rbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-844"><a href="#cb35-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-845"><a href="#cb35-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-846"><a href="#cb35-846" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_4c, ggplot2<span class="sc">::</span><span class="fu">aes</span>(y)) <span class="sc">+</span></span>
<span id="cb35-847"><a href="#cb35-847" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb35-848"><a href="#cb35-848" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-849"><a href="#cb35-849" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-850"><a href="#cb35-850" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"The empirical cumulative distribution function (ECDF)"</span>,</span>
<span id="cb35-851"><a href="#cb35-851" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb35-852"><a href="#cb35-852" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"ECDF"</span></span>
<span id="cb35-853"><a href="#cb35-853" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-854"><a href="#cb35-854" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-855"><a href="#cb35-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-856"><a href="#cb35-856" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Empiricial Cumulative Distribution Function (ECDF) - smooth</span></span>
<span id="cb35-857"><a href="#cb35-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-860"><a href="#cb35-860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-861"><a href="#cb35-861" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-4d</span></span>
<span id="cb35-862"><a href="#cb35-862" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The ECDF for our problem"</span></span>
<span id="cb35-863"><a href="#cb35-863" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-4d lst-cap="Plot the Empirical Cumulative Distribution Function (ECDF)"'</span></span>
<span id="cb35-864"><a href="#cb35-864" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-865"><a href="#cb35-865" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-866"><a href="#cb35-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-867"><a href="#cb35-867" aria-hidden="true" tabindex="-1"></a>df_13_4d <span class="ot">&lt;-</span> </span>
<span id="cb35-868"><a href="#cb35-868" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span>),</span>
<span id="cb35-869"><a href="#cb35-869" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">rbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-870"><a href="#cb35-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-871"><a href="#cb35-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-872"><a href="#cb35-872" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_4d, ggplot2<span class="sc">::</span><span class="fu">aes</span>(y)) <span class="sc">+</span></span>
<span id="cb35-873"><a href="#cb35-873" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">"step"</span>) <span class="sc">+</span></span>
<span id="cb35-874"><a href="#cb35-874" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-875"><a href="#cb35-875" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-876"><a href="#cb35-876" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"The empirical cumulative distribution function (ECDF)"</span>,</span>
<span id="cb35-877"><a href="#cb35-877" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb35-878"><a href="#cb35-878" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"ECDF"</span></span>
<span id="cb35-879"><a href="#cb35-879" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-880"><a href="#cb35-880" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-881"><a href="#cb35-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-882"><a href="#cb35-882" aria-hidden="true" tabindex="-1"></a><span class="fu">### Replicate Figure 13-5 {#sec-replicate-figure-13-5}</span></span>
<span id="cb35-883"><a href="#cb35-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-886"><a href="#cb35-886" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-887"><a href="#cb35-887" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-5</span></span>
<span id="cb35-888"><a href="#cb35-888" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Estimating the median visually using the CDF"</span></span>
<span id="cb35-889"><a href="#cb35-889" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-15 lst-cap="Estimate and display median using the CDF"'</span></span>
<span id="cb35-890"><a href="#cb35-890" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-891"><a href="#cb35-891" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-892"><a href="#cb35-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-893"><a href="#cb35-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-894"><a href="#cb35-894" aria-hidden="true" tabindex="-1"></a>median_beta <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">qbeta</span>(<span class="fl">0.5</span>, <span class="dv">300</span>, <span class="dv">39700</span>), <span class="dv">5</span>)</span>
<span id="cb35-895"><a href="#cb35-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-896"><a href="#cb35-896" aria-hidden="true" tabindex="-1"></a>df_13_5 <span class="ot">&lt;-</span> </span>
<span id="cb35-897"><a href="#cb35-897" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span>),</span>
<span id="cb35-898"><a href="#cb35-898" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">pbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-899"><a href="#cb35-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-900"><a href="#cb35-900" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_5, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-901"><a href="#cb35-901" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-902"><a href="#cb35-902" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.005</span>, <span class="at">y =</span> <span class="fl">0.50</span>, </span>
<span id="cb35-903"><a href="#cb35-903" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xend =</span> median_beta, <span class="at">yend =</span> <span class="fl">0.50</span>),</span>
<span id="cb35-904"><a href="#cb35-904" aria-hidden="true" tabindex="-1"></a>                          <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-905"><a href="#cb35-905" aria-hidden="true" tabindex="-1"></a>                          <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-906"><a href="#cb35-906" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> median_beta, <span class="at">y =</span> <span class="fl">0.50</span>, </span>
<span id="cb35-907"><a href="#cb35-907" aria-hidden="true" tabindex="-1"></a>                      <span class="at">xend =</span> median_beta, <span class="at">yend =</span> <span class="fl">0.00</span>),</span>
<span id="cb35-908"><a href="#cb35-908" aria-hidden="true" tabindex="-1"></a>                      <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-909"><a href="#cb35-909" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-910"><a href="#cb35-910" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">y =</span> <span class="fl">0.625</span>, <span class="at">x =</span> <span class="fl">0.0087</span>,</span>
<span id="cb35-911"><a href="#cb35-911" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> <span class="st">"median = qbeta(0.5, 300, 39700)"</span>) <span class="sc">+</span></span>
<span id="cb35-912"><a href="#cb35-912" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">y =</span> <span class="fl">0.55</span>, <span class="at">x =</span> <span class="fl">0.0087</span>,</span>
<span id="cb35-913"><a href="#cb35-913" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"= {median_beta}"</span>)) <span class="sc">+</span></span>
<span id="cb35-914"><a href="#cb35-914" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-915"><a href="#cb35-915" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-916"><a href="#cb35-916" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Estimating median"</span>,</span>
<span id="cb35-917"><a href="#cb35-917" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Probability of subscription"</span>,</span>
<span id="cb35-918"><a href="#cb35-918" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb35-919"><a href="#cb35-919" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-920"><a href="#cb35-920" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-921"><a href="#cb35-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-922"><a href="#cb35-922" aria-hidden="true" tabindex="-1"></a><span class="fu">### Replicate Figure 13-6 {#sec-replicate-figure-13-6}</span></span>
<span id="cb35-923"><a href="#cb35-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-924"><a href="#cb35-924" aria-hidden="true" tabindex="-1"></a>In contrast to @fig-pb-13-5 where I cheated by calculating the median of</span>
<span id="cb35-925"><a href="#cb35-925" aria-hidden="true" tabindex="-1"></a>the beta distribution I will in @sec-replicate-figure-13-6 try to approximate the</span>
<span id="cb35-926"><a href="#cb35-926" aria-hidden="true" tabindex="-1"></a>integration just visually.</span>
<span id="cb35-927"><a href="#cb35-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-928"><a href="#cb35-928" aria-hidden="true" tabindex="-1"></a>We are going to estimate the range between p(x <span class="sc">\&gt;</span> 0.0075 and x <span class="sc">\&lt;</span></span>
<span id="cb35-929"><a href="#cb35-929" aria-hidden="true" tabindex="-1"></a>0.0085). The solution could be visually done approximately either with a</span>
<span id="cb35-930"><a href="#cb35-930" aria-hidden="true" tabindex="-1"></a>ruler or (not so exact) just by eyeballing. To do it programmatically</span>
<span id="cb35-931"><a href="#cb35-931" aria-hidden="true" tabindex="-1"></a>without integration is a somewhat complex procedure with four steps:</span>
<span id="cb35-932"><a href="#cb35-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-933"><a href="#cb35-933" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>First I have to draw vertical lines from the start and end of the</span>
<span id="cb35-934"><a href="#cb35-934" aria-hidden="true" tabindex="-1"></a>    interesting range. These lines have to cross the CDF because I do</span>
<span id="cb35-935"><a href="#cb35-935" aria-hidden="true" tabindex="-1"></a>    not know the value of the cumulative probability where they meet the</span>
<span id="cb35-936"><a href="#cb35-936" aria-hidden="true" tabindex="-1"></a>    CDF.</span>
<span id="cb35-937"><a href="#cb35-937" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Then I have to inspect the intersection visually and try to estimate</span>
<span id="cb35-938"><a href="#cb35-938" aria-hidden="true" tabindex="-1"></a>    and draw the horizontal lines. This has to be done several times</span>
<span id="cb35-939"><a href="#cb35-939" aria-hidden="true" tabindex="-1"></a>    until the two lines cross (almost) exactly at the CDF.</span>
<span id="cb35-940"><a href="#cb35-940" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Now I can limit the vertical and horizontal lines, so that they stop</span>
<span id="cb35-941"><a href="#cb35-941" aria-hidden="true" tabindex="-1"></a>    at the CDF.</span>
<span id="cb35-942"><a href="#cb35-942" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>The last step is to estimate the range by reading the intersection</span>
<span id="cb35-943"><a href="#cb35-943" aria-hidden="true" tabindex="-1"></a>    at the y-axis.</span>
<span id="cb35-944"><a href="#cb35-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-945"><a href="#cb35-945" aria-hidden="true" tabindex="-1"></a><span class="fu">#### First step</span></span>
<span id="cb35-946"><a href="#cb35-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-949"><a href="#cb35-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-950"><a href="#cb35-950" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-6a</span></span>
<span id="cb35-951"><a href="#cb35-951" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visually performing integration using the CDF: First step"</span></span>
<span id="cb35-952"><a href="#cb35-952" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-6a lst-cap="Approximate the integration of a range of the CDF: First step"'</span></span>
<span id="cb35-953"><a href="#cb35-953" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-954"><a href="#cb35-954" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-955"><a href="#cb35-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-956"><a href="#cb35-956" aria-hidden="true" tabindex="-1"></a>df_13_6 <span class="ot">&lt;-</span> </span>
<span id="cb35-957"><a href="#cb35-957" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span>),</span>
<span id="cb35-958"><a href="#cb35-958" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">pbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-959"><a href="#cb35-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-960"><a href="#cb35-960" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_6, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-961"><a href="#cb35-961" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-962"><a href="#cb35-962" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.0075</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-963"><a href="#cb35-963" aria-hidden="true" tabindex="-1"></a>                        <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb35-964"><a href="#cb35-964" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.0085</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-965"><a href="#cb35-965" aria-hidden="true" tabindex="-1"></a>                        <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb35-966"><a href="#cb35-966" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-967"><a href="#cb35-967" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-968"><a href="#cb35-968" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Estimating P(x &gt; 0.0075 and x &lt; 0.0085)"</span>,</span>
<span id="cb35-969"><a href="#cb35-969" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Probability of subscription"</span>,</span>
<span id="cb35-970"><a href="#cb35-970" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb35-971"><a href="#cb35-971" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-972"><a href="#cb35-972" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-973"><a href="#cb35-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-974"><a href="#cb35-974" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Second step</span></span>
<span id="cb35-975"><a href="#cb35-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-976"><a href="#cb35-976" aria-hidden="true" tabindex="-1"></a>The lower cumulative probability is almost exact 0.5 as I can see and</span>
<span id="cb35-977"><a href="#cb35-977" aria-hidden="true" tabindex="-1"></a>already know from @fig-pb-13-5. Without knowing the solution in the book</span>
<span id="cb35-978"><a href="#cb35-978" aria-hidden="true" tabindex="-1"></a>my first approach was to draw a line at 0.98% of the CDF (orange). As</span>
<span id="cb35-979"><a href="#cb35-979" aria-hidden="true" tabindex="-1"></a>this seems a little to less a tried with it .99%</span>
<span id="cb35-980"><a href="#cb35-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-983"><a href="#cb35-983" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-984"><a href="#cb35-984" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-6b</span></span>
<span id="cb35-985"><a href="#cb35-985" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visually performing integration using the CDF: Second step"</span></span>
<span id="cb35-986"><a href="#cb35-986" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-6b lst-cap="Approximate the integration of a range of the CDF: Second step"'</span></span>
<span id="cb35-987"><a href="#cb35-987" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-988"><a href="#cb35-988" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-989"><a href="#cb35-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-990"><a href="#cb35-990" aria-hidden="true" tabindex="-1"></a>df_13_6 <span class="ot">&lt;-</span> </span>
<span id="cb35-991"><a href="#cb35-991" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span>),</span>
<span id="cb35-992"><a href="#cb35-992" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">pbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-993"><a href="#cb35-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-994"><a href="#cb35-994" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_6, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-995"><a href="#cb35-995" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-996"><a href="#cb35-996" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.0075</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-997"><a href="#cb35-997" aria-hidden="true" tabindex="-1"></a>                        <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb35-998"><a href="#cb35-998" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.0085</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-999"><a href="#cb35-999" aria-hidden="true" tabindex="-1"></a>                        <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb35-1000"><a href="#cb35-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1001"><a href="#cb35-1001" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1002"><a href="#cb35-1002" aria-hidden="true" tabindex="-1"></a>                    <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb35-1003"><a href="#cb35-1003" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.98</span>, <span class="at">color =</span> <span class="st">"orange"</span>,</span>
<span id="cb35-1004"><a href="#cb35-1004" aria-hidden="true" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb35-1005"><a href="#cb35-1005" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.99</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1006"><a href="#cb35-1006" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb35-1007"><a href="#cb35-1007" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-1008"><a href="#cb35-1008" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-1009"><a href="#cb35-1009" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Estimating P(x &gt; 0.0075 and x &lt; 0.0085)"</span>,</span>
<span id="cb35-1010"><a href="#cb35-1010" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Probability of subscription"</span>,</span>
<span id="cb35-1011"><a href="#cb35-1011" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb35-1012"><a href="#cb35-1012" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-1013"><a href="#cb35-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1014"><a href="#cb35-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1015"><a href="#cb35-1015" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Third step</span></span>
<span id="cb35-1016"><a href="#cb35-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1019"><a href="#cb35-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1020"><a href="#cb35-1020" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-6c</span></span>
<span id="cb35-1021"><a href="#cb35-1021" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visually performing integration using the CDF: Third step"</span></span>
<span id="cb35-1022"><a href="#cb35-1022" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-6c lst-cap="Approximate the integration of a range of the CDF: Third step"'</span></span>
<span id="cb35-1023"><a href="#cb35-1023" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-1024"><a href="#cb35-1024" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-1025"><a href="#cb35-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1026"><a href="#cb35-1026" aria-hidden="true" tabindex="-1"></a>df_13_6 <span class="ot">&lt;-</span> </span>
<span id="cb35-1027"><a href="#cb35-1027" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span>),</span>
<span id="cb35-1028"><a href="#cb35-1028" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">pbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-1029"><a href="#cb35-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1030"><a href="#cb35-1030" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_6, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-1031"><a href="#cb35-1031" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-1032"><a href="#cb35-1032" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1033"><a href="#cb35-1033" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xend =</span> <span class="fl">0.005</span>, <span class="at">yend =</span> <span class="fl">0.50</span>, </span>
<span id="cb35-1034"><a href="#cb35-1034" aria-hidden="true" tabindex="-1"></a>              <span class="at">x =</span> <span class="fl">0.00750</span>, <span class="at">y =</span> <span class="fl">0.50</span>),</span>
<span id="cb35-1035"><a href="#cb35-1035" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1036"><a href="#cb35-1036" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1037"><a href="#cb35-1037" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1038"><a href="#cb35-1038" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xend =</span> <span class="fl">0.0075</span>, <span class="at">yend =</span> <span class="fl">0.50</span>, </span>
<span id="cb35-1039"><a href="#cb35-1039" aria-hidden="true" tabindex="-1"></a>              <span class="at">x =</span> <span class="fl">0.0075</span>, <span class="at">y =</span> <span class="fl">0.00</span>),</span>
<span id="cb35-1040"><a href="#cb35-1040" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1041"><a href="#cb35-1041" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1042"><a href="#cb35-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1043"><a href="#cb35-1043" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1044"><a href="#cb35-1044" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.0085</span>, <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb35-1045"><a href="#cb35-1045" aria-hidden="true" tabindex="-1"></a>              <span class="at">xend =</span> <span class="fl">0.0085</span>, <span class="at">yend =</span> <span class="fl">0.99</span>),</span>
<span id="cb35-1046"><a href="#cb35-1046" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1047"><a href="#cb35-1047" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1048"><a href="#cb35-1048" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1049"><a href="#cb35-1049" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.0085</span>, <span class="at">y =</span> <span class="fl">0.99</span>,</span>
<span id="cb35-1050"><a href="#cb35-1050" aria-hidden="true" tabindex="-1"></a>              <span class="at">xend =</span> <span class="fl">0.005</span>, <span class="at">yend =</span> <span class="fl">0.99</span>),</span>
<span id="cb35-1051"><a href="#cb35-1051" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1052"><a href="#cb35-1052" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1053"><a href="#cb35-1053" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-1054"><a href="#cb35-1054" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-1055"><a href="#cb35-1055" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-1056"><a href="#cb35-1056" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Estimating P(x &gt; 0.0075 and x &lt; 0.0085)"</span>,</span>
<span id="cb35-1057"><a href="#cb35-1057" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Probability of subscription"</span>,</span>
<span id="cb35-1058"><a href="#cb35-1058" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb35-1059"><a href="#cb35-1059" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-1060"><a href="#cb35-1060" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1061"><a href="#cb35-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1062"><a href="#cb35-1062" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Fourth step</span></span>
<span id="cb35-1063"><a href="#cb35-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1066"><a href="#cb35-1066" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1067"><a href="#cb35-1067" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-6d</span></span>
<span id="cb35-1068"><a href="#cb35-1068" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visually performing integration using the CDF: Fourth step"</span></span>
<span id="cb35-1069"><a href="#cb35-1069" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-6d lst-cap="Approximate the integration of a range of the CDF: Fourth step"'</span></span>
<span id="cb35-1070"><a href="#cb35-1070" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-1071"><a href="#cb35-1071" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-1072"><a href="#cb35-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1073"><a href="#cb35-1073" aria-hidden="true" tabindex="-1"></a>df_13_6 <span class="ot">&lt;-</span> </span>
<span id="cb35-1074"><a href="#cb35-1074" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span>),</span>
<span id="cb35-1075"><a href="#cb35-1075" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">pbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-1076"><a href="#cb35-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1077"><a href="#cb35-1077" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_6, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-1078"><a href="#cb35-1078" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-1079"><a href="#cb35-1079" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1080"><a href="#cb35-1080" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xend =</span> <span class="fl">0.005</span>, <span class="at">yend =</span> <span class="fl">0.50</span>, </span>
<span id="cb35-1081"><a href="#cb35-1081" aria-hidden="true" tabindex="-1"></a>              <span class="at">x =</span> <span class="fl">0.00750</span>, <span class="at">y =</span> <span class="fl">0.50</span>),</span>
<span id="cb35-1082"><a href="#cb35-1082" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1083"><a href="#cb35-1083" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1084"><a href="#cb35-1084" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1085"><a href="#cb35-1085" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xend =</span> <span class="fl">0.0075</span>, <span class="at">yend =</span> <span class="fl">0.50</span>, </span>
<span id="cb35-1086"><a href="#cb35-1086" aria-hidden="true" tabindex="-1"></a>              <span class="at">x =</span> <span class="fl">0.0075</span>, <span class="at">y =</span> <span class="fl">0.00</span>),</span>
<span id="cb35-1087"><a href="#cb35-1087" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1088"><a href="#cb35-1088" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1089"><a href="#cb35-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1090"><a href="#cb35-1090" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1091"><a href="#cb35-1091" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.0085</span>, <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb35-1092"><a href="#cb35-1092" aria-hidden="true" tabindex="-1"></a>              <span class="at">xend =</span> <span class="fl">0.0085</span>, <span class="at">yend =</span> <span class="fl">0.99</span>),</span>
<span id="cb35-1093"><a href="#cb35-1093" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1094"><a href="#cb35-1094" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1095"><a href="#cb35-1095" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1096"><a href="#cb35-1096" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.0085</span>, <span class="at">y =</span> <span class="fl">0.99</span>,</span>
<span id="cb35-1097"><a href="#cb35-1097" aria-hidden="true" tabindex="-1"></a>              <span class="at">xend =</span> <span class="fl">0.005</span>, <span class="at">yend =</span> <span class="fl">0.99</span>),</span>
<span id="cb35-1098"><a href="#cb35-1098" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1099"><a href="#cb35-1099" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1100"><a href="#cb35-1100" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb35-1101"><a href="#cb35-1101" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1102"><a href="#cb35-1102" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.0055</span>, <span class="at">y =</span> <span class="fl">0.5</span>,</span>
<span id="cb35-1103"><a href="#cb35-1103" aria-hidden="true" tabindex="-1"></a>              <span class="at">xend =</span> <span class="fl">0.0055</span>, <span class="at">yend =</span> <span class="fl">0.99</span>),</span>
<span id="cb35-1104"><a href="#cb35-1104" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb35-1105"><a href="#cb35-1105" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1106"><a href="#cb35-1106" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1107"><a href="#cb35-1107" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xend =</span> <span class="fl">0.0055</span>, <span class="at">yend =</span> <span class="fl">0.5</span>,</span>
<span id="cb35-1108"><a href="#cb35-1108" aria-hidden="true" tabindex="-1"></a>              <span class="at">x =</span> <span class="fl">0.0055</span>, <span class="at">y =</span> <span class="fl">0.99</span>),</span>
<span id="cb35-1109"><a href="#cb35-1109" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb35-1110"><a href="#cb35-1110" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1111"><a href="#cb35-1111" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.0058</span>, <span class="at">y =</span> <span class="fl">0.75</span>,</span>
<span id="cb35-1112"><a href="#cb35-1112" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> <span class="st">"~ 0.49"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb35-1113"><a href="#cb35-1113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-1114"><a href="#cb35-1114" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-1115"><a href="#cb35-1115" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-1116"><a href="#cb35-1116" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Estimating P(x &gt; 0.0075 and x &lt; 0.0085)"</span>,</span>
<span id="cb35-1117"><a href="#cb35-1117" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Probability of subscription"</span>,</span>
<span id="cb35-1118"><a href="#cb35-1118" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb35-1119"><a href="#cb35-1119" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-1120"><a href="#cb35-1120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1121"><a href="#cb35-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1122"><a href="#cb35-1122" aria-hidden="true" tabindex="-1"></a><span class="fu">### Replicate Figure 13-7</span></span>
<span id="cb35-1123"><a href="#cb35-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1124"><a href="#cb35-1124" aria-hidden="true" tabindex="-1"></a>There is nothing new for approximating the range that covers 80 percent of the possible values for the true conversion rate. We use the same strategy as in @sec-replicate-figure-13-6 but this time starting from the y-axis:</span>
<span id="cb35-1125"><a href="#cb35-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1128"><a href="#cb35-1128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1129"><a href="#cb35-1129" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-7</span></span>
<span id="cb35-1130"><a href="#cb35-1130" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Estimating our confidence intervals visually using the CDF"</span></span>
<span id="cb35-1131"><a href="#cb35-1131" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-7 lst-cap="Approximate the confidence interval via the CDF"'</span></span>
<span id="cb35-1132"><a href="#cb35-1132" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-1133"><a href="#cb35-1133" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-1134"><a href="#cb35-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1135"><a href="#cb35-1135" aria-hidden="true" tabindex="-1"></a>df_13_7 <span class="ot">&lt;-</span> </span>
<span id="cb35-1136"><a href="#cb35-1136" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">1e-6</span>),</span>
<span id="cb35-1137"><a href="#cb35-1137" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">pbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-1138"><a href="#cb35-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1139"><a href="#cb35-1139" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_7, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-1140"><a href="#cb35-1140" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-1141"><a href="#cb35-1141" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1142"><a href="#cb35-1142" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xend =</span> <span class="fl">0.007</span>, <span class="at">yend =</span> <span class="fl">0.125</span>, </span>
<span id="cb35-1143"><a href="#cb35-1143" aria-hidden="true" tabindex="-1"></a>              <span class="at">x =</span> <span class="fl">0.005</span>, <span class="at">y =</span> <span class="fl">0.125</span>),</span>
<span id="cb35-1144"><a href="#cb35-1144" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1145"><a href="#cb35-1145" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.6</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1146"><a href="#cb35-1146" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1147"><a href="#cb35-1147" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">xend =</span> <span class="fl">0.0080</span>, <span class="at">yend =</span> <span class="fl">0.875</span>, </span>
<span id="cb35-1148"><a href="#cb35-1148" aria-hidden="true" tabindex="-1"></a>              <span class="at">x =</span> <span class="fl">0.005</span>, <span class="at">y =</span> <span class="fl">0.875</span>),</span>
<span id="cb35-1149"><a href="#cb35-1149" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1150"><a href="#cb35-1150" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.6</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1151"><a href="#cb35-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1152"><a href="#cb35-1152" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1153"><a href="#cb35-1153" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.007</span>, <span class="at">y =</span> <span class="fl">0.125</span>,</span>
<span id="cb35-1154"><a href="#cb35-1154" aria-hidden="true" tabindex="-1"></a>              <span class="at">xend =</span> <span class="fl">0.007</span>, <span class="at">yend =</span> <span class="fl">0.0</span>),</span>
<span id="cb35-1155"><a href="#cb35-1155" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1156"><a href="#cb35-1156" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.6</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1157"><a href="#cb35-1157" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(</span>
<span id="cb35-1158"><a href="#cb35-1158" aria-hidden="true" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.008</span>, <span class="at">y =</span> <span class="fl">0.875</span>,</span>
<span id="cb35-1159"><a href="#cb35-1159" aria-hidden="true" tabindex="-1"></a>              <span class="at">xend =</span> <span class="fl">0.008</span>, <span class="at">yend =</span> <span class="fl">0.0</span>),</span>
<span id="cb35-1160"><a href="#cb35-1160" aria-hidden="true" tabindex="-1"></a>              <span class="at">lineend =</span> <span class="st">"square"</span>, <span class="at">linejoin =</span> <span class="st">"bevel"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb35-1161"><a href="#cb35-1161" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.6</span>, <span class="at">arrow =</span> ggplot2<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">length =</span> ggplot2<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>))) <span class="sc">+</span></span>
<span id="cb35-1162"><a href="#cb35-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1163"><a href="#cb35-1163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-1164"><a href="#cb35-1164" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-1165"><a href="#cb35-1165" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-1166"><a href="#cb35-1166" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Estimating 80% Confidence Interval"</span>,</span>
<span id="cb35-1167"><a href="#cb35-1167" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Probability of subscription"</span>,</span>
<span id="cb35-1168"><a href="#cb35-1168" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb35-1169"><a href="#cb35-1169" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-1170"><a href="#cb35-1170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1171"><a href="#cb35-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1172"><a href="#cb35-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1173"><a href="#cb35-1173" aria-hidden="true" tabindex="-1"></a><span class="fu">### Replicate Figure 13-8</span></span>
<span id="cb35-1174"><a href="#cb35-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1177"><a href="#cb35-1177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1178"><a href="#cb35-1178" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pb-13-8</span></span>
<span id="cb35-1179"><a href="#cb35-1179" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visually, the quantile function is just a rotation of the CDF."</span></span>
<span id="cb35-1180"><a href="#cb35-1180" aria-hidden="true" tabindex="-1"></a><span class="co">#| attr-source: '#lst-fig-pb-13-8 lst-cap="Plot the quantile function"'</span></span>
<span id="cb35-1181"><a href="#cb35-1181" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: 70%</span></span>
<span id="cb35-1182"><a href="#cb35-1182" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: center</span></span>
<span id="cb35-1183"><a href="#cb35-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1184"><a href="#cb35-1184" aria-hidden="true" tabindex="-1"></a>df_13_8 <span class="ot">&lt;-</span> </span>
<span id="cb35-1185"><a href="#cb35-1185" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1e-4</span>),</span>
<span id="cb35-1186"><a href="#cb35-1186" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">qbeta</span>(x, <span class="dv">300</span>, <span class="dv">39700</span>)) </span>
<span id="cb35-1187"><a href="#cb35-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1188"><a href="#cb35-1188" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(df_13_8, ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-1189"><a href="#cb35-1189" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ylim</span>(<span class="fl">0.006</span>, <span class="fl">0.009</span>) <span class="sc">+</span></span>
<span id="cb35-1190"><a href="#cb35-1190" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-1191"><a href="#cb35-1191" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb35-1192"><a href="#cb35-1192" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb35-1193"><a href="#cb35-1193" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Quantile Function Beta(300, 39700)"</span>,</span>
<span id="cb35-1194"><a href="#cb35-1194" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Subscription rate"</span>,</span>
<span id="cb35-1195"><a href="#cb35-1195" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Cumulative Probability"</span></span>
<span id="cb35-1196"><a href="#cb35-1196" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-1197"><a href="#cb35-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>